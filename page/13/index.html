<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>茶桁.MAMT</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶桁.MAMT"><meta name="msapplication-TileImage" content="https://qiniu.hivan.me/picGo/20230601174411.png?imgNote"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶桁.MAMT"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="我是茶桁，这里是我用于写字，码代码以及记录的地方。"><meta property="og:type" content="blog"><meta property="og:title" content="茶桁.MAMT"><meta property="og:url" content="https://hivan.me/"><meta property="og:site_name" content="茶桁.MAMT"><meta property="og:description" content="我是茶桁，这里是我用于写字，码代码以及记录的地方。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hivan.me/img/og_image.png"><meta property="article:author" content="Hivan Du"><meta property="article:tag" content="AI,人工智能,代码,大语言模型"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hivan.me/img/og_image.png"><meta property="twitter:creator" content="@hivan"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hivan.me"},"headline":"茶桁.MAMT","image":["https://hivan.me/img/og_image.png"],"author":{"@type":"Person","name":"Hivan Du"},"publisher":{"@type":"Organization","name":"茶桁.MAMT","logo":{"@type":"ImageObject","url":"https://hivan.me/img/logo.svg"}},"description":"我是茶桁，这里是我用于写字，码代码以及记录的地方。"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="茶桁.MAMT" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.777Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/README/">AI ability practice</a></p><div class="content"><blockquote>
<p>Including core capabilities, BI and algorithm related, Code
warehouse: 【AI
Basic](https://github.com/hivandu/practise/tree/master/AI-basic)</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.777Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/SQL_ext_1/">SQL练习1</a></p><div class="content"><p>-- UPPER 是转换大写的函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name,salary <span class="hljs-operator">*</span> <span class="hljs-number">12</span>, <span class="hljs-built_in">UPPER</span>(email) <span class="hljs-keyword">FROM</span> employee;<br></code></pre></td></tr></table></figure>
<p>-- 使用别名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> e.emp_name <span class="hljs-keyword">AS</span> &quot;姓名&quot;,<br>                salary <span class="hljs-operator">*</span> <span class="hljs-number">12</span> <span class="hljs-keyword">AS</span> &quot;12月的工资&quot;,<br>                <span class="hljs-built_in">UPPER</span>(email) &quot;电子邮箱&quot;<br><span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">AS</span> e;<br></code></pre></td></tr></table></figure>
<p>-- 无表查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>;<br><br><span class="hljs-comment">-- Oracle 实现，dual只有一个字段且只包含一行数据</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span><span class="hljs-operator">+</span><span class="hljs-number">1</span><br><span class="hljs-keyword">FROM</span> dual;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">WHERE</span> emp_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;刘备&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>-- 比较运算符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> sex <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-string">&#x27;男&#x27;</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> salary <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">5000</span> <span class="hljs-keyword">and</span> <span class="hljs-number">7000</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> emp_name <span class="hljs-keyword">IN</span>(<span class="hljs-string">&#x27;刘备&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>-- 一个时间段之后入职</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name, hire_date <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> hire_date <span class="hljs-operator">&gt;</span> <span class="hljs-type">DATE</span> <span class="hljs-string">&#x27;2018-01-01&#x27;</span><br><br><span class="hljs-keyword">SELECT</span> emp_name,hire_date,manager <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> manager <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span><br><br><span class="hljs-keyword">SELECT</span> emp_name, sex, salary <span class="hljs-keyword">from</span> employee <span class="hljs-keyword">where</span> sex <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;女&#x27;</span> <span class="hljs-keyword">AND</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">10000</span><br><br><span class="hljs-keyword">SELECT</span> emp_name, sex, salary <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">WHERE</span> emp_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;刘备&#x27;</span> <span class="hljs-keyword">OR</span> emp_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张飞&#x27;</span> <span class="hljs-keyword">OR</span> emp_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;赵云&#x27;</span><br></code></pre></td></tr></table></figure>
<p>-- 短路运算 <code>short-circuit evaluation</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;AND&#x27;</span> <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">WHERE</span> <span class="hljs-number">1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">0</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-string">&#x27;OR&#x27;</span> <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">where</span> <span class="hljs-number">1</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">OR</span> <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">0</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">-- NOT</span><br><span class="hljs-keyword">select</span> emp_id,emp_name <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">WHERE</span> emp_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span>(<span class="hljs-string">&#x27;刘备&#x27;</span>,<span class="hljs-string">&#x27;张飞&#x27;</span>,<span class="hljs-string">&#x27;赵云&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>-- 运算符优先级</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name,dept_id,bonus<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> (dept_id <span class="hljs-operator">=</span> <span class="hljs-number">2</span> <span class="hljs-keyword">OR</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">3</span>) <span class="hljs-keyword">AND</span> bonus <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;<br></code></pre></td></tr></table></figure>
<p>-- 去处重复值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> SEX <span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">SELECT</span> DISTINCTROW sex <span class="hljs-keyword">from</span> employee<br></code></pre></td></tr></table></figure>
<p>/<em> 查找 2018 年 1 月 1 日之后入职，月薪小于 5000，并且奖金小于
1000（包括没有奖金）的员工。 </em>/</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_id,emp_name,salary,hire_date,bonus <br><span class="hljs-keyword">FROM</span> employee <br><span class="hljs-keyword">WHERE</span> hire_date <span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;2018-01-01&#x27;</span> <br>            <span class="hljs-keyword">AND</span> salary <span class="hljs-operator">&lt;</span> <span class="hljs-number">5000</span> <br>            <span class="hljs-keyword">AND</span> (bonus <span class="hljs-operator">&lt;</span> <span class="hljs-number">1000</span> <span class="hljs-keyword">OR</span> bonus <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>)<br></code></pre></td></tr></table></figure>
<p>-- LIKE运算符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_id,emp_name,sex<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> emp_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;赵%&#x27;</span><br><br><span class="hljs-keyword">SELECT</span> emp_name,email<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> email <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;dengzh_@shuguo.com&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>-- 转义字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_like(c1 <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>))<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_like(c1) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;进度:25% 已完成&#x27;</span>)<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_like(c1) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;日期:2019年5月25日&#x27;</span>)<br><br><span class="hljs-keyword">SELECT</span> c1<br><span class="hljs-keyword">FROM</span> t_like<br><span class="hljs-keyword">WHERE</span> c1 <span class="hljs-keyword">LIKE</span> &quot;%25\%%&quot;<br><br><span class="hljs-keyword">SELECT</span> c1<br><span class="hljs-keyword">FROM</span> t_like<br><span class="hljs-keyword">WHERE</span> c1 <span class="hljs-keyword">LIKE</span> &quot;%25#%%&quot; <span class="hljs-keyword">ESCAPE</span> <span class="hljs-string">&#x27;#&#x27;</span><br></code></pre></td></tr></table></figure>
<p>-- 大小写匹配</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name,email<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> email <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;M%&#x27;</span><br></code></pre></td></tr></table></figure>
<p>-- 正则表达式 判断邮箱</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-comment">/*</span><br><span class="hljs-comment">以字母或者数字开头；</span><br><span class="hljs-comment">后面是一个或者多个字母、数组或特殊字符（ . _ - ）；</span><br><span class="hljs-comment">然后是一个 @ 字符；</span><br><span class="hljs-comment">之后包含一个或者多个字母、数组或特殊字符（ . - ）；</span><br><span class="hljs-comment">最后是域名，即 . 以及 2 到 4 个字母。</span><br><span class="hljs-comment">^[a-zA-Z0-9]+[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,4&#125;$</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">SELECT</span> email <span class="hljs-keyword">FROM</span> t_regexp<br><span class="hljs-keyword">WHERE</span> REGEXP_LIKE (email, <span class="hljs-type">BINARY</span> <span class="hljs-string">&#x27;^[a-z0-9]+[a-z0-9._-]+@[a-z0-9.-]+\\.[a-z]&#123;2,4&#125;$&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>-- 降序排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name,salary,hire_date<br><span class="hljs-keyword">from</span> employee<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">4</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure>
<p>-- 多列排序(工资，入职先后)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name,salary,hire_date<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">4</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>, hire_date;<br></code></pre></td></tr></table></figure>
<p>-- 按照SELECT顺序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name, salary, hire_date<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">4</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">2</span> <span class="hljs-keyword">desc</span>, <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p><strong>中文排序</strong></p>
<p>-- CONVERT
是一个函数，用于转换数据的字符集编码。以下转换为中文GBK字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name<br><span class="hljs-keyword">from</span> employee<br><span class="hljs-keyword">WHERE</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">4</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">CONVERT</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">USING</span> GBK)<br></code></pre></td></tr></table></figure>
<p>-- 空值排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name,bonus<br><span class="hljs-keyword">from</span> employee<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>-- 其他空值排序方法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-comment">-- COALESCE函数将控制转换为一个指定的值</span><br><span class="hljs-keyword">SELECT</span> emp_name, <span class="hljs-built_in">COALESCE</span>(bonus,<span class="hljs-number">0</span>) <span class="hljs-keyword">AS</span> bonus<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">COALESCE</span>(bonus,<span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure>
<p>/<em> 第六节练习:
查询所有的员工信息，按照员工的总收入（年薪加奖金）从高到低进行排序，总收入相同再按照姓名的拼音顺序排序。
</em>/</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name, salary, bonus, (salary<span class="hljs-operator">+</span>bonus) <span class="hljs-keyword">as</span> sum<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> dept_id <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> (salary<span class="hljs-operator">+</span>bonus) <span class="hljs-keyword">DESC</span>, <span class="hljs-keyword">CONVERT</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">USING</span> GBK)<br></code></pre></td></tr></table></figure>
<p>-- TopN 排行榜</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-comment">-- 标准FETCH语法,此语法MySQL不支持，Oracle, PostgreSQL支持</span><br><span class="hljs-keyword">SELECT</span> emp_name, salary<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span><br><span class="hljs-keyword">OFFSET</span> <span class="hljs-number">0</span> <span class="hljs-keyword">ROWS</span><br><span class="hljs-keyword">FETCH</span> <span class="hljs-keyword">FIRST</span> <span class="hljs-number">5</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>;<br><br><span class="hljs-comment">-- LIMIT实现TOPN排行榜</span><br><span class="hljs-keyword">SELECT</span> emp_name, salary<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span><br>LIMIT <span class="hljs-number">5</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">-- 第二种写法</span><br><span class="hljs-keyword">SELECT</span> emp_name,salary<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span><br>LIMIT <span class="hljs-number">0</span>,<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<p>-- SQL 实现分页查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> emp_name, salary<br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span><br>LIMIT <span class="hljs-number">10</span>,<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<p>-- 员工排名第3高</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name,salary <br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">=</span> (<br>  <span class="hljs-keyword">select</span> salary <span class="hljs-keyword">from</span> employee<br>  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">SELECT</span> emp_name,salary <br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">desc</span> limit <span class="hljs-number">5</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>
<p>/<em> 练习：使用LIMIT和OFFSET找出员工表中月薪排名第三高的所有员工
</em>/</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> emp_name, salary <br><span class="hljs-keyword">FROM</span> employee<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">=</span> (<br>  <span class="hljs-keyword">select</span> salary <br>  <span class="hljs-keyword">FROM</span> employee<br>  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">desc</span> limit <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.777Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/example_002/">A Preliminary Study of Machine Learning</a></p><div class="content"><h2 id="gradient">Gradient</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">loss</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">3</span> * (k ** <span class="hljs-number">2</span>) + <span class="hljs-number">7</span> * k -<span class="hljs-number">10</span><br><br><span class="hljs-comment"># -b / 2a = -7 / 6</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">partial</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">6</span> * k + <span class="hljs-number">7</span><br><br>k = ramdom.randint(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br>alpha = <span class="hljs-number">1e-3</span> <span class="hljs-comment"># 0.001</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>    k = k + (-<span class="hljs-number">1</span>) * partial(k) * alpha<br>    <span class="hljs-built_in">print</span>(k, loss(k))<br><br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.777Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/example_01/">Introduction to Artificial Intelligence</a></p><div class="content"><blockquote>
<p>The code address of this article is: <a
target="_blank" rel="noopener" href="https://github.com/hivandu/practise/blob/master/AI-basic/example_01.ipynb">Example
01</a></p>
</blockquote>
<blockquote>
<p>The source code is in ipynb format, and the output content can be
viewed.</p>
</blockquote>
<h2 id="rule-based">rule based</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random <br><span class="hljs-keyword">from</span> icecream <span class="hljs-keyword">import</span> ic<br><br><br><span class="hljs-comment">#rules = &quot;&quot;&quot;</span><br><span class="hljs-comment">#复合句子 = 句子 , 连词 句子</span><br><span class="hljs-comment">#连词 = 而且 | 但是 | 不过</span><br><span class="hljs-comment">#句子 = 主语 谓语 宾语</span><br><span class="hljs-comment">#主语 = 你| 我 | 他 </span><br><span class="hljs-comment">#谓语 = 吃| 玩 </span><br><span class="hljs-comment">#宾语 = 桃子| 皮球</span><br><span class="hljs-comment">#    </span><br><span class="hljs-comment">#&quot;&quot;&quot;</span><br><br>rules = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">复合句子 = 句子 , 连词 复合句子 | 句子</span><br><span class="hljs-string">连词 = 而且 | 但是 | 不过</span><br><span class="hljs-string">句子 = 主语 谓语 宾语</span><br><span class="hljs-string">主语 = 你| 我 | 他 </span><br><span class="hljs-string">谓语 = 吃| 玩 </span><br><span class="hljs-string">宾语 = 桃子| 皮球</span><br><span class="hljs-string">    </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_grammer_by_description</span>(<span class="hljs-params">description</span>):<br>    rules_pattern = [r.split(<span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> description.split(<span class="hljs-string">&#x27;\n&#x27;</span>) <span class="hljs-keyword">if</span> r.strip()]<br>    target_with_expend = [(t, ex.split(<span class="hljs-string">&#x27;|&#x27;</span>)) <span class="hljs-keyword">for</span> t, ex <span class="hljs-keyword">in</span> rules_pattern]<br>    grammer = &#123;t.strip(): [e.strip() <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> ex] <span class="hljs-keyword">for</span> t, ex <span class="hljs-keyword">in</span> target_with_expend&#125;<br><br>    <span class="hljs-keyword">return</span> grammer<br><br><span class="hljs-comment">#generated = [t for t in random.choice(grammer[&#x27;句子&#x27;]).split()]</span><br><br><span class="hljs-comment">#test_v = [t for t in random.choice(grammer[&#x27;谓语&#x27;]).split()]</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_by_grammer</span>(<span class="hljs-params">grammer, target=<span class="hljs-string">&#x27;句子&#x27;</span></span>):<br>    <span class="hljs-keyword">if</span> target <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> grammer: <span class="hljs-keyword">return</span> target<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([generate_by_grammer(grammer, t) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> random.choice(grammer[target]).split()])<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br><br>    grammer = get_grammer_by_description(rules)<br><br>    <span class="hljs-comment">#ic(generated)</span><br>    <span class="hljs-comment">#ic(test_v)</span><br>    <span class="hljs-comment">#ic(generate_by_grammer(grammer))</span><br>    ic(generate_by_grammer(grammer, target=<span class="hljs-string">&#x27;复合句子&#x27;</span>))<br></code></pre></td></tr></table></figure>
<h2 id="water-pouring">water pouring</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">water_pouring</span>(<span class="hljs-params">b1, b2, goal, start=(<span class="hljs-params"><span class="hljs-number">0</span>, <span class="hljs-number">0</span></span>)</span>):<br>    <span class="hljs-keyword">if</span> goal <span class="hljs-keyword">in</span> start: <br>        <span class="hljs-keyword">return</span> [start]<br><br>    explored = <span class="hljs-built_in">set</span>()<br>    froniter = [[(<span class="hljs-string">&#x27;init&#x27;</span>, start)]]<br><br>    <span class="hljs-keyword">while</span> froniter:<br>        path = froniter.pop(<span class="hljs-number">0</span>)<br>        (x, y) = path[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]<br>        <br>        <span class="hljs-keyword">for</span> (state, action) <span class="hljs-keyword">in</span> successors(x, y, b1, b2).items():<br>            <span class="hljs-keyword">if</span> state <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> explored:<br>                explored.add(state)<br><br>                path2 = path + [(action, state)]<br><br>                <span class="hljs-keyword">if</span> goal <span class="hljs-keyword">in</span> state:<br>                    <span class="hljs-keyword">return</span> path2<br>                <span class="hljs-keyword">else</span>:<br>                    froniter.append(path2)<br><br>    <span class="hljs-keyword">return</span> []<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">successors</span>(<span class="hljs-params">x, y, X, Y</span>):<br>    <span class="hljs-keyword">return</span> &#123;<br>        ((<span class="hljs-number">0</span>, y+x) <span class="hljs-keyword">if</span> x + y &lt;= Y <span class="hljs-keyword">else</span> (x + y - Y, Y)): <span class="hljs-string">&#x27;X -&gt; Y&#x27;</span>,<br>        ((x + y, <span class="hljs-number">0</span>) <span class="hljs-keyword">if</span> x + y &lt;= X <span class="hljs-keyword">else</span>  (X, x + y - X)): <span class="hljs-string">&#x27;X &lt;- Y&#x27;</span>,<br>        (X, y): <span class="hljs-string">&#x27;灌满X&#x27;</span>,<br>        (x, Y): <span class="hljs-string">&#x27;灌满Y&#x27;</span>,<br>        (<span class="hljs-number">0</span>, y): <span class="hljs-string">&#x27;倒空X&#x27;</span>,<br>        (x, <span class="hljs-number">0</span>): <span class="hljs-string">&#x27;倒空Y&#x27;</span>,<br>    &#125;<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(water_pouring(<span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>))<br>    <span class="hljs-built_in">print</span>(water_pouring(<span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, start=(<span class="hljs-number">4</span>, <span class="hljs-number">0</span>)))<br>    <span class="hljs-built_in">print</span>(water_pouring(<span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.777Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/heart/">Logistic regression to diagnose heart disease</a></p><div class="content"><blockquote>
<p>The preject source code url : <a
target="_blank" rel="noopener" href="https://github.com/hivandu/colab/blob/master/AI_Data/heart.ipynb">Heart</a></p>
</blockquote>
<h2 id="load-data">load data</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression<br><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><br>data = pd.read_csv(<span class="hljs-string">&#x27;./data/heart.csv&#x27;</span>)<br><span class="hljs-comment"># the csv url: https://github.com/hivandu/colab/blob/master/AI_Data/data/heart.csv</span><br><br><span class="hljs-comment"># Print a brief summary of the data set</span><br><br>data.info()<br>data.shape<br><br>data.target.value_counts()<br></code></pre></td></tr></table></figure>
<h2 id="the-params-meaning">The params meaning</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Params</span>	  Meaning	<br><span class="hljs-attribute">age</span>	      年龄	<br><span class="hljs-attribute">sex</span>	      性别(<span class="hljs-number">1</span> = 男性, <span class="hljs-number">0</span> = 女性)<br><span class="hljs-attribute">cp</span>	      胸部疼痛类型(值<span class="hljs-number">1</span>：典型心绞痛，值<span class="hljs-number">2</span>：非典型性心绞痛，值<span class="hljs-number">3</span>：非心绞痛，值<span class="hljs-number">4</span>：无症状）<br><span class="hljs-attribute">trestbps</span>   血压	<br><span class="hljs-attribute">chol</span>	   胆固醇	<br><span class="hljs-attribute">fbs</span>	      空腹血糖（&gt; <span class="hljs-number">120</span> mg/dl，<span class="hljs-number">1</span>=真；<span class="hljs-number">0</span>=假）	<br><span class="hljs-attribute">restecg</span>	   心电图结果（<span class="hljs-number">0</span>=正常，<span class="hljs-number">1</span>=患有ST-T波异常，<span class="hljs-number">2</span>=根据Estes的标准显示可能或确定的左心室肥大）	<br><span class="hljs-attribute">thalach</span>	   最大心跳数	<br><span class="hljs-attribute">exang</span>	   运动时是否心绞痛（<span class="hljs-number">1</span>=有过；<span class="hljs-number">0</span>=没有）<br><span class="hljs-attribute">oldpeak</span>	   运动相对于休息的ST<br><span class="hljs-attribute">slop</span>	   心电图ST segment的倾斜度(值<span class="hljs-number">1</span>:上坡，值<span class="hljs-number">2</span>:平坦，值<span class="hljs-number">3</span>:下坡） 	<br><span class="hljs-attribute">ca</span>	      透视检查看到的血管数	<br><span class="hljs-attribute">thal</span>	   缺陷种类（<span class="hljs-number">3</span>=正常；<span class="hljs-number">6</span>=固定缺陷；<span class="hljs-number">7</span>=可逆缺陷）<br><span class="hljs-attribute">target</span>	   是否患病（<span class="hljs-number">0</span>=否，<span class="hljs-number">1</span>=是）<br></code></pre></td></tr></table></figure>
<h2 id="perform-analysis">Perform analysis</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># Change the &quot;sex&quot; column into two columns &quot;sex_0&quot; and &quot;sex_1&quot;</span><br>sex = pd.get_dummies(data[<span class="hljs-string">&#x27;sex&#x27;</span>], prefix = <span class="hljs-string">&#x27;sex&#x27;</span>)        <br><br><span class="hljs-comment"># Add &quot;sex_0&quot; and &quot;sex_1&quot; to the data set. </span><br>data = pd.concat([data, sex], axis = <span class="hljs-number">1</span>)<br><br><br><span class="hljs-comment"># And delete the sex column.</span><br>data = data.drop(columns = [<span class="hljs-string">&#x27;sex&#x27;</span>])<br><br><br><span class="hljs-comment"># Print out the first five lines. Check whether sex_0, sex_1 are added successfully, and whether sex is deleted successfully.</span><br>data.head()<br><br><span class="hljs-comment"># Get sample label</span><br>data_y = data.target.values<br>data_y.shape<br><br><span class="hljs-comment"># Get sample feature set</span><br>data_x = data.drop([<span class="hljs-string">&#x27;target&#x27;</span>], axis = <span class="hljs-number">1</span>)<br>data_x.shape<br><br><span class="hljs-comment"># Divide the data set</span><br>train_x, test_x, train_y, test_y = train_test_split(data_x, data_y, test_size = <span class="hljs-number">0.3</span>, random_state=<span class="hljs-number">33</span>)<br></code></pre></td></tr></table></figure>
<h3 id="normalization">Normalization</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># initialize</span><br>ss = StandardScaler()<br><br><span class="hljs-comment"># The fit function/module is used to train model parameters</span><br>ss.fit(train_x)<br><br><span class="hljs-comment"># Standardize the training set and test set</span><br>train_x = ss.transform(train_x)<br>test_x = ss.transform(test_x)<br><br><span class="hljs-comment"># Define a logistic regression model</span><br>lr = LogisticRegression()<br>lr.fit(train_x, train_y)<br><br><span class="hljs-comment"># Calculate the training set score</span><br>lr.score(train_x, train_y)<br><br><span class="hljs-comment"># Calculate test set score</span><br>lr.score(test_x, test_y)<br><br><span class="hljs-comment"># Use the classification_report function to display a text report of the main classification indicators</span><br>predict = lr.predict(test_x)<br><span class="hljs-built_in">print</span>(classification_report(test_y, predict))<br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.776Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Lecture_1/">Foundation of Artificial Intelligence - Lecture 1</a></p><div class="content"><h2 id="algorithm----data-structure">Algorithm --&gt; Data
Structure</h2>
<blockquote>
<p>No obvious solution ==&gt; Algorithm engineers do it If there is a
clear implementation path ==&gt; the person who develops the project
will do it</p>
</blockquote>
<h2 id="whats-the-algorithm">What's the Algorithm?</h2>
<blockquote>
<p>{Ace of hearts, 10 of spades, 3 of spades, 9 of hearts, 9 clubs, 4 of
diamonds, J}</p>
</blockquote>
<blockquote>
<p>First: Hearts&gt; Diamonds&gt; Spades&gt; Clubs Second: Numbers are
arranged from small to large</p>
</blockquote>
<ol type="1">
<li>Some people put the colors together first</li>
<li>Some people arrange the size first, and extract the colors one by
one</li>
</ol>
<p><span class="math display">\[ 1024 --&gt;  10^3 --&gt; 1k \]</span>
<span class="math display">\[ 1024 * 1024 --&gt;  10^6 --&gt; 1M
\]</span> <span class="math display">\[ 1024 * 1024 * 1024 --&gt;  10^9
--&gt; 1G \]</span></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">struction</span>-<span class="hljs-number">0</span>  <span class="hljs-number">00011101</span><br><span class="hljs-attribute">struction</span>-<span class="hljs-number">1</span>  <span class="hljs-number">00011111</span> <br><span class="hljs-attribute">struction</span>-<span class="hljs-number">2</span>  <span class="hljs-number">00011100</span><br><span class="hljs-attribute">struction</span>-<span class="hljs-number">3</span>  <span class="hljs-number">00011101</span><br><span class="hljs-attribute">struction</span>-<span class="hljs-number">4</span>  <span class="hljs-number">00011100</span><br><span class="hljs-attribute">struction</span>-<span class="hljs-number">5</span>  <span class="hljs-number">00011001</span><br></code></pre></td></tr></table></figure>
<p>2.6G Hz</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fac</span>(<span class="hljs-params">n</span>): <span class="hljs-comment"># return n!</span><br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">1</span>: <br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> <span class="hljs-comment"># 返回操作</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> n * fac(n-<span class="hljs-number">1</span>) <span class="hljs-comment"># 乘法操作 + 返回操作 + 函数调用</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">fac(<span class="hljs-number">1</span>)<br>&gt; <span class="hljs-number">1</span><br><br>fac(<span class="hljs-number">100</span>)<br>&gt; <span class="hljs-number">93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000</span><br><br>fac_100 = <span class="hljs-string">&quot;&quot;&quot;93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">len</span>(fac_100)<br>&gt; <span class="hljs-number">158</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">?? N --&gt; fac(n)<br><span class="hljs-comment"># 乘法操作 + 返回操作 + 函数调用</span><br>?? (N - <span class="hljs-number">1</span>)--&gt; fac(n-<span class="hljs-number">1</span>)<br>?? N == <span class="hljs-number">100</span>  fac(N) <br>??? <span class="hljs-number">99</span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">Object ` N --&gt; fac(n)` not found.<br>Object ` (N - 1)--&gt; fac(n-1)` not found.<br>Object ` N == 100  fac(N)` not found.<br>Object `? 99` not found.<br></code></pre></td></tr></table></figure>
<p><span class="math display">\[ Time(N) - Time(N-1) = constant
\]</span> <span class="math display">\[ Time(N-1) - Time(N-2) = constant
\]</span> <span class="math display">\[ Time(N-2) - Time(N-3) = constant
\]</span> <span class="math display">\[ Time(2) - Time(1) = constant
\]</span> <span class="math display">\[ Time(N) - Time(1) ==
(N-1)constant \]</span> <span class="math display">\[ Time(N) ==
(N-1)constant +  Time(1) \]</span> <span class="math display">\[ Time(N)
== N * constant +  (Time(1) - constant) \]</span></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.776Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/SVM-based_text_classification_in_practice/">SVM-based Text Classification in Practice</a></p><div class="content"><blockquote>
<p>The source code: <a
target="_blank" rel="noopener" href="https://github.com/hivandu/Colab/blob/master/AI_data/SVM-based%20text%20classification%20in%20practice.ipynb">SVM-based
Text Classification in Practice</a></p>
</blockquote>
<blockquote>
<p>'cnews.train.txt' data cannot be uploaded because it is too large, so
it needs to be decompressed and imported after compression.</p>
</blockquote>
<p>Use SVM to implement a simple text classification based on bag of
words and support vector machine.</p>
<h2 id="import-data">import data</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># import</span><br><span class="hljs-keyword">import</span> codecs<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> jieba<br></code></pre></td></tr></table></figure>
<p>Chinese news data is prepared as a sample data set. The number of
training data is 50,000 and the number of test data is 10,000. All data
is divided into 10 categories: sports, finance, real estate, home
furnishing, education, technology, fashion, current affairs, games and
entertainment . From the training text, you can load the code, view the
data format and samples:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>data_train = <span class="hljs-string">&#x27;./data/cnews.train.txt&#x27;</span> <span class="hljs-comment"># training data file name  </span><br>data_test = <span class="hljs-string">&#x27;./data/cnews.test.txt&#x27;</span>  <span class="hljs-comment"># test data file name</span><br>vocab = <span class="hljs-string">&#x27;./data/cnews.vocab.txt&#x27;</span> <span class="hljs-comment"># dictionary</span><br><br><span class="hljs-keyword">with</span> codecs.<span class="hljs-built_in">open</span>(data_train, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br><br><span class="hljs-comment"># print sample content</span><br>label, content = lines[<span class="hljs-number">0</span>].strip(<span class="hljs-string">&#x27;\r\n&#x27;</span>).split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>content<br></code></pre></td></tr></table></figure>
<p>Take the first item of the training data as an example to segment the
loaded news data. Here I use the word segmentation function of LTP, you
can also use jieba, and the segmentation results are displayed separated
by "/" symbols.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># print word segment results</span><br>segment = jieba.cut(content)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;/&#x27;</span>.join(segment))<br></code></pre></td></tr></table></figure>
<p>To sort out the above logic a bit, implement a class to load training
and test data and perform word segmentation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># cut data</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_line</span>(<span class="hljs-params">idx, line</span>):<br>    data = <span class="hljs-built_in">tuple</span>(line.strip(<span class="hljs-string">&#x27;\r\n&#x27;</span>).split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">len</span>(data)==<span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    content_segged = <span class="hljs-built_in">list</span>(jieba.cut(data[<span class="hljs-number">1</span>]))<br>    <span class="hljs-keyword">if</span> idx % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;line number: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(idx))<br>    <span class="hljs-keyword">return</span> (data[<span class="hljs-number">0</span>], content_segged)<br>    <br><span class="hljs-comment"># data loading method</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data</span>(<span class="hljs-params">file</span>):<br>    <span class="hljs-keyword">with</span> codecs.<span class="hljs-built_in">open</span>(file, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>    data_records = [process_line(idx, line) <span class="hljs-keyword">for</span> idx, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines)]<br>    data_records = [data <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> data_records <span class="hljs-keyword">if</span> data <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>]<br>    <span class="hljs-keyword">return</span> data_records<br><br><span class="hljs-comment"># load and process training data</span><br>train_data = load_data(data_train)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;first training data: label &#123;&#125; segment &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(train_data[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;/&#x27;</span>.join(train_data[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])))<br><span class="hljs-comment"># load and process testing data</span><br>test_data = load_data(data_test)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;first testing data: label &#123;&#125; segment &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(test_data[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;/&#x27;</span>.join(test_data[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])))<br></code></pre></td></tr></table></figure>
<p>After spending some time on word segmentation, you can start building
a dictionary. The dictionary is built from the training set and sorted
by word frequency.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_vocab</span>(<span class="hljs-params">train_data, thresh</span>):<br>    vocab = &#123;<span class="hljs-string">&#x27;&lt;UNK&gt;&#x27;</span>: <span class="hljs-number">0</span>&#125;<br>    word_count = &#123;&#125; <span class="hljs-comment"># word frequency</span><br>    <span class="hljs-keyword">for</span> idx, data <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_data):<br>        content = data[<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> content:<br>            <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> word_count:<br>                word_count[word] += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                word_count[word] = <span class="hljs-number">1</span><br>    word_list = [(k, v) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> word_count.items()]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;word list length: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(word_list)))<br>    word_list.sort(key = <span class="hljs-keyword">lambda</span> x : x[<span class="hljs-number">1</span>], reverse = <span class="hljs-literal">True</span>) <span class="hljs-comment"># sorted by word frequency</span><br>    word_list_filtered = [word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> word_list <span class="hljs-keyword">if</span> word[<span class="hljs-number">1</span>] &gt; thresh]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;word list length after filtering: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(word_list_filtered)))<br>    <span class="hljs-comment"># construct vocab</span><br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> word_list_filtered:<br>        vocab[word[<span class="hljs-number">0</span>]] = <span class="hljs-built_in">len</span>(vocab)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;vocab size: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(vocab))) <span class="hljs-comment"># vocab size is word list size +1 due to unk token</span><br>    <span class="hljs-keyword">return</span> vocab<br><br>vocab = build_vocab(train_data, <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>In addition, according to category, we know that the label itself
also has a "dictionary":</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_label_vocab</span>(<span class="hljs-params">cate_file</span>):<br>    label_vocab = &#123;&#125;<br>    <span class="hljs-keyword">with</span> codecs.<span class="hljs-built_in">open</span>(cate_file, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> lines <span class="hljs-keyword">in</span> f:<br>            line = lines.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>            label_vocab[line[<span class="hljs-number">0</span>]]  = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> label_vocab<br><br>label_vocab = build_label_vocab(<span class="hljs-string">&#x27;./data/cnews.category.txt&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;label vocab: <span class="hljs-subst">&#123;label_vocab&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>Next, construct the id-based training and test sets, because we only
consider the bag of words, so the order of words is excluded.
Constructed to look like libsvm can eat. Note that because the bag of
word model</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_trainable_matrix</span>(<span class="hljs-params">corpus, vocab, label_vocab, out_file</span>):<br>    records = []<br>    <span class="hljs-keyword">for</span> idx, data <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(corpus):<br>        <span class="hljs-keyword">if</span> idx % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;process &#123;&#125; data&#x27;</span>.<span class="hljs-built_in">format</span>(idx))<br>        label = <span class="hljs-built_in">str</span>(label_vocab[data[<span class="hljs-number">0</span>]]) <span class="hljs-comment"># label id</span><br>        token_dict = &#123;&#125;<br>        <span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> data[<span class="hljs-number">1</span>]:<br>            token_id = vocab.get(token, <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">if</span> token_id <span class="hljs-keyword">in</span> token_dict:<br>                token_dict[token_id] += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                token_dict[token_id] = <span class="hljs-number">1</span><br>        feature = [<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(k) + <span class="hljs-number">1</span>) + <span class="hljs-string">&#x27;:&#x27;</span> + <span class="hljs-built_in">str</span>(v) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> token_dict.items()]<br>        feature_text = <span class="hljs-string">&#x27; &#x27;</span>.join(feature)<br>        records.append(label + <span class="hljs-string">&#x27; &#x27;</span> + feature_text)<br>    <br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(out_file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(<span class="hljs-string">&#x27;\n&#x27;</span>.join(records))<br><br>construct_trainable_matrix(train_data, vocab, label_vocab, <span class="hljs-string">&#x27;./data/train.svm.txt&#x27;</span>)<br>construct_trainable_matrix(test_data, vocab, label_vocab, <span class="hljs-string">&#x27;./data/test.svm.txt&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="training-process">Training process</h2>
<p>The remaining core model is simple: use libsvm to train the support
vector machine, let your svm eat the training and test files you have
processed, and then use the existing method of libsvm to train, we can
change different parameter settings . The documentation of libsvm can be
viewed <a target="_blank" rel="noopener" href="https://www.csie.ntu.edu.tw/~cjlin/libsvm/">here</a>,
where the "-s, -t, -c" parameters are more important, and they decide
what you choose Svm, your choice of kernel function, and your penalty
coefficient.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libsvm <span class="hljs-keyword">import</span> svm<br><span class="hljs-keyword">from</span> libsvm.svmutil <span class="hljs-keyword">import</span> svm_read_problem,svm_train,svm_predict,svm_save_model,svm_load_model<br><br><span class="hljs-comment"># train svm</span><br>train_label, train_feature = svm_read_problem(<span class="hljs-string">&#x27;./data/train.svm.txt&#x27;</span>)<br><span class="hljs-built_in">print</span>(train_label[<span class="hljs-number">0</span>], train_feature[<span class="hljs-number">0</span>])<br>model=svm_train(train_label,train_feature,<span class="hljs-string">&#x27;-s 0 -c 5 -t 0 -g 0.5 -e 0.1&#x27;</span>)<br><br><span class="hljs-comment"># predict</span><br>test_label, test_feature = svm_read_problem(<span class="hljs-string">&#x27;./data/test.svm.txt&#x27;</span>)<br><span class="hljs-built_in">print</span>(test_label[<span class="hljs-number">0</span>], test_feature[<span class="hljs-number">0</span>])<br>p_labs, p_acc, p_vals = svm_predict(test_label, test_feature, model)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;accuracy: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(p_acc))<br></code></pre></td></tr></table></figure>
<p>After a period of training, we can observe the experimental results.
You can change different svm types, penalty coefficients, and kernel
functions to optimize the results.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.776Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/auto_operation_weibo/">Auto operation Weibo</a></p><div class="content"><blockquote>
<p>The code address of this article is: <a
target="_blank" rel="noopener" href="https://github.com/hivandu/colab/blob/master/AI_data/auto%20operation%20weibo.ipynb">auto
operation weibo</a> Chromedrive download: <a
target="_blank" rel="noopener" href="http://npm.taobao.org/mirrors/chromedriver">Taobao Mirror</a> ,
<strong>need to be consistent with your Chrome version</strong></p>
</blockquote>
<h2 id="auto-operation-weibo">auto operation weibo</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">import</span> time<br>driver = webdriver.Chrome(<span class="hljs-string">&#x27;/Applications/chromedriver&#x27;</span>)<br><br><span class="hljs-comment"># login weibo</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">weibo_login</span>(<span class="hljs-params">username, password</span>):<br><br>    <span class="hljs-comment"># open weibo index</span><br>    driver.get(<span class="hljs-string">&#x27;https://passport.weibo.cn/signin/login&#x27;</span>)<br>    driver.implicitly_wait(<span class="hljs-number">5</span>)<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># fill the info: username, password</span><br>    driver.find_element_by_id(<span class="hljs-string">&#x27;loginName&#x27;</span>).send_keys(username)<br>    driver.find_element_by_id(<span class="hljs-string">&#x27;loginPassword&#x27;</span>).send_keys(password)<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># click login</span><br>    driver.find_element_by_id(<span class="hljs-string">&#x27;loginAction&#x27;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># set username, password</span><br>username = <span class="hljs-string">&#x27;ivandoo75@gmail.com&#x27;</span><br>password = <span class="hljs-string">&#x27;ooxx&#x27;</span><br><br><span class="hljs-comment"># Mobile phone verification is required here, but still can’t log in fully automatically</span><br>weibo_login(username, password)<br></code></pre></td></tr></table></figure>
<h2 id="follow-user">follow user</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_follow</span>(<span class="hljs-params">uid</span>):<br>    driver.get(<span class="hljs-string">&#x27;https://m.weibo.com/u/&#x27;</span> + <span class="hljs-built_in">str</span>(uid))<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># driver.find_element_by_id(&#x27;follow&#x27;).click()</span><br>    follow_button = driver.find_element_by_xpath(<span class="hljs-string">&#x27;//div[@class=&quot;btn_bed W_fl&quot;]&#x27;</span>)<br>    follow_button.click()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># select group</span><br>    group_button = driver.find_element_by_xpath(<span class="hljs-string">&#x27;//div[@class=&quot;list_content W_f14&quot;]/ul[@class=&quot;list_ul&quot;]/li[@class=&quot;item&quot;][2]&#x27;</span>)<br>    group_button.click()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># cancel the select</span><br>    cancel_button = driver.find_element_by_xpath(<span class="hljs-string">&#x27;//div[@class=&quot;W_layer_btn S_bg1&quot;]/a[@class=&quot;W_btn_b btn_34px&quot;]&#x27;</span>)<br>    cancel_button.click()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 每天学点心理学UID</span><br>uid = <span class="hljs-string">&#x27;1890826225&#x27;</span><br>add_follow(uid)<br></code></pre></td></tr></table></figure>
<h2 id="create-text-and-publish">create text and publish</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_comment</span>(<span class="hljs-params">weibo_url, content</span>):<br>    driver.get(weibo_url)<br>    driver.implicitly_wait(<span class="hljs-number">5</span>)<br><br>    content_textarea = driver.find_element_by_css_selector(<span class="hljs-string">&#x27;textarea.W.input&#x27;</span>).clear()<br>    content_textarea = driver.find_element_by_css_selector(<span class="hljs-string">&#x27;textarea.W.input&#x27;</span>).send_keys(content)<br><br>    time.sleep(<span class="hljs-number">2</span>)<br><br>    comment_button = driver.find_element_by_css_selector(<span class="hljs-string">&#x27;.W_btn_a&#x27;</span>).click()<br><br><span class="hljs-comment"># post the text</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">post_weibo</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-comment"># go to the user index</span><br>    driver.get(<span class="hljs-string">&#x27;https://weibo.com&#x27;</span>)<br>    driver.implicitly_wait(<span class="hljs-number">5</span>)<br><br>    <span class="hljs-comment"># click publish button</span><br>    <span class="hljs-comment"># post_button = driver.find_element_by_css_selector(&#x27;[node-type=&quot;publish&quot;]&#x27;).click()</span><br><br>    <span class="hljs-comment"># input content word to textarea</span><br>    content_textarea = driver.find_element_by_css_selector(<span class="hljs-string">&#x27;textarea.W_input[node-type=&quot;textEl&quot;]&#x27;</span>).send_keys(content)<br>    time.sleep(<span class="hljs-number">2</span>)<br><br>    <span class="hljs-comment"># click publish button</span><br>    post_button = driver.find_element_by_css_selector(<span class="hljs-string">&quot;[node-type=&#x27;submit&#x27;]&quot;</span>).click()<br>    time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># comment the weibo</span><br>weibo_url = <span class="hljs-string">&#x27;https://weibo.com/1890826225/HjjqSahwl&#x27;</span><br>content= <span class="hljs-string">&#x27;here is Hivan du, Best wish to u.&#x27;</span><br><br><span class="hljs-comment"># auto send weibo</span><br>content = <span class="hljs-string">&#x27;Learning is a belief!&#x27;</span><br>post_weibo(content)<br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.776Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/boston_analysis/">Boston house analysis</a></p><div class="content"><blockquote>
<p>The source code: <a
target="_blank" rel="noopener" href="https://github.com/hivandu/colab/blob/master/AI_data/boston_house.ipynb">Boston
House</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Import package</span><br><span class="hljs-comment"># Used to load the Boston housing price data set</span><br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston<br><span class="hljs-comment"># pandas toolkit If you are unfamiliar with pandas, you can refer to the official 10-minute tutorial: https://pandas.pydata.org/pandas-docs/stable/10min.html</span><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment"># seaborn for drawing</span><br><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-comment"># Show drawing</span><br>%matplotlib inline<br><br><br>data = load_boston() <span class="hljs-comment"># load datase</span><br><br>data.keys() <span class="hljs-comment"># Fields inside data</span><br><br>df = pd.DataFrame(data[<span class="hljs-string">&#x27;data&#x27;</span>])<br><br><span class="hljs-comment"># Looking at the first 5 rows of the dataframe, we can see that the column names are numbers</span><br>df.head(<span class="hljs-number">5</span>)<br><br>data[<span class="hljs-string">&#x27;feature_names&#x27;</span>] <span class="hljs-comment"># Feature name</span><br></code></pre></td></tr></table></figure>
<h2 id="the-table-params-and-chinese-info">The Table params and chinese
info</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">params</span>	chinese info<br><span class="hljs-attribute">CRIM</span>	住房所在城镇的人均犯罪率<br><span class="hljs-attribute">ZN</span>	    住房用地超过 <span class="hljs-number">25000</span> 平方尺的比例<br><span class="hljs-attribute">INDUS</span>	住房所在城镇非零售商用土地的比例<br><span class="hljs-attribute">CHAS</span>	有关查理斯河的虚拟变量（如果住房位于河边则为<span class="hljs-number">1</span>,否则为<span class="hljs-number">0</span> ）<br><span class="hljs-attribute">NOX</span>	    一氧化氮浓度<br><span class="hljs-attribute">RM</span>	    每处住房的平均房间数<br><span class="hljs-attribute">AGE</span>	    建于 <span class="hljs-number">1940</span> 年之前的业主自住房比例<br><span class="hljs-attribute">DIS</span>	    住房距离波士顿五大中心区域的加权距离<br><span class="hljs-attribute">RAD</span>	    离住房最近的公路入口编号<br><span class="hljs-attribute">TAX</span>     每 <span class="hljs-number">10000</span> 美元的全额财产税金额<br><span class="hljs-attribute">PTRATIO</span>	住房所在城镇的师生比例<br><span class="hljs-attribute">B</span>	    <span class="hljs-number">1000</span>(Bk-<span class="hljs-number">0</span>.<span class="hljs-number">63</span>)^<span class="hljs-number">2</span>,其中 Bk 指代城镇中黑人的比例<br><span class="hljs-attribute">LSTAT</span>	弱势群体人口所占比例<br><span class="hljs-attribute">MEDV</span>	业主自住房的中位数房价（以千美元计）<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Replace numeric column names with feature names</span><br>df.columns = data[<span class="hljs-string">&#x27;feature_names&#x27;</span>]<br>df.head(<span class="hljs-number">5</span>)<br><br><span class="hljs-comment"># The target is the house price, which is also our target value. We assign the target value to the dataframe</span><br>df[<span class="hljs-string">&#x27;price&#x27;</span>] = data[<span class="hljs-string">&#x27;target&#x27;</span>]<br>df.head(<span class="hljs-number">5</span>)<br><br><span class="hljs-comment"># View the correlation coefficient between the feature and price, positive correlation and negative correlation</span><br>sns.heatmap(df.corr(), annot=<span class="hljs-literal">True</span>, fmt=<span class="hljs-string">&#x27;.1f&#x27;</span>)<br><br>plt.scatter(df[<span class="hljs-string">&#x27;RM&#x27;</span>], df[<span class="hljs-string">&#x27;price&#x27;</span>])<br><br><br>plt.figure(figsize=(<span class="hljs-number">20</span>, <span class="hljs-number">5</span>))<br><br><span class="hljs-comment"># View the data distribution display of some features and price</span><br>features = [<span class="hljs-string">&#x27;LSTAT&#x27;</span>, <span class="hljs-string">&#x27;RM&#x27;</span>]<br>target = df[<span class="hljs-string">&#x27;price&#x27;</span>]<br><br><span class="hljs-keyword">for</span> i, col <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(features):<br>    plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(features), i+<span class="hljs-number">1</span>)<br>    x = df[col]<br>    y = target<br>    plt.scatter(x, y, marker = <span class="hljs-string">&#x27;o&#x27;</span>)<br>    plt.title(<span class="hljs-string">&#x27;&#123;&#125; price&#x27;</span>.<span class="hljs-built_in">format</span>(col))<br>    plt.xlabel(col)<br>    plt.ylabel(<span class="hljs-string">&#x27;price&#x27;</span>)<br><br><br><span class="hljs-comment"># Simple example: univariate forecast price</span><br>x = df[<span class="hljs-string">&#x27;RM&#x27;</span>]<br>y = df[<span class="hljs-string">&#x27;price&#x27;</span>]<br><br>history_notes = &#123;_x: _y <span class="hljs-keyword">for</span> _x, _y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x,y)&#125;<br><br>history_notes[<span class="hljs-number">6.575</span>]<br><br><br><span class="hljs-comment"># Find the top three prices that are closest to RM:6.57,</span><br>similary_ys = [y <span class="hljs-keyword">for</span> _, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(history_notes.items(), key=<span class="hljs-keyword">lambda</span> x_y: (x_y[<span class="hljs-number">0</span>] - <span class="hljs-number">6.57</span>) ** <span class="hljs-number">2</span>)[:<span class="hljs-number">3</span>]]<br>similary_ys<br><br><br><span class="hljs-comment"># Calculate the average of three</span><br>np.mean(similary_ys)<br></code></pre></td></tr></table></figure>
<h3
id="use-historical-data-to-predict-data-that-has-never-been-seen-before-the-most-direct-method">Use
historical data to predict data that has never been seen before, the
most direct method</h3>
<h2 id="k-neighbor-nearst">K-Neighbor-Nearst</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">knn</span>(<span class="hljs-params">query_x, history, top_n = <span class="hljs-number">3</span></span>):<br>    sorted_notes = <span class="hljs-built_in">sorted</span>(history.items(), key = <span class="hljs-keyword">lambda</span> x_y: (x_y[<span class="hljs-number">0</span>] - query_x)**<span class="hljs-number">2</span>) <br>    similar_notes = sorted_notes[:top_n]<br>    similar_ys = [y <span class="hljs-keyword">for</span> _, y <span class="hljs-keyword">in</span> similar_notes]<br><br>    <span class="hljs-keyword">return</span> np.mean(similar_ys)<br><br>knn(<span class="hljs-number">5.4</span>, history_notes)<br></code></pre></td></tr></table></figure>
<p>In order to obtain results faster, we hope to obtain predictive power
by fitting a function</p>
<p><span class="math display">\[ f(rm) = k * rm + b \]</span></p>
<h2 id="random-approach">Random Approach</h2>
<p><span class="math display">\[ Loss(k, b) = \frac{1}{n} \sum_{i \in N}
(\hat{y_i} - y_i) ^ 2 \]</span> <span class="math display">\[ Loss(k, b)
= \frac{1}{n} \sum_{i \in N} ((k * rm_i + b) - y_i) ^ 2 \]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">loss</span>(<span class="hljs-params">y_hat, y</span>):<br>    <span class="hljs-keyword">return</span> np.mean((y_hat - y)**<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">import</span> random<br><br>min_loss = <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)<br><br>best_k, best_b = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>    min_v, max_v = -<span class="hljs-number">100</span>, <span class="hljs-number">100</span><br>    k, b = random.randrange(min_v, max_v), random.randrange(min_v, max_v)<br>    y_hats = [k * rm_i + b <span class="hljs-keyword">for</span> rm_i <span class="hljs-keyword">in</span> x]<br>    current_loss = loss(y_hats, y)<br><br>    <span class="hljs-keyword">if</span> current_loss &lt; min_loss:<br>        min_loss = current_loss<br>        best_k, best_b = k, b<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;step&#125;</span>, we have func f(rm) = <span class="hljs-subst">&#123;k&#125;</span> * rm + <span class="hljs-subst">&#123;b&#125;</span>,  lss is :<span class="hljs-subst">&#123;current_loss&#125;</span>&#x27;</span>)<br><br>plt.scatter(x, y)<br>plt.scatter(x, [best_k * rm + best_b <span class="hljs-keyword">for</span> rm <span class="hljs-keyword">in</span> x])<br></code></pre></td></tr></table></figure>
<h2 id="monte-carlo-simulation蒙特卡洛模拟">Monte Carlo
simulation(蒙特卡洛模拟)</h2>
<h3 id="supervisor">Supervisor</h3>
<p><span class="math display">\[ Loss(k, b) = \frac{1}{n} \sum_{i \in N}
((k * rm_i + b) - y_i) ^ 2 \]</span></p>
<p><span class="math display">\[ \frac{\partial{loss(k,
b)}}{\partial{k}} = \frac{2}{n}\sum_{i \in N}(k * rm_i + b - y_i) * rm_i
\]</span></p>
<p><span class="math display">\[ \frac{\partial{loss(k,
b)}}{\partial{b}} = \frac{2}{n}\sum_{i \in N}(k * rm_i + b -
y_i)\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">partial_k</span>(<span class="hljs-params">k, b, x, y</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>  * np.mean((k*x+b-y) * x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">partial_b</span>(<span class="hljs-params">k, b, x, y</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * np.mean(k*x+b-y)<br><br>k, b = random.random(), random.random()<br>min_loss = <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)<br><br>best_k, best_b = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br>learning_rate = <span class="hljs-number">1e-2</span><br><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>):<br>    k, b = k + (-<span class="hljs-number">1</span> * partial_k(k, b, x, y) * learning_rate), b + (-<span class="hljs-number">1</span> * partial_b(k, b, x, y) * learning_rate)<br>    y_hats = k * x + b<br>    current_loss = loss(y_hats, y)<br><br>    <span class="hljs-keyword">if</span> current_loss &lt; min_loss:<br>        min_loss = current_loss<br>        best_k, best_b = k, b<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;setp <span class="hljs-subst">&#123;step&#125;</span>, we have func f(rm) = <span class="hljs-subst">&#123;k&#125;</span> * rm + <span class="hljs-subst">&#123;b&#125;</span>,  lss is :<span class="hljs-subst">&#123;current_loss&#125;</span>&#x27;</span>)<br><br>best_k, best_b<br><br><br>plt.scatter(x, y)<br>plt.scatter(x, [best_k * rm + best_b <span class="hljs-keyword">for</span> rm <span class="hljs-keyword">in</span> x])<br></code></pre></td></tr></table></figure>
<h2 id="supervised-learning">Supervised Learning</h2>
<p>We turn the forecast of housing prices into a more responsible and
sophisticated model. What should we do?</p>
<p><span class="math display">\[ f(x) = k * x + b \]</span></p>
<p><span class="math display">\[ f(x) = k2 * \sigma(k_1 * x + b_1) + b2
\]</span></p>
<p><span class="math display">\[ \sigma(x) = \frac{1}{1 + e^(-x)}
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span>+np.exp(-x))<br><br>sub_x = np.linspace(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br>plt.plot(sub_x, sigmoid(sub_x))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_linear</span>(<span class="hljs-params">x</span>):<br>    k, b = random.random(), random.random()<br>    <span class="hljs-keyword">return</span> k * x + b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">complex_function</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> (random_linear(x))<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    index = random.randrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(sub_x))<br>    sub_x_1, sub_x_2 = sub_x[:index], sub_x[index:]<br>    new_y = np.concatenate((complex_function(sub_x_1), complex_function(sub_x_2)))<br>    plt.plot(sub_x, new_y)<br></code></pre></td></tr></table></figure>
<p>We can implement more complex functions through simple, basic modules
and repeated superposition</p>
<p>For more and more complex functions? How does the computer seek
guidance?</p>
<ol type="1">
<li>What is machine learning?</li>
<li>The shortcomings of this method of KNN, what is the background of
the proposed linear fitting</li>
<li>How to get faster function weight update through supervision
method</li>
<li>The combination of nonlinear and linear functions can fit very
complex functions</li>
<li>Deep learning we can fit more complex functions through basic
function modules</li>
</ol>
<h3 id="assigment">Assigment:</h3>
<p><span class="math display">\[ L2-Loss(y, \hat{y}) =
\frac{1}{n}\sum{(\hat{y} - y)}^2 \]</span></p>
<p><span class="math display">\[ L1-Loss(y, \hat{y}) =
\frac{1}{n}\sum{|(\hat{y} - y)|} \]</span></p>
<p>L2-Loss becomes L1Loss and achieves gradient descent</p>
<p>Realize L1Loss gradient descent from 0</p>
<h4 id="import-package">1. import package</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br></code></pre></td></tr></table></figure>
<h4 id="load-data">2. load data</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston<br>data = load_boston()<br>data.keys()<br><br>data_train = data.data<br>data_traget = data.target<br><br>df = pd.DataFrame(data_train, columns = data.feature_names)<br>df.head()<br><br>df.describe() <span class="hljs-comment"># Data description, you can view the statistics of each variable</span><br></code></pre></td></tr></table></figure>
<h4 id="data-preprocessing">3. Data preprocessing</h4>
<p>Normalization or standardization can prevent a certain dimension or a
few dimensions from affecting the data too much when there are very many
dimensions, and secondly, the program can run faster. There are many
methods, such as standardization, min-max, z-score, p-norm, etc. How to
use it depends on the characteristics of the data set.</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/81560511">Further
reading-数据标准化的迷思之深度学习领域</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<br><span class="hljs-comment"># z = (x-u) / s u is the mean, s is the standard deviation</span><br>ss = StandardScaler() <br>data_train = ss.fit_transform(data_train)<br><span class="hljs-comment"># For linear models, normalization or standardization is generally required, otherwise gradient explosion will occur, and tree models are generally not required</span><br>data_train = pd.DataFrame(data_train, columns = [<span class="hljs-string">&#x27;CRIM&#x27;</span>,<span class="hljs-string">&#x27;ZN&#x27;</span>,<span class="hljs-string">&#x27;INDUS&#x27;</span>,<span class="hljs-string">&#x27;CHAS&#x27;</span>,<span class="hljs-string">&#x27;NOX&#x27;</span>,<span class="hljs-string">&#x27;RM&#x27;</span>,<span class="hljs-string">&#x27;AGE&#x27;</span>,<span class="hljs-string">&#x27;DIS&#x27;</span>,<span class="hljs-string">&#x27;RAD&#x27;</span>,<span class="hljs-string">&#x27;TAX&#x27;</span>,<span class="hljs-string">&#x27;PTRATIO&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>,<span class="hljs-string">&#x27;LSTAT&#x27;</span>])<br>data_train.describe() <br><br><span class="hljs-comment"># y=Σwixi+</span><br><span class="hljs-comment"># Because the derivation of b is all 1, add a bias b to the data and set it to 1, as a feature of the data and update the gradient wi*b=wi</span><br>data_train[<span class="hljs-string">&#x27;bias&#x27;</span>]  = <span class="hljs-number">1</span><br>data_train<br><br></code></pre></td></tr></table></figure>
<p>Divide the data set, where 20% of the data is used as the test set
X_test, y_test, and the other 80% are used as the training set X_train,
y_train, where random_state is the random seed</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br>train_x, test_x, train_y, test_y = train_test_split(data_train, data_traget, test_size = <span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;train_x.shape, train_y.shape&#x27;</span>, train_x.shape, train_y.shape)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;test_x.shape, test_y.shape&#x27;</span>, test_x.shape, test_y.shape)<br><br>train_x = np.array(train_x)<br></code></pre></td></tr></table></figure>
<h3 id="model-training-and-gradient-update">Model training and gradient
update</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">l1_cost</span>(<span class="hljs-params">x, y, theta</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    x: 特征</span><br><span class="hljs-string">    y: 目标值</span><br><span class="hljs-string">    thta: 模型参数</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    k = x.shape[<span class="hljs-number">0</span>]<br>    total_cost = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        total_cost += <span class="hljs-number">1</span>/k * np.<span class="hljs-built_in">abs</span>(y[i] -theta.dot(x[i, :]))<br>    <span class="hljs-keyword">return</span> total_cost<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">l2_cost</span>(<span class="hljs-params">x, y, theta</span>):<br>    k = x.shape[<span class="hljs-number">0</span>]<br>    total_cost = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        total_cost += <span class="hljs-number">1</span>/k * (y[i] -theta.dot(x[i,:])) ** <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> total_cost<br><br>np.zeros(<span class="hljs-number">10</span>).shape<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">step_l1_gradient</span>(<span class="hljs-params">x, y, learning_rate, theta</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Function to calculate the gradient of the MAE loss function</span><br><span class="hljs-string">    Return the gradient value 0 for the non-differentiable point at 0</span><br><span class="hljs-string">    X:特征向量</span><br><span class="hljs-string">    y：目标值</span><br><span class="hljs-string">    learing_rate:学习率</span><br><span class="hljs-string">    theta:参数</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    n = x.shape[<span class="hljs-number">0</span>]<br>        <span class="hljs-comment"># print(n)</span><br>    e = y - x @ theta<br>    gradients = - (x.T @ np.sign(e)) / n <span class="hljs-comment"># sign is a sign function</span><br>    thata = theta - learning_rate * gradients<br>    <span class="hljs-keyword">return</span> theta<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">step_l2_gradient</span>(<span class="hljs-params">x, y, learning_rate, theta</span>):<br>    k = x.shape[<span class="hljs-number">0</span>]<br>    n = x.shape[<span class="hljs-number">1</span>]<br>    gradients = np.zeros(n)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            gradients[j] += (-<span class="hljs-number">2</span>/k) * (y[i] - (theta.dot(x[i, :]))) * x[i, j]<br>    theta = theta - learning_rate * gradient<br>    <span class="hljs-keyword">return</span> theta<br><br><span class="hljs-comment"># def step_gradient(X, y, learning_rate, theta):</span><br><span class="hljs-comment">#     &quot;&quot;&quot;</span><br><span class="hljs-comment">#     X:特征向量</span><br><span class="hljs-comment">#     y：目标值</span><br><span class="hljs-comment">#     learing_rate:学习率</span><br><span class="hljs-comment">#     theta:参数</span><br><span class="hljs-comment">#     &quot;&quot;&quot;</span><br><span class="hljs-comment">#     m_deriv = 0</span><br><span class="hljs-comment">#     N = len(X)</span><br><span class="hljs-comment">#     for i in range(N):</span><br><span class="hljs-comment">#         # 计算偏导</span><br><span class="hljs-comment">#         # -x(y - (mx + b)) / |mx + b|</span><br><span class="hljs-comment">#         m_deriv += - X[i] * (y[i] - (theta*X[i] + b)) / abs(y[i] - (theta*X[i] + b))</span><br><span class="hljs-comment">#     # We subtract because the derivatives point in direction of steepest ascent</span><br><span class="hljs-comment">#     theta -= (m_deriv / float(N)) * learning_rate</span><br><span class="hljs-comment"># #     theta = theta - learning_rate * gradients</span><br><span class="hljs-comment">#     return theta</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gradient_descent</span>(<span class="hljs-params">train_x, train_y, learning_rate, iterations</span>):<br>    k = train_x.shape[<span class="hljs-number">0</span>]<br>    n = train_x.shape[<span class="hljs-number">1</span>]<br>    theta = np.zeros(n) <span class="hljs-comment"># Initialization parameters</span><br><br>    loss_values = []<br>    <span class="hljs-comment"># print(theta.shape)</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(iterations):<br>        theta = step_l1_gradient(train_x, train_y, learning_rate, theta)<br>        loss = l1_cost(train_x, train_y, theta)<br>        loss_values.append(loss)<br>        <span class="hljs-built_in">print</span>(i, <span class="hljs-string">&#x27;cost:&#x27;</span>, loss)<br>    <span class="hljs-keyword">return</span> theta, loss_values<br><br><span class="hljs-comment">#  Training parameters</span><br>learning_rate = <span class="hljs-number">0.04</span> <span class="hljs-comment"># Learning rate</span><br>iterations = <span class="hljs-number">300</span> <span class="hljs-comment"># Number of iterations</span><br>theta, loss_values = gradient_descent(train_x, train_y, learning_rate, iterations)<br></code></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T14:21:07.776Z" title="8/31/2021, 10:21:07 PM">2021-08-31</time>发表</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/boston_data_CART/">Boston house price CART regression tree</a></p><div class="content"><h2 id="on-the-code">On the code</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># CART regression tree prediction</span><br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_boston<br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> r2_score,mean_absolute_error, mean_squared_error<br><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor,export_graphviz<br><span class="hljs-keyword">import</span> graphviz<br><br><span class="hljs-comment"># Prepare data set</span><br>boston = load_boston()<br><br><span class="hljs-comment"># Explore data</span><br><span class="hljs-built_in">print</span>(boston.feature_names)<br><br><span class="hljs-comment"># Get feature set and price</span><br>features = boston.data<br>prices = boston.target<br><br><br><span class="hljs-comment"># Randomly extract 33% of the data as the test set, and the rest as the training set</span><br>train_features, test_features, train_price, test_price = train_test_split(features,prices,test_size=<span class="hljs-number">0.33</span>)<br><br><span class="hljs-comment"># Create CART regression tree</span><br>dtr = DecisionTreeRegressor()<br><br><span class="hljs-comment"># Fitting and constructing CART regression tree</span><br>dtr.fit(train_features, train_price)<br><br><span class="hljs-comment"># Predict housing prices in the test set</span><br>predict_price = dtr.predict(test_features)<br><br>grap_data = export_graphviz(dtr, out_file=<span class="hljs-literal">None</span>)<br>graph = graphviz.Source(grap_data)<br><br><span class="hljs-comment"># Result evaluation of test set</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Regression tree mean squared deviation:&#x27;</span>,mean_squared_error(test_price, predict_price))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Regression tree absolute value deviation mean:&#x27;</span>,mean_absolute_error(test_price, predict_price))<br><br><span class="hljs-comment"># Generate regression tree visualization</span><br>graph.render(<span class="hljs-string">&#x27;Boston&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>!&gt; Before running this code, please ensure that the relevant
dependencies have been installed;</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/12/">上一页</a></div><div class="pagination-next"><a href="/page/14/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/12/">12</a></li><li><a class="pagination-link is-current" href="/page/13/">13</a></li><li><a class="pagination-link" href="/page/14/">14</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/17/">17</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/bdff168cf8a71c11d2712a1679a00c54?s=128" alt="茶桁"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">茶桁</p><p class="is-size-6 is-block">AI游民</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shang Hai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">165</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">21</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hivandu" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hivan"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/hivan"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com/hivan"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4NzE4MDQzMg==&amp;action=getalbum&amp;album_id=2932504849574543360&amp;scene=173&amp;from_msgid=2648747980&amp;from_itemidx=1&amp;count=3&amp;nolastread=1&amp;token=1758883909&amp;lang=zh_CN#wechat_redirect"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.zhihu.com/column/c_1424326166602178560" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">塌缩的奇点</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhihu.com/column/hivandu" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">茶桁-知乎</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/"><span class="level-start"><span class="level-item">AI秘籍</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="level-start"><span class="level-item">从零开始接触人工智能大模型</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-05T03:28:07.000Z">2023-08-05</time></p><p class="title"><a href="/Detailed-of-string/">8. 字符串详解</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-04T08:13:00.000Z">2023-08-04</time></p><p class="title"><a href="/python-Built-in-functions/">7. Python的内置函数</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-03T06:07:17.000Z">2023-08-03</time></p><p class="title"><a href="/Higher-order-functions/">6. Python的高阶函数</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-02T11:23:14.000Z">2023-08-02</time></p><p class="title"><a href="/2023_8_3_Kalman/">卡尔曼滤波器的非数学介绍</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-01T15:43:14.000Z">2023-08-01</time></p><p class="title"><a href="/Modular-programming/">5. 模块化编程</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a><p class="is-size-7"><span>&copy; 2023 Hivan Du</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>