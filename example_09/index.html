<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>茶桁.MAMT</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶桁.MAMT"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶桁.MAMT"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="CNN The source code: example_09: CNN"><meta property="og:type" content="blog"><meta property="og:title" content="茶桁.MAMT"><meta property="og:url" content="https://hivan.me/example_09/"><meta property="og:site_name" content="茶桁.MAMT"><meta property="og:description" content="CNN The source code: example_09: CNN"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://qiniu.hivan.me/MAMToutput.png?img"><meta property="og:image" content="http://qiniu.hivan.me/MAMTimage-20210901131659902.png?img"><meta property="og:image" content="http://qiniu.hivan.me/MAMTimage-20210901131741884.png?img"><meta property="og:image" content="http://qiniu.hivan.me/MAMTimage-20210901132522728.png?img"><meta property="og:image" content="http://qiniu.hivan.me/MAMTimage-20210901132551457.png?img"><meta property="og:image" content="http://qiniu.hivan.me/MAMTimage-20210901132631369.png?img"><meta property="article:published_time" content="2021-09-02T12:59:46.687Z"><meta property="article:modified_time" content="2023-06-01T07:59:17.786Z"><meta property="article:author" content="Hivan Du"><meta property="article:tag" content="AI,人工智能,代码,大语言模型"><meta property="twitter:card" content="hivan"><meta property="twitter:image:src" content="http://qiniu.hivan.me/MAMToutput.png?img"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hivan.me/example_09/"},"headline":"茶桁.MAMT","image":[],"datePublished":"2021-09-02T12:59:46.687Z","dateModified":"2023-06-01T07:59:17.786Z","author":{"@type":"Person","name":"Hivan Du"},"publisher":{"@type":"Organization","name":"茶桁.MAMT","logo":{"@type":"ImageObject","url":"https://hivan.me/img/logo.svg"}},"description":"CNN The source code: example_09: CNN"}</script><link rel="canonical" href="https://hivan.me/example_09/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivanu"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-09-02T12:59:46.687Z" title="9/2/2021, 8:59:46 PM">2021-09-02</time>发表</span><span class="level-item"><time dateTime="2023-06-01T07:59:17.786Z" title="6/1/2023, 3:59:17 PM">2023-06-01</time>更新</span><span class="level-item">17 分钟读完 (大约2552个字)</span></div></div><div class="content"><h1 id="CNN"><a href="#CNN" class="headerlink" title="CNN"></a>CNN</h1><blockquote>
<p>The source code: <a target="_blank" rel="noopener" href="https://github.com/hivandu/practise/blob/master/AI_core_competence/Basic%20ability/example_09.ipynb">example_09: CNN</a></p>
</blockquote>
<span id="more"></span>

<h2 id="CNN-Principle"><a href="#CNN-Principle" class="headerlink" title="CNN Principle"></a>CNN Principle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> unpack</span><br><span class="line"><span class="keyword">from</span> torchvision.datasets <span class="keyword">import</span> MNIST</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"></span><br><span class="line">mnist_dataset_train = MNIST(root = <span class="string">&#x27;~/data/course_data&#x27;</span>, train=<span class="literal">True</span>, download = <span class="literal">True</span>)</span><br><span class="line">mnist_dataset_test = MNIST(root = <span class="string">&#x27;~/data/course_data&#x27;</span>, train=<span class="literal">False</span>, download = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>



<p>The first machine vision problem: Let the computer automatically distinguish between 0 and 6</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">X_train = mnist_dataset_train.data.numpy()</span><br><span class="line">y_train = mnist_dataset_train.targets.numpy()</span><br><span class="line"></span><br><span class="line">X_test = mnist_dataset_test.data.numpy()</span><br><span class="line">y_test = mnist_dataset_test.targets.numpy()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz</span></span><br><span class="line"><span class="string">Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ~/data/course_data/MNIST/raw/train-images-idx3-ubyte.gz</span></span><br><span class="line"><span class="string">9913344it [00:02, 4759648.85it/s]  </span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">5120it [00:00, 12492633.21it/s]Extracting ~/data/course_data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ~/data/course_data/MNIST/raw</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="Explain-CNN-principles"><a href="#Explain-CNN-principles" class="headerlink" title="Explain CNN principles"></a>Explain CNN principles</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">conv</span>(<span class="params">image, filter_</span>):</span><br><span class="line">    <span class="comment"># Convolution operation</span></span><br><span class="line">    <span class="built_in">print</span>(image.shape)</span><br><span class="line">    <span class="built_in">print</span>(filter_.shape)</span><br><span class="line">    <span class="keyword">assert</span> image.shape[-<span class="number">1</span>] == filter_.shape[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    test_image = image</span><br><span class="line">    height, width = filter_.shape[<span class="number">0</span>], filter_.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    filter_result = np.zeros((</span><br><span class="line">        test_image.shape[<span class="number">0</span>]-height + <span class="number">1</span>,</span><br><span class="line">        test_image.shape[<span class="number">1</span>]-width + <span class="number">1</span></span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(test_image.shape[<span class="number">0</span>]-height + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(test_image.shape[<span class="number">1</span>]-width + <span class="number">1</span>):</span><br><span class="line">            sub_windows = test_image[h: h + height, w: w + width, :]</span><br><span class="line">            op = np.<span class="built_in">sum</span>(np.multiply(sub_windows, filter_))</span><br><span class="line"></span><br><span class="line">            filter_result[h][w] = op</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> filter_result</span><br><span class="line"></span><br><span class="line"><span class="comment"># Part 2: Strides</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Try to modify stride in Conv Function</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Part3: Pooling</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Create a pooling cell for conv</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Part4: Volume</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Create 3-d volume filter</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Part5: Fully Connected Layers</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Create Fully Connected Layer, to flatten</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Part6: Cross-Entropy</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Create Cross-Entropy cell to get loss value</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># Part7: ResNet</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Why we need resNet, and its functions</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResBlock</span>(nn.Module):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    A very basic ResNet unit</span></span><br><span class="line"><span class="string">    The unit passed:</span></span><br><span class="line"><span class="string">        batch normal</span></span><br><span class="line"><span class="string">        The output value retains the original input value, so that our result does not dissipate</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n_channel</span>):</span><br><span class="line">        <span class="built_in">super</span>(ResBlock, self).__init__()</span><br><span class="line">        self.conv = nn.Conv2d(n_channel, n_channel, kernel_size = <span class="number">3</span>, padding=<span class="number">1</span>, bias = <span class="literal">False</span>)</span><br><span class="line">        self.bath_norm = nn.BatchNorm2d(num_features = n_channel)</span><br><span class="line"></span><br><span class="line">        torch.nn.init.constant_(self.bath_norw.weight, <span class="number">0.5</span>)</span><br><span class="line">        torch.nn.init.zeros_(self.bath_norm.bias)</span><br><span class="line">        torch.nn.init.kaiming_normal_(self.conv.weight, nonlinearity =<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">        <span class="comment"># sum(windows * filter) ==&gt; The larger the windows, the larger the added value, the smaller the windows, the smaller the value</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">    out = self.conv(x)</span><br><span class="line">    out = self.conv(out)</span><br><span class="line">    out = self.bath_norm(out)</span><br><span class="line">    out = torch.relu(out)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> out + x</span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">&#x27;~/data/course_data/doo.jpeg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    image_array = np.array(image)</span><br><span class="line">    plt.imshow(image_array)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Robert 算子</span></span><br><span class="line">    rebert_1_kernel = np.array([</span><br><span class="line">        [<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, -<span class="number">1</span>]</span><br><span class="line">    ])</span><br><span class="line">    robert_2_kernel = np.array([</span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">        [-<span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="comment">#Sobel 算子</span></span><br><span class="line">    sobel_x_kernel = np.array([</span><br><span class="line">        [-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">        [-<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>],</span><br><span class="line">        [-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">    ])</span><br><span class="line">    sobel_y_kernel = np.array([</span><br><span class="line">        [-<span class="number">1</span>, -<span class="number">2</span>, -<span class="number">1</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Laplacian 算子</span></span><br><span class="line">    laplacian_kernel = np.array([</span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, -<span class="number">4</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    filters = [</span><br><span class="line">        np.array([sobel_x_kernel] * <span class="number">3</span>),</span><br><span class="line">        np.array([sobel_y_kernel] * <span class="number">3</span>),</span><br><span class="line">        np.array([laplacian_kernel] * <span class="number">3</span>)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, f <span class="keyword">in</span> <span class="built_in">enumerate</span>(filters):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;applying filter: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i))</span><br><span class="line"></span><br><span class="line">        plt.subplot(<span class="number">3</span>, <span class="number">3</span>, i * <span class="number">3</span> + <span class="number">1</span>)</span><br><span class="line">        plt.imshow(image_array)</span><br><span class="line"></span><br><span class="line">        filter_result = conv(image_array, f)</span><br><span class="line">        plt.subplot(<span class="number">3</span>, <span class="number">3</span>, i * <span class="number">3</span> + <span class="number">2</span>)</span><br><span class="line">        plt.imshow(filter_result)</span><br><span class="line"></span><br><span class="line">        plt.subplot(<span class="number">3</span>, <span class="number">3</span>, i * <span class="number">3</span> + <span class="number">3</span>)</span><br><span class="line">        plt.imshow(filter_result, cmap = <span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment">#ResNet</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">applying filter: 0</span></span><br><span class="line"><span class="string">(1931, 1931, 3)</span></span><br><span class="line"><span class="string">(3, 3, 3)</span></span><br><span class="line"><span class="string">applying filter: 1</span></span><br><span class="line"><span class="string">(1931, 1931, 3)</span></span><br><span class="line"><span class="string">(3, 3, 3)</span></span><br><span class="line"><span class="string">applying filter: 2</span></span><br><span class="line"><span class="string">(1931, 1931, 3)</span></span><br><span class="line"><span class="string">(3, 3, 3)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="http://qiniu.hivan.me/MAMToutput.png?img" alt="output"></p>
<h2 id="Identification-codes"><a href="#Identification-codes" class="headerlink" title="Identification codes"></a>Identification codes</h2><p>Train a model to classify and recognize the characters in the verification code, and finally complete the verification code recognition</p>
<p>The data set used contains a total of 36 characters from 0-9 and AZ. There are 50 pictures for each character in the training set, and 10 pictures for each character in the verification set. The verification code data set is composed of 4 character pictures taken out randomly. become.</p>
<h3 id="Related-knowledge-points"><a href="#Related-knowledge-points" class="headerlink" title="Related knowledge points"></a>Related knowledge points</h3><ol>
<li>Data Reading</li>
<li>Use torch to build, train, and verify models</li>
<li>Model prediction and image segmentation</li>
</ol>
<h3 id="analyze"><a href="#analyze" class="headerlink" title="analyze"></a>analyze</h3><h4 id="Question-1-Establish-a-character-comparison-table"><a href="#Question-1-Establish-a-character-comparison-table" class="headerlink" title="Question 1-Establish a character comparison table"></a>Question 1-Establish a character comparison table</h4><p>We can reverse each pair of keys and values by traversing the dictionary and store them in a new dictionary. The sample code is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_dict = &#123;v: k for k, v in old_dict.items()&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Question-2-Define-datasets-and-dataloader"><a href="#Question-2-Define-datasets-and-dataloader" class="headerlink" title="Question 2-Define datasets and dataloader"></a>Question 2-Define datasets and dataloader</h4><p>In opencv-python, you can use <code>image = cv2.medianBlur(image, kernel_size)</code> for median filtering.</p>
<h4 id="Question-3-Define-the-network-structure"><a href="#Question-3-Define-the-network-structure" class="headerlink" title="Question 3-Define the network structure"></a>Question 3-Define the network structure</h4><p>In torch, the convolution and fully connected layers are defined as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)</span><br><span class="line">fc = nn.Linear(in_features, out_features, bias)</span><br></pre></td></tr></table></figure>
<h4 id="Question-4-Define-the-model-training-function"><a href="#Question-4-Define-the-model-training-function" class="headerlink" title="Question 4-Define the model training function"></a>Question 4-Define the model training function</h4><p>The model training process of the torch framework includes operations such as clearing the gradient, forward propagation, calculating the loss, calculating the gradient, and updating the weight, among which:</p>
<ol>
<li>Clear the gradient: the purpose is to eliminate the interference between step and step, that is, use only one batch of data loss to calculate the gradient and update the weight each time. Generally can be placed first or last;</li>
<li>Forward propagation: use a batch of data to run the process of forward propagation to generate model output results;</li>
<li>Calculate the loss: use the defined loss function, model output results and label to calculate the loss value of a single batch;</li>
<li>Calculate the gradient: According to the loss value, calculate the gradient value required in this optimization in the ownership of the model;</li>
<li>Update weight: Use the calculated gradient value to update the value of all weights.<br>The sample code of a single process is as follows:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; optimizer.zero_grad() # Clear the gradient (can also be placed in the last line)</span><br><span class="line">&gt;&gt;&gt; output = model(data) # forward propagation</span><br><span class="line">&gt;&gt;&gt; loss = loss_fn(output, target) # Calculate loss</span><br><span class="line">&gt;&gt;&gt; loss.backward() # Calculate the gradient</span><br><span class="line">&gt;&gt;&gt; optimizer.step() # update weight</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h3><h4 id="Import-the-library-to-be-used-in-this-project"><a href="#Import-the-library-to-be-used-in-this-project" class="headerlink" title="Import the library to be used in this project"></a>Import the library to be used in this project</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">os.environ[<span class="string">&#x27;KMP_DUPLICATE_LIB_OK&#x27;</span>] = <span class="string">&#x27;True&#x27;</span></span><br></pre></td></tr></table></figure>



<h4 id="Understanding-the-data-set"><a href="#Understanding-the-data-set" class="headerlink" title="Understanding the data set"></a>Understanding the data set</h4><p>Define the data path</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">train_data_dir = <span class="string">&#x27;~/data/course_data/train_data.bin&#x27;</span></span><br><span class="line">val_data_dir = <span class="string">&#x27;~/data/course_data/val_data.bin&#x27;</span></span><br><span class="line">verification_code_dir = <span class="string">&#x27;~/data/course_data/verification_code_data.bin&#x27;</span></span><br></pre></td></tr></table></figure>

<p>The data set used is stored in a binary file, and we need to define a function to read the picture in the binary file.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_file</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, mode =<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        result = pickle.load(f)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<p>See what the data set looks like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">train_data = load_file(train_data_dir)</span><br><span class="line">img_test = <span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1800</span>, <span class="number">50</span>):</span><br><span class="line">    img_test.append(train_data[i][<span class="number">1</span>])</span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">37</span>):</span><br><span class="line">    plt.subplot(<span class="number">6</span>, <span class="number">6</span>, i)</span><br><span class="line">    plt.imshow(img_test[i-<span class="number">1</span>])</span><br><span class="line">    plt.xticks([])</span><br><span class="line">    plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>



<p><img src="http://qiniu.hivan.me/MAMTimage-20210901131659902.png?img" alt="image-20210901131659902"></p>
<h4 id="View-single-big-picture"><a href="#View-single-big-picture" class="headerlink" title="View single big picture"></a>View single big picture</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plt.subplot(6, 6, i)</span></span><br><span class="line">plt.imshow(train_data[<span class="number">500</span>][<span class="number">1</span>])</span><br><span class="line">plt.xticks([])</span><br><span class="line">plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="http://qiniu.hivan.me/MAMTimage-20210901131741884.png?img" alt="image-20210901131741884"></p>
<p>It can be seen that there is a lot of noise in the character picture, and the noise will have an adverse effect on the model prediction result, so we can use a specific filter to eliminate the picture noise during data preprocessing.</p>
<h4 id="Question-1-Establish-a-character-comparison-table-1"><a href="#Question-1-Establish-a-character-comparison-table-1" class="headerlink" title="Question 1-Establish a character comparison table"></a>Question 1-Establish a character comparison table</h4><p>A simple observation shows that there are no duplicates in the key and value in the character dictionary just defined. Therefore, the key and value in the dictionary can be reversed so that we can use the value to find the key (convert the model prediction result into a readable character)<br>Now you need to complete the following code to reverse the keys and values in the dictionary (for example: <code>dict=&#123;&#39;A&#39;:10,&#39;B&#39;:11&#125;</code> and get <code>new_dict=&#123;10:&#39;A &#39;,11:&#39;B&#39;&#125;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">char_dict = &#123;<span class="string">&#x27;0&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;1&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;3&#x27;</span>:<span class="number">3</span>,<span class="string">&#x27;4&#x27;</span>:<span class="number">4</span>,<span class="string">&#x27;5&#x27;</span>:<span class="number">5</span>,<span class="string">&#x27;6&#x27;</span>:<span class="number">6</span>,<span class="string">&#x27;7&#x27;</span>:<span class="number">7</span>,<span class="string">&#x27;8&#x27;</span>:<span class="number">8</span>,<span class="string">&#x27;9&#x27;</span>:<span class="number">9</span>,\</span><br><span class="line">            <span class="string">&#x27;A&#x27;</span>:<span class="number">10</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">11</span>,<span class="string">&#x27;C&#x27;</span>:<span class="number">12</span>,<span class="string">&#x27;D&#x27;</span>:<span class="number">13</span>,<span class="string">&#x27;E&#x27;</span>:<span class="number">14</span>,<span class="string">&#x27;F&#x27;</span>:<span class="number">15</span>,<span class="string">&#x27;G&#x27;</span>:<span class="number">16</span>,<span class="string">&#x27;H&#x27;</span>:<span class="number">17</span>,<span class="string">&#x27;I&#x27;</span>:<span class="number">18</span>,<span class="string">&#x27;J&#x27;</span>:<span class="number">19</span>,<span class="string">&#x27;K&#x27;</span>:<span class="number">20</span>,<span class="string">&#x27;L&#x27;</span>:<span class="number">21</span>,<span class="string">&#x27;M&#x27;</span>:<span class="number">22</span>,\</span><br><span class="line">            <span class="string">&#x27;N&#x27;</span>:<span class="number">23</span>,<span class="string">&#x27;O&#x27;</span>:<span class="number">24</span>,<span class="string">&#x27;P&#x27;</span>:<span class="number">25</span>,<span class="string">&#x27;Q&#x27;</span>:<span class="number">26</span>,<span class="string">&#x27;R&#x27;</span>:<span class="number">27</span>,<span class="string">&#x27;S&#x27;</span>:<span class="number">28</span>,<span class="string">&#x27;T&#x27;</span>:<span class="number">29</span>,<span class="string">&#x27;U&#x27;</span>:<span class="number">30</span>,<span class="string">&#x27;V&#x27;</span>:<span class="number">31</span>,<span class="string">&#x27;W&#x27;</span>:<span class="number">32</span>,<span class="string">&#x27;X&#x27;</span>:<span class="number">33</span>,<span class="string">&#x27;Y&#x27;</span>:<span class="number">34</span>,<span class="string">&#x27;Z&#x27;</span>:<span class="number">35</span> &#125;</span><br><span class="line"></span><br><span class="line">new_char_dict = &#123;v : k <span class="keyword">for</span> k, v <span class="keyword">in</span> char_dict.items()&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Question-2-Define-datasets-and-dataloader-1"><a href="#Question-2-Define-datasets-and-dataloader-1" class="headerlink" title="Question 2-Define datasets and dataloader"></a>Question 2-Define datasets and dataloader</h4><p>We need to use <code>torch.utils.data.Dataset</code> as the parent class to define our own datasets in order to standardize our own datasets.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">iDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, file_name, transforms</span>):</span><br><span class="line">        self.file_name = file_name <span class="comment"># file name</span></span><br><span class="line">        self.image_label_arr = load_file(self.file_name) <span class="comment"># read binary file</span></span><br><span class="line">        self.transforms = transforms <span class="comment"># Image converter</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        label, img = self.image_label_arr[index]</span><br><span class="line">        img = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY) <span class="comment"># Convert the picture to grayscale</span></span><br><span class="line">        img = cv2.medianBlur(img, <span class="number">5</span>) <span class="comment"># Use median blur to remove image noise</span></span><br><span class="line">        img = self.transforms(img) <span class="comment"># Transform the image</span></span><br><span class="line">        <span class="keyword">return</span> img, char_dict[label[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.image_label_arr)</span><br></pre></td></tr></table></figure>



<p>Now we can define transform and dataloader.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">transform = transforms.Compose([transforms.ToPILImage(),</span><br><span class="line">                                transforms.Resize([<span class="number">28</span>, <span class="number">28</span>]), <span class="comment"># Adjust the image size to 28*28</span></span><br><span class="line">                                transforms.ToTensor(), <span class="comment"># Convert the picture to tensor</span></span><br><span class="line">                                transforms.Normalize(mean = [<span class="number">0.5</span>], std = [<span class="number">0.5</span>])]) <span class="comment"># Perform normalization processing</span></span><br><span class="line"></span><br><span class="line">train_datasets = iDataset(train_data_dir, transform)</span><br><span class="line">train_loader = DataLoader(dataset=train_datasets, batch_size=<span class="number">32</span>, shuffle = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">val_datasets = iDataset(val_data_dir, transform)</span><br><span class="line">val_loader = DataLoader(dataset=val_datasets, batch_size = <span class="number">32</span>, shuffle = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>



<h4 id="Question-3-Define-the-network-structure-1"><a href="#Question-3-Define-the-network-structure-1" class="headerlink" title="Question 3-Define the network structure"></a>Question 3-Define the network structure</h4><p>After the data is ready, we need to define a simple convolutional neural network. The input of the neural network is <code>[batchsize,chanel(1),w(28),h(28)]</code>, and the output is 36 categories.<br>Our neural network will use 2 convolutional layers with 2 fully connected layers. The parameter settings of these four layers are shown in the following table (the default parameters can be used directly if they are not marked):</p>
<ol>
<li>conv1: in_chanel&#x3D;1, out_chanel&#x3D;10, kernel_size&#x3D;5</li>
<li>conv2: in_chanel&#x3D;10, out_chanel&#x3D;20, kernel_size&#x3D;3</li>
<li>fc1: in_feature&#x3D;2000, out_feature&#x3D;500</li>
<li>fc2: in_feature&#x3D;500, out_feature&#x3D;36</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConvNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span></span></span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">1</span>, <span class="number">10</span>, <span class="number">5</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(<span class="number">10</span>, <span class="number">20</span>, <span class="number">3</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">20</span> * <span class="number">10</span> * <span class="number">10</span>,  <span class="number">500</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">500</span>, <span class="number">36</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># inputsize: [b, 1, 28, 28]</span></span><br><span class="line">        in_size = x.size(<span class="number">0</span>) <span class="comment"># b</span></span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = F.relu(out)</span><br><span class="line">        out = F.max_pool2d(out, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">        out = self.conv2(out)</span><br><span class="line">        out = F.relu(out)</span><br><span class="line">        out = out.view(in_size, -<span class="number">1</span>)</span><br><span class="line">        out = self.fc1(out)</span><br><span class="line">        out = F.relu(out)</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        out = F.log_softmax(out, dim = <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>



<h4 id="Question-4-Define-the-model-training-function-1"><a href="#Question-4-Define-the-model-training-function-1" class="headerlink" title="Question 4-Define the model training function"></a>Question 4-Define the model training function</h4><p>Next, we need to complete the model training function to achieve the following operations:</p>
<ol>
<li>Clear the gradient</li>
<li>Forward propagation</li>
<li>Calculate the gradient</li>
<li>Update weights</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">model, train_loader, optimizer, epoch</span>):</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        output = model(data)</span><br><span class="line">        loss = F.nll_loss(output, target)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        <span class="keyword">if</span>(batch_idx + <span class="number">1</span>) % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Train Epoch: &#123;&#125; [&#123;&#125; / &#123;&#125; (&#123;:.0f&#125; %)]\tLoss: &#123;:.6f&#125;&#x27;</span>.<span class="built_in">format</span>(epoch, batch_idx * <span class="built_in">len</span>(data), <span class="built_in">len</span>(train_loader.dataset), <span class="number">100.</span> * batch_idx / <span class="built_in">len</span>(train_loader), loss.item()))</span><br></pre></td></tr></table></figure>



<h5 id="Define-model-test-function"><a href="#Define-model-test-function" class="headerlink" title="Define model test function"></a>Define model test function</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">model, test_loader</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    test_loss = <span class="number">0</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> data, target <span class="keyword">in</span> test_loader:</span><br><span class="line">            output = model(data)</span><br><span class="line">            test_loss += F.nll_loss(output, target, reduction = <span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">            pred = output.<span class="built_in">max</span>(<span class="number">1</span>, keepdim = <span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line">            correct += pred.eq(target.view_as(pred)).<span class="built_in">sum</span>().item()</span><br><span class="line">    test_loss /= <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy: &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%) \n&#x27;</span>.<span class="built_in">format</span>(test_loss, correct, <span class="built_in">len</span>(test_loader.dataset), <span class="number">100.</span> * correct / <span class="built_in">len</span>(test_loader.dataset)))</span><br></pre></td></tr></table></figure>



<h5 id="Define-model-and-optimizer"><a href="#Define-model-and-optimizer" class="headerlink" title="Define model and optimizer"></a>Define model and optimizer</h5><p>We define the model structure we just built as model and choose to use the Adam optimizer.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model = ConvNet()</span><br><span class="line">optimizer = optim.Adam(model.parameters())</span><br></pre></td></tr></table></figure>



<h5 id="Model-training-and-testing"><a href="#Model-training-and-testing" class="headerlink" title="Model training and testing"></a>Model training and testing</h5><p>We can first set the number of epochs to 3 and perform model training to see how accurate the model is and whether it meets the requirements of verification code recognition.<br>If the model accuracy is not enough, you can also try to adjust the number of epochs and retrain.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">EPOCHS = <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, EPOCHS + <span class="number">1</span>):</span><br><span class="line">    train(model, train_loader, optimizer, epoch)</span><br><span class="line">    test(model, val_loader)</span><br><span class="line">    </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Train Epoch: 1 [288 / 1800 (16 %)]	Loss: 3.340514</span></span><br><span class="line"><span class="string">Train Epoch: 1 [608 / 1800 (33 %)]	Loss: 2.872326</span></span><br><span class="line"><span class="string">Train Epoch: 1 [928 / 1800 (51 %)]	Loss: 1.977929</span></span><br><span class="line"><span class="string">Train Epoch: 1 [1248 / 1800 (68 %)]	Loss: 1.098688</span></span><br><span class="line"><span class="string">Train Epoch: 1 [1568 / 1800 (86 %)]	Loss: 0.535660</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.2888, Accuracy: 328/360 (91%) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Train Epoch: 2 [288 / 1800 (16 %)]	Loss: 0.072813</span></span><br><span class="line"><span class="string">Train Epoch: 2 [608 / 1800 (33 %)]	Loss: 0.139866</span></span><br><span class="line"><span class="string">Train Epoch: 2 [928 / 1800 (51 %)]	Loss: 0.109487</span></span><br><span class="line"><span class="string">Train Epoch: 2 [1248 / 1800 (68 %)]	Loss: 0.058259</span></span><br><span class="line"><span class="string">Train Epoch: 2 [1568 / 1800 (86 %)]	Loss: 0.013144</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.0099, Accuracy: 360/360 (100%) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Train Epoch: 3 [288 / 1800 (16 %)]	Loss: 0.010245</span></span><br><span class="line"><span class="string">Train Epoch: 3 [608 / 1800 (33 %)]	Loss: 0.004797</span></span><br><span class="line"><span class="string">Train Epoch: 3 [928 / 1800 (51 %)]	Loss: 0.002203</span></span><br><span class="line"><span class="string">Train Epoch: 3 [1248 / 1800 (68 %)]	Loss: 0.006250</span></span><br><span class="line"><span class="string">Train Epoch: 3 [1568 / 1800 (86 %)]	Loss: 0.005230</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.0028, Accuracy: 360/360 (100%)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h5 id="Define-model-test-function-1"><a href="#Define-model-test-function-1" class="headerlink" title="Define model test function"></a>Define model test function</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">model, test_loader</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    test_loss = <span class="number">0</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> data, target <span class="keyword">in</span> test_loader:</span><br><span class="line">            output = model(data)</span><br><span class="line">            test_loss =+ F.nll_loss(output, target, reduction = <span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">            pred = output.<span class="built_in">max</span>(<span class="number">1</span>, keepdim = <span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line">            correct += pred.eq(target.view_as(pred)).<span class="built_in">sum</span>().item()</span><br><span class="line">    test_loss /= <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy : &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%) \n&#x27;</span>.<span class="built_in">format</span>(test_loss, correct, <span class="built_in">len</span>(test_loader.dataset), <span class="number">100.</span> * correct / <span class="built_in">len</span>(test_loader.dataset)))</span><br></pre></td></tr></table></figure>



<h5 id="Define-model-and-optimizer-1"><a href="#Define-model-and-optimizer-1" class="headerlink" title="Define model and optimizer"></a>Define model and optimizer</h5><p>We define the model structure we just built as model and choose to use the Adam optimizer.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model = ConvNet()</span><br><span class="line">optimizer = optim.Adam(model.parameters())</span><br></pre></td></tr></table></figure>



<h5 id="Model-training-and-testing-1"><a href="#Model-training-and-testing-1" class="headerlink" title="Model training and testing"></a>Model training and testing</h5><p>We can first set the number of epochs to 3 and perform model training to see how accurate the model is and whether it meets the requirements of verification code recognition.<br>If the model accuracy is not enough, you can also try to adjust the number of epochs and retrain.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">EPOCHS = <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, EPOCHS + <span class="number">1</span>):</span><br><span class="line">    train(model, train_loader, optimizer, epoch)</span><br><span class="line">    test(model, val_loader)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Train Epoch: 1 [288 / 1800 (16 %)]	Loss: 3.508450</span></span><br><span class="line"><span class="string">Train Epoch: 1 [608 / 1800 (33 %)]	Loss: 3.288610</span></span><br><span class="line"><span class="string">Train Epoch: 1 [928 / 1800 (51 %)]	Loss: 2.584805</span></span><br><span class="line"><span class="string">Train Epoch: 1 [1248 / 1800 (68 %)]	Loss: 1.180833</span></span><br><span class="line"><span class="string">Train Epoch: 1 [1568 / 1800 (86 %)]	Loss: 0.564084</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.0088, Accuracy : 316/360 (88%) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Train Epoch: 2 [288 / 1800 (16 %)]	Loss: 0.173177</span></span><br><span class="line"><span class="string">Train Epoch: 2 [608 / 1800 (33 %)]	Loss: 0.043262</span></span><br><span class="line"><span class="string">Train Epoch: 2 [928 / 1800 (51 %)]	Loss: 0.054462</span></span><br><span class="line"><span class="string">Train Epoch: 2 [1248 / 1800 (68 %)]	Loss: 0.052596</span></span><br><span class="line"><span class="string">Train Epoch: 2 [1568 / 1800 (86 %)]	Loss: 0.013714</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.0006, Accuracy : 360/360 (100%) </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Train Epoch: 3 [288 / 1800 (16 %)]	Loss: 0.004590</span></span><br><span class="line"><span class="string">Train Epoch: 3 [608 / 1800 (33 %)]	Loss: 0.007654</span></span><br><span class="line"><span class="string">Train Epoch: 3 [928 / 1800 (51 %)]	Loss: 0.004135</span></span><br><span class="line"><span class="string">Train Epoch: 3 [1248 / 1800 (68 %)]	Loss: 0.003140</span></span><br><span class="line"><span class="string">Train Epoch: 3 [1568 / 1800 (86 %)]	Loss: 0.003019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Test set: Average loss: 0.0001, Accuracy : 360/360 (100%) </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<p>The model has been trained! Does the test set accuracy of the last epoch exceed 99%?</p>
<h5 id="Identification-codes-1"><a href="#Identification-codes-1" class="headerlink" title="Identification codes"></a>Identification codes</h5><p>After successfully implementing the digital recognition, we can start the verification code recognition!<br>First, import the verification code data set:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">verification_code_data = load_file(verification_code_dir)</span><br></pre></td></tr></table></figure>



<p>Let’s choose a picture at random (Figure 6) to see what the verification code looks like.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">image = verification_code_data[<span class="number">6</span>]</span><br><span class="line">IMG = Image.fromarray(cv2.cvtColor(image.copy(), cv2.COLOR_BGR2RGB))</span><br><span class="line">plt.imshow(IMG)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="http://qiniu.hivan.me/MAMTimage-20210901132522728.png?img" alt="image-20210901132522728"></p>
<p>Let’s take a look at what effect the median filter can have on the captcha image.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">img = cv2.medianBlur(image.copy(), <span class="number">5</span>)</span><br><span class="line">plt.imshow(img)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="http://qiniu.hivan.me/MAMTimage-20210901132551457.png?img" alt="image-20210901132551457"></p>
<p>Finally, let us look at the actual results of verification code recognition:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">IMAGES = <span class="built_in">list</span>()</span><br><span class="line">NUMS = <span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> verification_code_data:</span><br><span class="line">    IMAGES.append(img)</span><br><span class="line">    img = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)</span><br><span class="line">    image_1 = img[:, :<span class="number">80</span>]</span><br><span class="line">    image_2 = img[:, <span class="number">80</span>:<span class="number">160</span>]</span><br><span class="line">    image_3 = img[:, <span class="number">160</span>:<span class="number">240</span>]</span><br><span class="line">    image_4 = img[:, <span class="number">240</span>:<span class="number">320</span>]</span><br><span class="line">    img_list = [image_1, image_2, image_3, image_4]</span><br><span class="line"></span><br><span class="line">    nums = []</span><br><span class="line">    <span class="keyword">for</span> one_img <span class="keyword">in</span> img_list:</span><br><span class="line">        one_img = transform(one_img)</span><br><span class="line">        one_img = one_img.unsqueeze(<span class="number">0</span>)</span><br><span class="line">        output = model(one_img)</span><br><span class="line">        nums.append(new_char_dict[torch.argmax(output).item()])</span><br><span class="line">    NUMS.append(<span class="string">&#x27;Verification_code: &#x27;</span>+ <span class="string">&#x27;&#x27;</span>.join(nums))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize = (<span class="number">20</span>, <span class="number">20</span>))</span><br><span class="line">plt.subplots_adjust(wspace = <span class="number">0.2</span>, hspace=<span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    plt.subplot(<span class="number">5</span>, <span class="number">2</span>, i)</span><br><span class="line">    plt.title(NUMS[i-<span class="number">1</span>], fontsize = <span class="number">25</span>, color = <span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">    plt.imshow(IMAGES[i - <span class="number">1</span>])</span><br><span class="line">    plt.xticks([])</span><br><span class="line">    plt.yticks([])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="http://qiniu.hivan.me/MAMTimage-20210901132631369.png?img" alt="image-20210901132631369"></p>
</div><div class="article-licensing box"><div class="licensing-title"><p><a href="https://hivan.me/example_09/">https://hivan.me/example_09/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hivan Du</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-09-02</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-01</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" alt="支付宝"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/example_12/"><i class="level-item fas fa-chevron-left"></i><span class="level-item"> </span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/example_06/"><span class="level-item"> </span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://hivan.me/example_09/';
            this.page.identifier = 'example_09/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'hivan' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="茶桁.MAMT"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">茶桁.MAMT</p><p class="is-size-6 is-block">Hivan Du</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shang Hai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">130</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">64</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/develop/"><span class="level-start"><span class="level-item">develop</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/software/"><span class="level-start"><span class="level-item">software</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="level-start"><span class="level-item">从零开始接触人工智能大模型</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-28T09:50:41.000Z">2023-05-28</time></p><p class="title"><a href="/Use-AI-to-write-a-snake-game/">利用AI写一个『贪吃蛇游戏』</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-28T09:17:32.000Z">2023-05-28</time></p><p class="title"><a href="/Use-multi-step-prompts-to-ask-AI-to-write-tests-for-you/">13 使用多步提示语让AI帮你写测试</a></p><p class="categories"><a href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/">从零开始接触人工智能大模型</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-26T09:15:54.000Z">2023-05-26</time></p><p class="title"><a href="/AI-create-a-excel-plugin/">12 AI帮你写个小插件，轻松处理Excel文件</a></p><p class="categories"><a href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/">从零开始接触人工智能大模型</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-20T09:14:42.000Z">2023-05-20</time></p><p class="title"><a href="/Save-costs-with-an-open-source-model/">11 用好开源模型节约成本</a></p><p class="categories"><a href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/">从零开始接触人工智能大模型</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-17T09:02:24.000Z">2023-05-17</time></p><p class="title"><a href="/Use-AI-to-index-and-analyze-documents-and-images/">10 利用AI索引并分析文献和图片</a></p><p class="categories"><a href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/">从零开始接触人工智能大模型</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">76</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/"><span class="level-start"><span class="level-item">2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/"><span class="level-start"><span class="level-item">2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/"><span class="level-start"><span class="level-item">2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/"><span class="level-start"><span class="level-item">2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/"><span class="level-start"><span class="level-item">2013</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/"><span class="level-start"><span class="level-item">2012</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2011/"><span class="level-start"><span class="level-item">2011</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2010/"><span class="level-start"><span class="level-item">2010</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2009/"><span class="level-start"><span class="level-item">2009</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2008/"><span class="level-start"><span class="level-item">2008</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2006/"><span class="level-start"><span class="level-item">2006</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ChatGPT/"><span class="tag">ChatGPT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chrome/"><span class="tag">Chrome</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gmail/"><span class="tag">Gmail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google/"><span class="tag">Google</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Google-Plus/"><span class="tag">Google Plus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gplus/"><span class="tag">Gplus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac/"><span class="tag">Mac</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mail/"><span class="tag">Mail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Model/"><span class="tag">Model</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NFC/"><span class="tag">NFC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/O2O/"><span class="tag">O2O</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PS/"><span class="tag">PS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QQ/"><span class="tag">QQ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SNS/"><span class="tag">SNS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Stable-Diffusion/"><span class="tag">Stable Diffusion</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tool/"><span class="tag">Tool</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Translate/"><span class="tag">Translate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/allove/"><span class="tag">allove</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/app/"><span class="tag">app</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/avn/"><span class="tag">avn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bluehost/"><span class="tag">bluehost</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/code/"><span class="tag">code</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/device/"><span class="tag">device</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/feed/"><span class="tag">feed</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flickr/"><span class="tag">flickr</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/forward/"><span class="tag">forward</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gmail/"><span class="tag">gmail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/habari/"><span class="tag">habari</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ifttt/"><span class="tag">ifttt</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/install/"><span class="tag">install</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ireader/"><span class="tag">ireader</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/istef/"><span class="tag">istef</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/location/"><span class="tag">location</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/more/"><span class="tag">more</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/net/"><span class="tag">net</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nitrous/"><span class="tag">nitrous</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pageflakes/"><span class="tag">pageflakes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/picasaweb/"><span class="tag">picasaweb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/plugin/"><span class="tag">plugin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reader/"><span class="tag">reader</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/research/"><span class="tag">research</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/search/"><span class="tag">search</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sms/"><span class="tag">sms</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/telnet/"><span class="tag">telnet</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/twitter/"><span class="tag">twitter</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/url/"><span class="tag">url</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/version/"><span class="tag">version</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows-8/"><span class="tag">windows 8</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wordpress/"><span class="tag">wordpress</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%96%E7%95%8C%E6%9D%AF/"><span class="tag">世界杯</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E5%8D%9A/"><span class="tag">微博</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%97%B6%E5%8C%BA/"><span class="tag">时区</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A4%BE%E4%BA%A4/"><span class="tag">社交</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%8A%B1%E5%84%BF%E5%BC%80%E4%BA%86/"><span class="tag">花儿开了</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A1%A8%E6%83%85/"><span class="tag">表情</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BF%87%E6%BB%A4%E5%99%A8/"><span class="tag">过滤器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BF%9B%E5%BA%A6/"><span class="tag">进度</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a><p class="is-size-7"><span>&copy; 2023 Hivan Du</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>