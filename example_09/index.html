<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>CNN - 茶桁.MAMT</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶桁.MAMT"><meta name="msapplication-TileImage" content="https://qiniu.hivan.me/picGo/20230601174411.png?imgNote"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶桁.MAMT"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="The source code: example_09: CNN"><meta property="og:type" content="blog"><meta property="og:title" content="CNN"><meta property="og:url" content="https://hivan.me/example_09/"><meta property="og:site_name" content="茶桁.MAMT"><meta property="og:description" content="The source code: example_09: CNN"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://qiniu.hivan.me/MAMToutput.png?img"><meta property="og:image" content="https://qiniu.hivan.me/MAMTimage-20210901131659902.png?img"><meta property="og:image" content="https://qiniu.hivan.me/MAMTimage-20210901131741884.png?img"><meta property="og:image" content="https://qiniu.hivan.me/MAMTimage-20210901132522728.png?img"><meta property="og:image" content="https://qiniu.hivan.me/MAMTimage-20210901132551457.png?img"><meta property="og:image" content="https://qiniu.hivan.me/MAMTimage-20210901132631369.png?img"><meta property="article:published_time" content="2021-09-02T12:59:46.687Z"><meta property="article:modified_time" content="2023-06-02T03:25:04.786Z"><meta property="article:author" content="Hivan Du"><meta property="article:tag" content="AI,人工智能,代码,大语言模型"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://qiniu.hivan.me/MAMToutput.png?img"><meta property="twitter:creator" content="@hivan"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hivan.me/example_09/"},"headline":"CNN","image":[],"datePublished":"2021-09-02T12:59:46.687Z","dateModified":"2023-06-02T03:25:04.786Z","author":{"@type":"Person","name":"Hivan Du"},"publisher":{"@type":"Organization","name":"茶桁.MAMT","logo":{"@type":"ImageObject","url":"https://hivan.me/img/logo.svg"}},"description":"The source code: example_09: CNN"}</script><link rel="canonical" href="https://hivan.me/example_09/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="茶桁.MAMT" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-09-02T12:59:46.687Z" title="9/2/2021, 8:59:46 PM">2021-09-02</time>发表</span></div></div><h1 class="title is-3 is-size-4-mobile">CNN</h1><div class="content"><blockquote>
<p>The source code: <a
target="_blank" rel="noopener" href="https://github.com/hivandu/practise/blob/master/AI_core_competence/Basic%20ability/example_09.ipynb">example_09:
CNN</a></p>
</blockquote>
<span id="more"></span>
<h2 id="cnn-principle">CNN Principle</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> unpack<br><span class="hljs-keyword">from</span> torchvision.datasets <span class="hljs-keyword">import</span> MNIST<br><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><br>mnist_dataset_train = MNIST(root = <span class="hljs-string">&#x27;~/data/course_data&#x27;</span>, train=<span class="hljs-literal">True</span>, download = <span class="hljs-literal">True</span>)<br>mnist_dataset_test = MNIST(root = <span class="hljs-string">&#x27;~/data/course_data&#x27;</span>, train=<span class="hljs-literal">False</span>, download = <span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>The first machine vision problem: Let the computer automatically
distinguish between 0 and 6</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">X_train = mnist_dataset_train.data.numpy()<br>y_train = mnist_dataset_train.targets.numpy()<br><br>X_test = mnist_dataset_test.data.numpy()<br>y_test = mnist_dataset_test.targets.numpy()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz</span><br><span class="hljs-string">Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ~/data/course_data/MNIST/raw/train-images-idx3-ubyte.gz</span><br><span class="hljs-string">9913344it [00:02, 4759648.85it/s]  </span><br><span class="hljs-string">...</span><br><span class="hljs-string">5120it [00:00, 12492633.21it/s]Extracting ~/data/course_data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ~/data/course_data/MNIST/raw</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<h3 id="explain-cnn-principles">Explain CNN principles</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">conv</span>(<span class="hljs-params">image, filter_</span>):<br>    <span class="hljs-comment"># Convolution operation</span><br>    <span class="hljs-built_in">print</span>(image.shape)<br>    <span class="hljs-built_in">print</span>(filter_.shape)<br>    <span class="hljs-keyword">assert</span> image.shape[-<span class="hljs-number">1</span>] == filter_.shape[-<span class="hljs-number">1</span>]<br><br>    test_image = image<br>    height, width = filter_.shape[<span class="hljs-number">0</span>], filter_.shape[<span class="hljs-number">1</span>]<br><br>    filter_result = np.zeros((<br>        test_image.shape[<span class="hljs-number">0</span>]-height + <span class="hljs-number">1</span>,<br>        test_image.shape[<span class="hljs-number">1</span>]-width + <span class="hljs-number">1</span><br>    ))<br><br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(test_image.shape[<span class="hljs-number">0</span>]-height + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(test_image.shape[<span class="hljs-number">1</span>]-width + <span class="hljs-number">1</span>):<br>            sub_windows = test_image[h: h + height, w: w + width, :]<br>            op = np.<span class="hljs-built_in">sum</span>(np.multiply(sub_windows, filter_))<br><br>            filter_result[h][w] = op<br><br>    <span class="hljs-keyword">return</span> filter_result<br><br><span class="hljs-comment"># Part 2: Strides</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Try to modify stride in Conv Function</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># Part3: Pooling</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Create a pooling cell for conv</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># Part4: Volume</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Create 3-d volume filter</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># Part5: Fully Connected Layers</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Create Fully Connected Layer, to flatten</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># Part6: Cross-Entropy</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Create Cross-Entropy cell to get loss value</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># Part7: ResNet</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Why we need resNet, and its functions</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ResBlock</span>(nn.Module):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    A very basic ResNet unit</span><br><span class="hljs-string">    The unit passed:</span><br><span class="hljs-string">        batch normal</span><br><span class="hljs-string">        The output value retains the original input value, so that our result does not dissipate</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, n_channel</span>):<br>        <span class="hljs-built_in">super</span>(ResBlock, self).__init__()<br>        self.conv = nn.Conv2d(n_channel, n_channel, kernel_size = <span class="hljs-number">3</span>, padding=<span class="hljs-number">1</span>, bias = <span class="hljs-literal">False</span>)<br>        self.bath_norm = nn.BatchNorm2d(num_features = n_channel)<br><br>        torch.nn.init.constant_(self.bath_norw.weight, <span class="hljs-number">0.5</span>)<br>        torch.nn.init.zeros_(self.bath_norm.bias)<br>        torch.nn.init.kaiming_normal_(self.conv.weight, nonlinearity =<span class="hljs-string">&#x27;relu&#x27;</span>)<br>        <span class="hljs-comment"># sum(windows * filter) ==&gt; The larger the windows, the larger the added value, the smaller the windows, the smaller the value</span><br>        <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>    out = self.conv(x)<br>    out = self.conv(out)<br>    out = self.bath_norm(out)<br>    out = torch.relu(out)<br><br>    <span class="hljs-keyword">return</span> out + x<br>  <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;~/data/course_data/doo.jpeg&#x27;</span>)<br><br>    image_array = np.array(image)<br>    plt.imshow(image_array)<br><br>    <span class="hljs-comment"># Robert 算子</span><br>    rebert_1_kernel = np.array([<br>        [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>]<br>    ])<br>    robert_2_kernel = np.array([<br>        [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],<br>        [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br>    ])<br><br>    <span class="hljs-comment">#Sobel 算子</span><br>    sobel_x_kernel = np.array([<br>        [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],<br>        [-<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>],<br>        [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>    ])<br>    sobel_y_kernel = np.array([<br>        [-<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>],<br>        [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],<br>        [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]<br>    ])<br><br>    <span class="hljs-comment"># Laplacian 算子</span><br>    laplacian_kernel = np.array([<br>        [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],<br>        [<span class="hljs-number">1</span>, -<span class="hljs-number">4</span>, <span class="hljs-number">1</span>],<br>        [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br>    ])<br><br>    filters = [<br>        np.array([sobel_x_kernel] * <span class="hljs-number">3</span>),<br>        np.array([sobel_y_kernel] * <span class="hljs-number">3</span>),<br>        np.array([laplacian_kernel] * <span class="hljs-number">3</span>)<br>    ]<br><br>    <span class="hljs-keyword">for</span> i, f <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(filters):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;applying filter: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br><br>        plt.subplot(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, i * <span class="hljs-number">3</span> + <span class="hljs-number">1</span>)<br>        plt.imshow(image_array)<br><br>        filter_result = conv(image_array, f)<br>        plt.subplot(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, i * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>)<br>        plt.imshow(filter_result)<br><br>        plt.subplot(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, i * <span class="hljs-number">3</span> + <span class="hljs-number">3</span>)<br>        plt.imshow(filter_result, cmap = <span class="hljs-string">&#x27;gray&#x27;</span>)<br><br>plt.show()<br><span class="hljs-comment">#ResNet</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">applying filter: 0</span><br><span class="hljs-string">(1931, 1931, 3)</span><br><span class="hljs-string">(3, 3, 3)</span><br><span class="hljs-string">applying filter: 1</span><br><span class="hljs-string">(1931, 1931, 3)</span><br><span class="hljs-string">(3, 3, 3)</span><br><span class="hljs-string">applying filter: 2</span><br><span class="hljs-string">(1931, 1931, 3)</span><br><span class="hljs-string">(3, 3, 3)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMToutput.png?img"
alt="output" /></p>
<h2 id="identification-codes">Identification codes</h2>
<p>Train a model to classify and recognize the characters in the
verification code, and finally complete the verification code
recognition</p>
<p>The data set used contains a total of 36 characters from 0-9 and AZ.
There are 50 pictures for each character in the training set, and 10
pictures for each character in the verification set. The verification
code data set is composed of 4 character pictures taken out randomly.
become.</p>
<h3 id="related-knowledge-points">Related knowledge points</h3>
<ol type="1">
<li>Data Reading</li>
<li>Use torch to build, train, and verify models</li>
<li>Model prediction and image segmentation</li>
</ol>
<h3 id="analyze">analyze</h3>
<h4 id="question-1-establish-a-character-comparison-table">Question
1-Establish a character comparison table</h4>
<p>We can reverse each pair of keys and values by traversing the
dictionary and store them in a new dictionary. The sample code is as
follows: <figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">new</span><span class="hljs-type">_dict</span> = &#123;v: <span class="hljs-type">k for k</span>, v <span class="hljs-keyword">in</span> old_dict.items()&#125;<br></code></pre></td></tr></table></figure> #### Question 2-Define datasets and dataloader In
opencv-python, you can use
<code>image = cv2.medianBlur(image, kernel_size)</code> for median
filtering. #### Question 3-Define the network structure In torch, the
convolution and fully connected layers are defined as follows:
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">conv = nn.<span class="hljs-constructor">Conv2d(<span class="hljs-params">in_channels</span>, <span class="hljs-params">out_channels</span>, <span class="hljs-params">kernel_size</span>, <span class="hljs-params">stride</span>, <span class="hljs-params">padding</span>)</span><br>fc = nn.<span class="hljs-constructor">Linear(<span class="hljs-params">in_features</span>, <span class="hljs-params">out_features</span>, <span class="hljs-params">bias</span>)</span><br></code></pre></td></tr></table></figure> #### Question 4-Define the model training function The
model training process of the torch framework includes operations such
as clearing the gradient, forward propagation, calculating the loss,
calculating the gradient, and updating the weight, among which: 1. Clear
the gradient: the purpose is to eliminate the interference between step
and step, that is, use only one batch of data loss to calculate the
gradient and update the weight each time. Generally can be placed first
or last; 1. Forward propagation: use a batch of data to run the process
of forward propagation to generate model output results; 1. Calculate
the loss: use the defined loss function, model output results and label
to calculate the loss value of a single batch; 1. Calculate the
gradient: According to the loss value, calculate the gradient value
required in this optimization in the ownership of the model; 1. Update
weight: Use the calculated gradient value to update the value of all
weights. The sample code of a single process is as follows:
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">optimizer.zero_grad() <span class="hljs-comment"># Clear the gradient (can also be placed in the last line)</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">output = model(data) <span class="hljs-comment"># forward propagation</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">loss = loss_fn(output, target) <span class="hljs-comment"># Calculate loss</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">loss.backward() <span class="hljs-comment"># Calculate the gradient</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">optimizer.step() <span class="hljs-comment"># update weight</span></span><br></code></pre></td></tr></table></figure></p>
<h3 id="programming">Programming</h3>
<h4 id="import-the-library-to-be-used-in-this-project">Import the
library to be used in this project</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> Dataset, DataLoader<br><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> PIL<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>os.environ[<span class="hljs-string">&#x27;KMP_DUPLICATE_LIB_OK&#x27;</span>] = <span class="hljs-string">&#x27;True&#x27;</span><br></code></pre></td></tr></table></figure>
<h4 id="understanding-the-data-set">Understanding the data set</h4>
<p>Define the data path</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">train_data_dir = <span class="hljs-string">&#x27;~/data/course_data/train_data.bin&#x27;</span><br>val_data_dir = <span class="hljs-string">&#x27;~/data/course_data/val_data.bin&#x27;</span><br>verification_code_dir = <span class="hljs-string">&#x27;~/data/course_data/verification_code_data.bin&#x27;</span><br></code></pre></td></tr></table></figure>
<p>The data set used is stored in a binary file, and we need to define a
function to read the picture in the binary file.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_file</span>(<span class="hljs-params">file_name</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name, mode =<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        result = pickle.load(f)<br>    <span class="hljs-keyword">return</span> result<br></code></pre></td></tr></table></figure>
<p>See what the data set looks like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">train_data = load_file(train_data_dir)<br>img_test = <span class="hljs-built_in">list</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1800</span>, <span class="hljs-number">50</span>):<br>    img_test.append(train_data[i][<span class="hljs-number">1</span>])<br>plt.figure()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">37</span>):<br>    plt.subplot(<span class="hljs-number">6</span>, <span class="hljs-number">6</span>, i)<br>    plt.imshow(img_test[i-<span class="hljs-number">1</span>])<br>    plt.xticks([])<br>    plt.yticks([])<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMTimage-20210901131659902.png?img"
alt="image-20210901131659902" /></p>
<h4 id="view-single-big-picture">View single big picture</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># plt.subplot(6, 6, i)</span><br>plt.imshow(train_data[<span class="hljs-number">500</span>][<span class="hljs-number">1</span>])<br>plt.xticks([])<br>plt.yticks([])<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMTimage-20210901131741884.png?img"
alt="image-20210901131741884" /></p>
<p>It can be seen that there is a lot of noise in the character picture,
and the noise will have an adverse effect on the model prediction
result, so we can use a specific filter to eliminate the picture noise
during data preprocessing.</p>
<h4 id="question-1-establish-a-character-comparison-table-1">Question
1-Establish a character comparison table</h4>
<p>A simple observation shows that there are no duplicates in the key
and value in the character dictionary just defined. Therefore, the key
and value in the dictionary can be reversed so that we can use the value
to find the key (convert the model prediction result into a readable
character) Now you need to complete the following code to reverse the
keys and values in the dictionary (for example:
<code>dict=&#123;'A':10,'B':11&#125;</code> and get
<code>new_dict=&#123;10:'A ',11:'B'&#125;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">char_dict = &#123;<span class="hljs-string">&#x27;0&#x27;</span>:<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;1&#x27;</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;2&#x27;</span>:<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;3&#x27;</span>:<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;4&#x27;</span>:<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;5&#x27;</span>:<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;6&#x27;</span>:<span class="hljs-number">6</span>,<span class="hljs-string">&#x27;7&#x27;</span>:<span class="hljs-number">7</span>,<span class="hljs-string">&#x27;8&#x27;</span>:<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;9&#x27;</span>:<span class="hljs-number">9</span>,\<br>            <span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-number">10</span>,<span class="hljs-string">&#x27;B&#x27;</span>:<span class="hljs-number">11</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-number">12</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-number">13</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-number">14</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-number">16</span>,<span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-number">17</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-number">18</span>,<span class="hljs-string">&#x27;J&#x27;</span>:<span class="hljs-number">19</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-number">20</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-number">21</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-number">22</span>,\<br>            <span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-number">23</span>,<span class="hljs-string">&#x27;O&#x27;</span>:<span class="hljs-number">24</span>,<span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-number">25</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-number">26</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-number">27</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-number">28</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-number">29</span>,<span class="hljs-string">&#x27;U&#x27;</span>:<span class="hljs-number">30</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-number">31</span>,<span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-number">32</span>,<span class="hljs-string">&#x27;X&#x27;</span>:<span class="hljs-number">33</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-number">34</span>,<span class="hljs-string">&#x27;Z&#x27;</span>:<span class="hljs-number">35</span> &#125;<br><br>new_char_dict = &#123;v : k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> char_dict.items()&#125;<br></code></pre></td></tr></table></figure>
<h4 id="question-2-define-datasets-and-dataloader">Question 2-Define
datasets and dataloader</h4>
<p>We need to use <code>torch.utils.data.Dataset</code> as the parent
class to define our own datasets in order to standardize our own
datasets.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">iDataset</span>(<span class="hljs-title class_ inherited__">Dataset</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, file_name, transforms</span>):<br>        self.file_name = file_name <span class="hljs-comment"># file name</span><br>        self.image_label_arr = load_file(self.file_name) <span class="hljs-comment"># read binary file</span><br>        self.transforms = transforms <span class="hljs-comment"># Image converter</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, index</span>):<br>        label, img = self.image_label_arr[index]<br>        img = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY) <span class="hljs-comment"># Convert the picture to grayscale</span><br>        img = cv2.medianBlur(img, <span class="hljs-number">5</span>) <span class="hljs-comment"># Use median blur to remove image noise</span><br>        img = self.transforms(img) <span class="hljs-comment"># Transform the image</span><br>        <span class="hljs-keyword">return</span> img, char_dict[label[<span class="hljs-number">0</span>]]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.image_label_arr)<br></code></pre></td></tr></table></figure>
<p>Now we can define transform and dataloader.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">transform = transforms.Compose([transforms.ToPILImage(),<br>                                transforms.Resize([<span class="hljs-number">28</span>, <span class="hljs-number">28</span>]), <span class="hljs-comment"># Adjust the image size to 28*28</span><br>                                transforms.ToTensor(), <span class="hljs-comment"># Convert the picture to tensor</span><br>                                transforms.Normalize(mean = [<span class="hljs-number">0.5</span>], std = [<span class="hljs-number">0.5</span>])]) <span class="hljs-comment"># Perform normalization processing</span><br><br>train_datasets = iDataset(train_data_dir, transform)<br>train_loader = DataLoader(dataset=train_datasets, batch_size=<span class="hljs-number">32</span>, shuffle = <span class="hljs-literal">True</span>)<br><br>val_datasets = iDataset(val_data_dir, transform)<br>val_loader = DataLoader(dataset=val_datasets, batch_size = <span class="hljs-number">32</span>, shuffle = <span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<h4 id="question-3-define-the-network-structure">Question 3-Define the
network structure</h4>
<p>After the data is ready, we need to define a simple convolutional
neural network. The input of the neural network is
<code>[batchsize,chanel(1),w(28),h(28)]</code>, and the output is 36
categories. Our neural network will use 2 convolutional layers with 2
fully connected layers. The parameter settings of these four layers are
shown in the following table (the default parameters can be used
directly if they are not marked): 1. conv1: in_chanel=1, out_chanel=10,
kernel_size=5 1. conv2: in_chanel=10, out_chanel=20, kernel_size=3 1.
fc1: in_feature=2000, out_feature=500 4. fc2: in_feature=500,
out_feature=36</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConvNet</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        <span class="hljs-comment"># <span class="hljs-doctag">TODO:</span></span><br>        self.conv1 = nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>)<br>        self.conv2 = nn.Conv2d(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">3</span>)<br>        self.fc1 = nn.Linear(<span class="hljs-number">20</span> * <span class="hljs-number">10</span> * <span class="hljs-number">10</span>,  <span class="hljs-number">500</span>)<br>        self.fc2 = nn.Linear(<span class="hljs-number">500</span>, <span class="hljs-number">36</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        <span class="hljs-comment"># inputsize: [b, 1, 28, 28]</span><br>        in_size = x.size(<span class="hljs-number">0</span>) <span class="hljs-comment"># b</span><br>        out = self.conv1(x)<br>        out = F.relu(out)<br>        out = F.max_pool2d(out, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br>        out = self.conv2(out)<br>        out = F.relu(out)<br>        out = out.view(in_size, -<span class="hljs-number">1</span>)<br>        out = self.fc1(out)<br>        out = F.relu(out)<br>        out = self.fc2(out)<br>        out = F.log_softmax(out, dim = <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> out<br></code></pre></td></tr></table></figure>
<h4 id="question-4-define-the-model-training-function">Question 4-Define
the model training function</h4>
<p>Next, we need to complete the model training function to achieve the
following operations: 1. Clear the gradient 1. Forward propagation 1.
Calculate the gradient 1. Update weights</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">train</span>(<span class="hljs-params">model, train_loader, optimizer, epoch</span>):<br>    model.train()<br>    <span class="hljs-keyword">for</span> batch_idx, (data, target) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_loader):<br>        optimizer.zero_grad()<br>        output = model(data)<br>        loss = F.nll_loss(output, target)<br>        loss.backward()<br>        optimizer.step()<br>        <span class="hljs-keyword">if</span>(batch_idx + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Train Epoch: &#123;&#125; [&#123;&#125; / &#123;&#125; (&#123;:.0f&#125; %)]\tLoss: &#123;:.6f&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(epoch, batch_idx * <span class="hljs-built_in">len</span>(data), <span class="hljs-built_in">len</span>(train_loader.dataset), <span class="hljs-number">100.</span> * batch_idx / <span class="hljs-built_in">len</span>(train_loader), loss.item()))<br></code></pre></td></tr></table></figure>
<h5 id="define-model-test-function">Define model test function</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">model, test_loader</span>):<br>    model.<span class="hljs-built_in">eval</span>()<br>    test_loss = <span class="hljs-number">0</span><br>    correct = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> data, target <span class="hljs-keyword">in</span> test_loader:<br>            output = model(data)<br>            test_loss += F.nll_loss(output, target, reduction = <span class="hljs-string">&#x27;sum&#x27;</span>)<br>            pred = output.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>, keepdim = <span class="hljs-literal">True</span>)[<span class="hljs-number">1</span>]<br>            correct += pred.eq(target.view_as(pred)).<span class="hljs-built_in">sum</span>().item()<br>    test_loss /= <span class="hljs-built_in">len</span>(test_loader.dataset)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy: &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%) \n&#x27;</span>.<span class="hljs-built_in">format</span>(test_loss, correct, <span class="hljs-built_in">len</span>(test_loader.dataset), <span class="hljs-number">100.</span> * correct / <span class="hljs-built_in">len</span>(test_loader.dataset)))<br></code></pre></td></tr></table></figure>
<h5 id="define-model-and-optimizer">Define model and optimizer</h5>
<p>We define the model structure we just built as model and choose to
use the Adam optimizer.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">model = ConvNet()<br>optimizer = optim.Adam(model.parameters())<br></code></pre></td></tr></table></figure>
<h5 id="model-training-and-testing">Model training and testing</h5>
<p>We can first set the number of epochs to 3 and perform model training
to see how accurate the model is and whether it meets the requirements
of verification code recognition. If the model accuracy is not enough,
you can also try to adjust the number of epochs and retrain.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">EPOCHS = <span class="hljs-number">3</span><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, EPOCHS + <span class="hljs-number">1</span>):<br>    train(model, train_loader, optimizer, epoch)<br>    test(model, val_loader)<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Train Epoch: 1 [288 / 1800 (16 %)]	Loss: 3.340514</span><br><span class="hljs-string">Train Epoch: 1 [608 / 1800 (33 %)]	Loss: 2.872326</span><br><span class="hljs-string">Train Epoch: 1 [928 / 1800 (51 %)]	Loss: 1.977929</span><br><span class="hljs-string">Train Epoch: 1 [1248 / 1800 (68 %)]	Loss: 1.098688</span><br><span class="hljs-string">Train Epoch: 1 [1568 / 1800 (86 %)]	Loss: 0.535660</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.2888, Accuracy: 328/360 (91%) </span><br><span class="hljs-string"></span><br><span class="hljs-string">Train Epoch: 2 [288 / 1800 (16 %)]	Loss: 0.072813</span><br><span class="hljs-string">Train Epoch: 2 [608 / 1800 (33 %)]	Loss: 0.139866</span><br><span class="hljs-string">Train Epoch: 2 [928 / 1800 (51 %)]	Loss: 0.109487</span><br><span class="hljs-string">Train Epoch: 2 [1248 / 1800 (68 %)]	Loss: 0.058259</span><br><span class="hljs-string">Train Epoch: 2 [1568 / 1800 (86 %)]	Loss: 0.013144</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.0099, Accuracy: 360/360 (100%) </span><br><span class="hljs-string"></span><br><span class="hljs-string">Train Epoch: 3 [288 / 1800 (16 %)]	Loss: 0.010245</span><br><span class="hljs-string">Train Epoch: 3 [608 / 1800 (33 %)]	Loss: 0.004797</span><br><span class="hljs-string">Train Epoch: 3 [928 / 1800 (51 %)]	Loss: 0.002203</span><br><span class="hljs-string">Train Epoch: 3 [1248 / 1800 (68 %)]	Loss: 0.006250</span><br><span class="hljs-string">Train Epoch: 3 [1568 / 1800 (86 %)]	Loss: 0.005230</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.0028, Accuracy: 360/360 (100%)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<h5 id="define-model-test-function-1">Define model test function</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">model, test_loader</span>):<br>    model.<span class="hljs-built_in">eval</span>()<br>    test_loss = <span class="hljs-number">0</span><br>    correct = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> data, target <span class="hljs-keyword">in</span> test_loader:<br>            output = model(data)<br>            test_loss =+ F.nll_loss(output, target, reduction = <span class="hljs-string">&#x27;sum&#x27;</span>)<br>            pred = output.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>, keepdim = <span class="hljs-literal">True</span>)[<span class="hljs-number">1</span>]<br>            correct += pred.eq(target.view_as(pred)).<span class="hljs-built_in">sum</span>().item()<br>    test_loss /= <span class="hljs-built_in">len</span>(test_loader.dataset)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\nTest set: Average loss: &#123;:.4f&#125;, Accuracy : &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%) \n&#x27;</span>.<span class="hljs-built_in">format</span>(test_loss, correct, <span class="hljs-built_in">len</span>(test_loader.dataset), <span class="hljs-number">100.</span> * correct / <span class="hljs-built_in">len</span>(test_loader.dataset)))<br></code></pre></td></tr></table></figure>
<h5 id="define-model-and-optimizer-1">Define model and optimizer</h5>
<p>We define the model structure we just built as model and choose to
use the Adam optimizer.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">model = ConvNet()<br>optimizer = optim.Adam(model.parameters())<br></code></pre></td></tr></table></figure>
<h5 id="model-training-and-testing-1">Model training and testing</h5>
<p>We can first set the number of epochs to 3 and perform model training
to see how accurate the model is and whether it meets the requirements
of verification code recognition. If the model accuracy is not enough,
you can also try to adjust the number of epochs and retrain.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">EPOCHS = <span class="hljs-number">3</span><br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, EPOCHS + <span class="hljs-number">1</span>):<br>    train(model, train_loader, optimizer, epoch)<br>    test(model, val_loader)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Train Epoch: 1 [288 / 1800 (16 %)]	Loss: 3.508450</span><br><span class="hljs-string">Train Epoch: 1 [608 / 1800 (33 %)]	Loss: 3.288610</span><br><span class="hljs-string">Train Epoch: 1 [928 / 1800 (51 %)]	Loss: 2.584805</span><br><span class="hljs-string">Train Epoch: 1 [1248 / 1800 (68 %)]	Loss: 1.180833</span><br><span class="hljs-string">Train Epoch: 1 [1568 / 1800 (86 %)]	Loss: 0.564084</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.0088, Accuracy : 316/360 (88%) </span><br><span class="hljs-string"></span><br><span class="hljs-string">Train Epoch: 2 [288 / 1800 (16 %)]	Loss: 0.173177</span><br><span class="hljs-string">Train Epoch: 2 [608 / 1800 (33 %)]	Loss: 0.043262</span><br><span class="hljs-string">Train Epoch: 2 [928 / 1800 (51 %)]	Loss: 0.054462</span><br><span class="hljs-string">Train Epoch: 2 [1248 / 1800 (68 %)]	Loss: 0.052596</span><br><span class="hljs-string">Train Epoch: 2 [1568 / 1800 (86 %)]	Loss: 0.013714</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.0006, Accuracy : 360/360 (100%) </span><br><span class="hljs-string"></span><br><span class="hljs-string">Train Epoch: 3 [288 / 1800 (16 %)]	Loss: 0.004590</span><br><span class="hljs-string">Train Epoch: 3 [608 / 1800 (33 %)]	Loss: 0.007654</span><br><span class="hljs-string">Train Epoch: 3 [928 / 1800 (51 %)]	Loss: 0.004135</span><br><span class="hljs-string">Train Epoch: 3 [1248 / 1800 (68 %)]	Loss: 0.003140</span><br><span class="hljs-string">Train Epoch: 3 [1568 / 1800 (86 %)]	Loss: 0.003019</span><br><span class="hljs-string"></span><br><span class="hljs-string">Test set: Average loss: 0.0001, Accuracy : 360/360 (100%) </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>The model has been trained! Does the test set accuracy of the last
epoch exceed 99%?</p>
<h5 id="identification-codes-1">Identification codes</h5>
<p>After successfully implementing the digital recognition, we can start
the verification code recognition! First, import the verification code
data set:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">verification_code_data = load_file(verification_code_dir)<br></code></pre></td></tr></table></figure>
<p>Let's choose a picture at random (Figure 6) to see what the
verification code looks like.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">image = verification_code_data[<span class="hljs-number">6</span>]<br>IMG = Image.fromarray(cv2.cvtColor(image.copy(), cv2.COLOR_BGR2RGB))<br>plt.imshow(IMG)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMTimage-20210901132522728.png?img"
alt="image-20210901132522728" /></p>
<p>Let's take a look at what effect the median filter can have on the
captcha image.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">img = cv2.medianBlur(image.copy(), <span class="hljs-number">5</span>)<br>plt.imshow(img)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMTimage-20210901132551457.png?img"
alt="image-20210901132551457" /></p>
<p>Finally, let us look at the actual results of verification code
recognition:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">IMAGES = <span class="hljs-built_in">list</span>()<br>NUMS = <span class="hljs-built_in">list</span>()<br><br><span class="hljs-keyword">for</span> img <span class="hljs-keyword">in</span> verification_code_data:<br>    IMAGES.append(img)<br>    img = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)<br>    image_1 = img[:, :<span class="hljs-number">80</span>]<br>    image_2 = img[:, <span class="hljs-number">80</span>:<span class="hljs-number">160</span>]<br>    image_3 = img[:, <span class="hljs-number">160</span>:<span class="hljs-number">240</span>]<br>    image_4 = img[:, <span class="hljs-number">240</span>:<span class="hljs-number">320</span>]<br>    img_list = [image_1, image_2, image_3, image_4]<br><br>    nums = []<br>    <span class="hljs-keyword">for</span> one_img <span class="hljs-keyword">in</span> img_list:<br>        one_img = transform(one_img)<br>        one_img = one_img.unsqueeze(<span class="hljs-number">0</span>)<br>        output = model(one_img)<br>        nums.append(new_char_dict[torch.argmax(output).item()])<br>    NUMS.append(<span class="hljs-string">&#x27;Verification_code: &#x27;</span>+ <span class="hljs-string">&#x27;&#x27;</span>.join(nums))<br><br>plt.figure(figsize = (<span class="hljs-number">20</span>, <span class="hljs-number">20</span>))<br>plt.subplots_adjust(wspace = <span class="hljs-number">0.2</span>, hspace=<span class="hljs-number">0.5</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>):<br>    plt.subplot(<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, i)<br>    plt.title(NUMS[i-<span class="hljs-number">1</span>], fontsize = <span class="hljs-number">25</span>, color = <span class="hljs-string">&#x27;red&#x27;</span>)<br>    plt.imshow(IMAGES[i - <span class="hljs-number">1</span>])<br>    plt.xticks([])<br>    plt.yticks([])<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img src="https://qiniu.hivan.me/MAMTimage-20210901132631369.png?img"
alt="image-20210901132631369" /></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>CNN</p><p><a href="https://hivan.me/example_09/">https://hivan.me/example_09/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hivan Du</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-09-02</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-02</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=6479444288ae9600196fa98e&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="https://afdian.net/item/72907364008511ee904852540025c377" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://qiniu.hivan.me/picGo/20230601221633.jpeg" alt="支付宝"></span></a><a class="button donate" href="https://www.buymeacoffee.com/hivandu" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="https://patreon.com/user?u=89473430" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="paypal" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="doo@hivan.me"><input type="hidden" name="currency_code" value="USD"></form><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://qiniu.hivan.me/IMG_4603.JPG" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Apple_M1_AI_environment_construction/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Apple M1的AI环境搭建</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/example_12/"><span class="level-item">Business Intelligence(BI)</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://hivan.me/example_09/';
            this.page.identifier = 'example_09/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'hivan' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/bdff168cf8a71c11d2712a1679a00c54?s=128" alt="茶桁"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">茶桁</p><p class="is-size-6 is-block">AI游民</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shang Hai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">159</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">19</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hivandu" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hivan"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/hivan"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com/hivan"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4NzE4MDQzMg==&amp;action=getalbum&amp;album_id=2932504849574543360&amp;scene=173&amp;from_msgid=2648747980&amp;from_itemidx=1&amp;count=3&amp;nolastread=1&amp;token=1758883909&amp;lang=zh_CN#wechat_redirect"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.zhihu.com/column/c_1424326166602178560" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">塌缩的奇点</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhihu.com/column/hivandu" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">茶桁-知乎</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/"><span class="level-start"><span class="level-item">AI秘籍</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="level-start"><span class="level-item">从零开始接触人工智能大模型</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-15T05:35:35.000Z">2023-08-15</time></p><p class="title"><a href="/Get-the-exception/">20. 异常处理</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-15T03:48:45.000Z">2023-08-15</time></p><p class="title"><a href="/Third-party-libraries-and-virtual-environments/">19. 第三方库的管理和虚拟环境</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-14T09:00:32.000Z">2023-08-14</time></p><p class="title"><a href="/Modules-and-packages/">18. Python中的模块与包</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-13T05:21:10.000Z">2023-08-13</time></p><p class="title"><a href="/regular-expression/">17. 正则表达式</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-12T16:59:35.000Z">2023-08-13</time></p><p class="title"><a href="/Exercise-perpetual-calendar/">16. 练习：万年历</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a><p class="is-size-7"><span>&copy; 2023 Hivan Du</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>