<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分类: AI 秘籍 - 茶桁.MAMT</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶桁.MAMT"><meta name="msapplication-TileImage" content="https://qiniu.hivan.me/picGo/20230601174411.png?imgNote"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶桁.MAMT"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="我是茶桁，这里是我用于写字，码代码以及记录的地方。"><meta property="og:type" content="blog"><meta property="og:title" content="茶桁.MAMT"><meta property="og:url" content="https://hivan.me/"><meta property="og:site_name" content="茶桁.MAMT"><meta property="og:description" content="我是茶桁，这里是我用于写字，码代码以及记录的地方。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hivan.me/img/og_image.png"><meta property="article:author" content="Hivan Du"><meta property="article:tag" content="AI,人工智能,代码,大语言模型"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hivan.me/img/og_image.png"><meta property="twitter:creator" content="@hivan"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hivan.me"},"headline":"茶桁.MAMT","image":["https://hivan.me/img/og_image.png"],"author":{"@type":"Person","name":"Hivan Du"},"publisher":{"@type":"Organization","name":"茶桁.MAMT","logo":{"@type":"ImageObject","url":"https://hivan.me/img/logo.svg"}},"description":"我是茶桁，这里是我用于写字，码代码以及记录的地方。"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?f91b64734fdc7bfb999e48f9248d44dd";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-ZFB6CVWZFJ" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-ZFB6CVWZFJ');</script><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="茶桁.MAMT" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">AI 秘籍</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-10-06T23:30:00.000Z" title="10/7/2023, 7:30:00 AM">2023-10-07</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/06.%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A82%20-%20%E7%90%86%E8%A7%A3%E7%89%B9%E5%BE%81%E5%92%8C%E5%90%91%E9%87%8F/">06. 机器学习入门 2 - 理解特征和向量</a></p><div class="content"><p>[TOC]</p>
<p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20231007182127.png"
alt="茶桁的 AI 秘籍 06" /></p>
<p>Hi, 你好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/06.%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A82%20-%20%E7%90%86%E8%A7%A3%E7%89%B9%E5%BE%81%E5%92%8C%E5%90%91%E9%87%8F/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-10-02T23:30:00.000Z" title="10/3/2023, 7:30:00 AM">2023-10-03</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/05.%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8%20-%20%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">05. 机器学习入门 - 动态规划</a></p><div class="content"><p>[TOC]</p>
<p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20231002232516.png"
alt="茶桁的 AI 秘籍 05" /></p>
<p>Hi, 你好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/05.%20%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8%20-%20%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-29T11:30:00.000Z" title="9/29/2023, 7:30:00 PM">2023-09-29</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/04.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA3/">04. 人工智能核心基础 - 导论（3）</a></p><div class="content"><p>[TOC]</p>
<p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230929071346.png"
alt="茶桁的 AI 秘籍 02" /></p>
<p>Hi，你好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/04.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA3/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-28T23:30:00.000Z" title="9/29/2023, 7:30:00 AM">2023-09-29</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/03.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA2/">03. 人工智能核心基础 - 导论（2）</a></p><div class="content"><p>[TOC]</p>
<p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230929052420.png"
alt="茶桁的 AI 秘籍 02" /></p>
<p>Hi，你好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/03.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA2/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-27T05:04:36.000Z" title="9/27/2023, 1:04:36 PM">2023-09-27</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ai-core-competence-outline/">AI 核心能力基础 - 规划和概要</a></p><div class="content"><p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230925232147.png"
alt="茶桁的 AI 秘籍 核心能力基础 - 01" /></p>
<p>Hi，你好。又见面咯，我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/ai-core-competence-outline/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-26T23:30:00.000Z" title="9/27/2023, 7:30:00 AM">2023-09-27</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/">核心能力基础</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/02.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA1/">02. 人工智能核心基础 - 导论（1）</a></p><div class="content"><p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230927124147.png"
alt="茶桁的 AI 秘籍 02" /></p>
<p>Hi，你好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/02.%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%20-%20%E5%AF%BC%E8%AE%BA1/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-09-04T09:20:55.000Z" title="9/4/2023, 5:20:55 PM">2023-09-04</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/Math/">Math</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/calculus-8/">13. 微积分 - 牛顿 - 莱布尼兹公式、泰勒展开</a></p><div class="content"><p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230904190800.png"
alt="茶桁的 AI 秘籍 Math - 13" /></p>
<p>[TOC]</p></div><a class="article-more button is-small is-size-7" href="/calculus-8/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-08-24T07:43:45.000Z" title="8/24/2023, 3:43:45 PM">2023-08-24</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/Math/">Math</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Math-Introduction/">茶桁的 AI 秘籍 - 人工智能数学基础篇 导言</a></p><div class="content"><p><img
src="https://raw.githubusercontent.com/hivandu/notes/main/img/20230824152200.png"
alt="数学基础篇 Cover" /></p>
<p>Hi, 大家好。又见面了，我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/Math-Introduction/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-08-22T05:21:59.000Z" title="8/22/2023, 1:21:59 PM">2023-08-22</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/Python/">Python</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/AI-Python-Pandas/">27. Pandas</a></p><div class="content"><p><img
src="https://cdn.jsdelivr.net/gh/hivandu/notes/img/202311251944931.png" /></p>
<p>先跟小伙伴们打个招呼，今天这节课呢，就是我们 Python
基础课程的最后一节课了。</p>
<p>在本节课之前，我们讲解了 Python
的基础，介绍了两个第三方库。而今天一样会介绍一个第三方库：Pandas。</p>
<p>虽然是最后一节课了，但是本节课的任务却是一点也不轻松。相比较而言，如果你以后从事的是数据治理和分析工作，那么本节课的内容可能会是你在今后工作中用到的最多的内容。我们需要学习行列索引的操作，数据的处理，数据的合并，多层索引，时间序列，数据的分组聚合（重点）。最后，我们会有一个案例的展示。</p>
<p>听着是不是很兴奋？那我们就开始吧。</p>
<p>在开始讲解 pandas 之前，我们讲解一些关于数据的小知识。</p>
<p>我们大部分人应该都用过 Excel
表格，而我们从数据库中拿到的数据，也基本上和 Excel
上的数据差不多，都是由行列组成的。可以直接导出为<code>csv</code>文件。</p>
<p>也就是说，我们大部分时候要处理的数据，基本上都一组二维数据。例如，我们今天最后案例要用到的一个电影数据(部分)，如图：</p>
<p><img
src="https://cdn.jsdelivr.net/gh/hivandu/notes/img/20231226133842.png"
alt="20231226133842" /></p>
<p>这里面，我们就将数据通过行列来展示和定位。</p>
<p>了解了这一点之后，我们来开始学习 pandas。</p>
<h2 id="pandas-简介">Pandas 简介</h2>
<p><img
src="https://cdn.jsdelivr.net/gh/hivandu/notes/img/202311251944932.png" /></p>
<p>在之前的介绍中，我们发现很多的操作似乎都似曾相识，在 NumPy
中我们好像都接触过。</p>
<p>有这种感觉很正常，Pandas 本身就是基于 NumPy
的一种工具，该⼯具是为了解决数据分析任务⽽创建的。Pandas
纳⼊了⼤量库和⼀些标准的数据模型，提供了⾼效地操作⼤型数据集所需的⼯具。pandas
提供了⼤量能使我们快速 便捷地处理数据的函数和⽅法。</p>
<h2 id="series-对象">Series 对象</h2>
<p>Pandas
基于两种数据类型：<code>series</code>与<code>dataframe</code>。</p>
<p><code>Series</code>是 Pandas 中最基本的对象，Series
类似⼀种⼀维数组。事实上，Series 基本上就是基于 NumPy 的数组对象来的。和
NumPy 的数组不同，Series 能为数据⾃定义标签，也就是索引（index），然后
通过索引来访问数组中的数据。</p>
<p><code>Dataframe</code>是⼀个⼆维的表结构。Pandas 的 dataframe
可以存储许多种不同的数据类型，并且每⼀个坐标轴都有⾃⼰的标签。你可以把它想象成⼀个
series 的字典项。</p>
<p>在开始基于代码进行学习之前，我们需要应用一些必要项。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> pandas <span class="hljs-keyword">import</span> Series<br><span class="hljs-keyword">from</span> pandas <span class="hljs-keyword">import</span> DataFrame <span class="hljs-keyword">as</span> df<br></code></pre></td></tr></table></figure>
<p>现在我们来看看 Series 的一些基本操作：</p>
<p><strong>创建 Series 对象并省略索引</strong></p>
<p><code>index</code> 参数是可省略的，你可以选择不输⼊这个参数。如果不带
<code>index</code> 参数，Pandas 会⾃动⽤默认 <code>index</code>
进⾏索引，类似数组，索引值是 <code>[0, ..., len(data) - 1]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">sel = Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])<br><span class="hljs-built_in">print</span>(sel)<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">1</span><br><span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">2</span>    <span class="hljs-number">3</span><br><span class="hljs-number">3</span>    <span class="hljs-number">4</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>我们之前在 NumPy 中学习了 dtype,
以及它的相关数据类型。所以现在的<code>dtype: int64</code>我们应该能理解是什么意思了。</p>
<p>我们看打印的结果，在<code>1,2,3,4</code>前面，是 Series
默认生成的索引值。</p>
<p><strong>通常我们会⾃⼰创建索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">sel = Series(data=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>], index= <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>))<br><span class="hljs-built_in">print</span>(sel)<br><br>---<br>a    <span class="hljs-number">1</span><br>b    <span class="hljs-number">2</span><br>c    <span class="hljs-number">3</span><br>d    <span class="hljs-number">4</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>这个时候，我们可以对这个 Series
对象操作分别<strong>获取内容和索引</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;values: <span class="hljs-subst">&#123;sel.values&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(sel.index)<br><br>---<br>values: [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>]<br>Index([<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>又或者，我们可以直接<strong>获取健值对</strong>（索引和值对）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(sel.iteritems()))<br><br>---<br>[(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">1</span>), (<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-number">2</span>), (<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">3</span>), (<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">4</span>)]<br></code></pre></td></tr></table></figure>
<p>那么这种健值对的形式让你想到了什么？是字典对吧？</p>
<p>我们完全可以<strong>将字典转为 Series</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">dict</span>=&#123;<span class="hljs-string">&quot;red&quot;</span>:<span class="hljs-number">100</span>,<span class="hljs-string">&quot;black&quot;</span>:<span class="hljs-number">400</span>,<span class="hljs-string">&quot;green&quot;</span>:<span class="hljs-number">300</span>,<span class="hljs-string">&quot;pink&quot;</span>:<span class="hljs-number">900</span>&#125;<br>se3=Series(<span class="hljs-built_in">dict</span>) <br><span class="hljs-built_in">print</span>(se3)<br><br>---<br>red      <span class="hljs-number">100</span><br>black    <span class="hljs-number">400</span><br>green    <span class="hljs-number">300</span><br>pink     <span class="hljs-number">900</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>Series 数据获取</p>
<p>在 Series 拿到数据转为 Series
对象之后，诺大的数据中，我们如何定位并获取到我们想要的内容呢？</p>
<p>Series
在获取数据上，支持位置、标签、获取不连续数据，使用切片等方式。我们一个个的看一下：</p>
<p>Series 对象同时⽀持<strong>位置和标签</strong>两种⽅式获取数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;索引下标&#x27;</span>,sel[<span class="hljs-string">&#x27;c&#x27;</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;位置下标&#x27;</span>,sel[<span class="hljs-number">2</span>])<br><br>---<br>索引下标 <span class="hljs-number">3</span><br>位置下标 <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>获取不连续的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;位置切⽚\n&#x27;</span>,sel[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>])<span class="hljs-comment"># 左包含右不包含</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n 索引切⽚\n&#x27;</span>,sel[<span class="hljs-string">&#x27;b&#x27;</span>:<span class="hljs-string">&#x27;d&#x27;</span>])<span class="hljs-comment"># 左右都包含</span><br><br>---<br>位置切⽚<br>b    <span class="hljs-number">2</span><br>c    <span class="hljs-number">3</span><br>dtype: int64<br><br>索引切⽚<br>b    <span class="hljs-number">2</span><br>c    <span class="hljs-number">3</span><br>d    <span class="hljs-number">4</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>我们看到结果，发现两组数据数量不对，但是其实我们获取的位置都是一样的。这是因为，位置切片的方式会是「左包含右不包含」的，而索引切片则是「左右都包含」。</p>
<p>重新赋值索引的值</p>
<p>除了获取数据之外，我们还可以对数据进行重新索引。其实在之前我们将索引的时候，第二种自己赋值的方式实际上就是一个重新赋值了，将自己定义的值替换了默认值。这里让我们再来看一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">sel.index = <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;dcba&#x27;</span>)<br><span class="hljs-built_in">print</span>(sel)<br><br>---<br>d    <span class="hljs-number">1</span><br>c    <span class="hljs-number">2</span><br>b    <span class="hljs-number">3</span><br>a    <span class="hljs-number">4</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>还有一种重新索引的方法<code>reindex</code>， 这会返回一个新的
Series。调用<code>reindex</code>将会重新排序，缺失值这会用<code>NaN</code>填补。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(sel.reindex([<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;e&#x27;</span>]))<br><br>---<br>b    <span class="hljs-number">3.0</span><br>a    <span class="hljs-number">4.0</span><br>c    <span class="hljs-number">2.0</span><br>d    <span class="hljs-number">1.0</span><br>e    NaN<br>dtype: float64<br></code></pre></td></tr></table></figure>
<p>在重新索引的时候，我们特意多增加了一个索引。在最后一位没有数据的情况下，缺失值被<code>NaN</code>填补上了。</p>
<p>丢弃指定轴上的项</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">sel = pd.Series(<span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>, <span class="hljs-number">15</span>))<br><span class="hljs-built_in">print</span>(sel)<br><span class="hljs-built_in">print</span>(sel.drop([<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]))<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">10</span><br><span class="hljs-number">1</span>    <span class="hljs-number">11</span><br><span class="hljs-number">2</span>    <span class="hljs-number">12</span><br><span class="hljs-number">3</span>    <span class="hljs-number">13</span><br><span class="hljs-number">4</span>    <span class="hljs-number">14</span><br>dtype: int64<br><span class="hljs-number">0</span>    <span class="hljs-number">10</span><br><span class="hljs-number">1</span>    <span class="hljs-number">11</span><br><span class="hljs-number">4</span>    <span class="hljs-number">14</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>使用<code>drop</code>，会丢弃掉轴上的项，例子中，我们将 2，3
进行了丢弃。</p>
<p><strong>Series 进⾏算术运算操作</strong></p>
<p>对 Series 的算术运算都是基于 index
进⾏的。我们可以⽤加减乘除（<code>+ - * /</code>）这样的运算符对两个
Series 进⾏运算，Pandas 将会根据索引
index，对响应的数据进⾏计算，结果将会以浮点数的形式存储，以避免丢失精度。如果
Pandas 在两个 Series ⾥找不到相同的 index，对应的位置就返回⼀个空值
<code>NaN</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Series 算数运算</span><br>series1 = pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-string">&#x27;London&#x27;</span>,<span class="hljs-string">&#x27;HongKong&#x27;</span>,<span class="hljs-string">&#x27;Humbai&#x27;</span>,<span class="hljs-string">&#x27;lagos&#x27;</span>])<br>series2 = pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>],[<span class="hljs-string">&#x27;London&#x27;</span>,<span class="hljs-string">&#x27;Accra&#x27;</span>,<span class="hljs-string">&#x27;lagos&#x27;</span>,<span class="hljs-string">&#x27;Delhi&#x27;</span>])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;series1-series2:&#x27;</span>)<br><span class="hljs-built_in">print</span>(series1-series2) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\nseries1+series2:&#x27;</span>)<br><span class="hljs-built_in">print</span>(series1+series2) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\nseries1*series2:&#x27;</span>)<br><span class="hljs-built_in">print</span>(series1*series2)<br><br>---<br>series1-series2:<br>Accra       NaN<br>Delhi       NaN<br>HongKong    NaN<br>Humbai      NaN<br>London      <span class="hljs-number">0.0</span><br>lagos      -<span class="hljs-number">2.0</span><br>dtype: float64<br><br>series1+series2:<br>Accra        NaN<br>Delhi        NaN<br>HongKong     NaN<br>Humbai       NaN<br>London       <span class="hljs-number">2.0</span><br>lagos       <span class="hljs-number">10.0</span><br>dtype: float64<br><br>series1*series2:<br>Accra        NaN<br>Delhi        NaN<br>HongKong     NaN<br>Humbai       NaN<br>London       <span class="hljs-number">1.0</span><br>lagos       <span class="hljs-number">24.0</span><br>dtype: float64<br></code></pre></td></tr></table></figure>
<p>除此之外，Series 的算术运算操作同样也<strong>支持 NumPy
的数组运算</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">sel = Series(data = [<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>], index = <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>))<br><span class="hljs-built_in">print</span>(sel[sel&gt;<span class="hljs-number">3</span>]) <span class="hljs-comment"># 布尔数组过滤</span><br><span class="hljs-built_in">print</span>(sel*<span class="hljs-number">2</span>) <span class="hljs-comment"># 标量乘法</span><br><span class="hljs-built_in">print</span>(np.square(sel)) <span class="hljs-comment"># 可以直接加⼊到 numpy 的数学函数</span><br><br>---<br>b    <span class="hljs-number">6</span><br>d    <span class="hljs-number">5</span><br>dtype: int64<br>a     <span class="hljs-number">2</span><br>b    <span class="hljs-number">12</span><br>c     <span class="hljs-number">6</span><br>d    <span class="hljs-number">10</span><br>dtype: int64<br>a     <span class="hljs-number">1</span><br>b    <span class="hljs-number">36</span><br>c     <span class="hljs-number">9</span><br>d    <span class="hljs-number">25</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<h2 id="dataframe">DataFrame</h2>
<p>DataFrame（数据表）是⼀种 2
维数据结构，数据以表格的形式存储，分成若⼲⾏和列。通过
DataFrame，你能很⽅便地处理数据。常见的操作⽐如选取、替换⾏或列的数据，还能重组数据表、修改索引、多重筛选等。我们基本上可以把
DataFrame 理解成⼀组采⽤同样索引的 Series 的集合。调⽤
<code>DataFrame()</code>可以将多种格式的数据转换为 DataFrame
对象，它的的三个参数<code>data</code>、<code>index</code>和<code>columns</code>
分别为数据、⾏索引和列索引。</p>
<h3 id="dataframe-的创建">DataFrame 的创建</h3>
<p><strong>我们可以使用二维数组</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1 = df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,(<span class="hljs-number">4</span>,<span class="hljs-number">4</span>)),index=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],columns=[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>]) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>   a  b  c  d<br><span class="hljs-number">1</span>  <span class="hljs-number">9</span>  <span class="hljs-number">6</span>  <span class="hljs-number">3</span>  <span class="hljs-number">0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">7</span>  <span class="hljs-number">0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">1</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span><br><span class="hljs-number">4</span>  <span class="hljs-number">6</span>  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>也可以<strong>使用字典创建</strong></p>
<p>行索引由 index 决定，列索引由字典的键决定</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">dict</span>=&#123;<span class="hljs-string">&#x27;Province&#x27;</span>: [<span class="hljs-string">&#x27;Guangdong&#x27;</span>, <span class="hljs-string">&#x27;Beijing&#x27;</span>, <span class="hljs-string">&#x27;Qinghai&#x27;</span>,<span class="hljs-string">&#x27;Fujian&#x27;</span>],<span class="hljs-string">&#x27;pop&#x27;</span>: [<span class="hljs-number">1.3</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1.1</span>, <span class="hljs-number">0.7</span>], <span class="hljs-string">&#x27;year&#x27;</span>: [<span class="hljs-number">2022</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">2022</span>]&#125;<br>df2= df(<span class="hljs-built_in">dict</span>,index=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]) <br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>    Province  pop  year<br><span class="hljs-number">1</span>  Guangdong  <span class="hljs-number">1.3</span>  <span class="hljs-number">2022</span><br><span class="hljs-number">2</span>    Beijing  <span class="hljs-number">2.5</span>  <span class="hljs-number">2022</span><br><span class="hljs-number">3</span>    Qinghai  <span class="hljs-number">1.1</span>  <span class="hljs-number">2022</span><br><span class="hljs-number">4</span>     Fujian  <span class="hljs-number">0.7</span>  <span class="hljs-number">2022</span><br></code></pre></td></tr></table></figure>
<p><strong>使用<code>from_dict</code></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">dict2=&#123;<span class="hljs-string">&quot;a&quot;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],<span class="hljs-string">&quot;b&quot;</span>:[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]&#125;<br>df6=df.from_dict(dict2) <br><span class="hljs-built_in">print</span>(df6)<br><br>---<br>   a  b<br><span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">4</span><br><span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span><br><span class="hljs-number">2</span>  <span class="hljs-number">3</span>  <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure>
<p>索引相同的情况下，相同索引的值会相对应，缺少的值会添加<code>NaN</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123;<br> <span class="hljs-string">&#x27;Name&#x27;</span>:pd.Series([<span class="hljs-string">&#x27;zs&#x27;</span>,<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-string">&#x27;we&#x27;</span>],index=[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>]),<br> <span class="hljs-string">&#x27;Age&#x27;</span>:pd.Series([<span class="hljs-string">&#x27;10&#x27;</span>,<span class="hljs-string">&#x27;20&#x27;</span>,<span class="hljs-string">&#x27;30&#x27;</span>,<span class="hljs-string">&#x27;40&#x27;</span>],index=[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>]),<br> <span class="hljs-string">&#x27;country&#x27;</span>:pd.Series([<span class="hljs-string">&#x27;中国&#x27;</span>,<span class="hljs-string">&#x27;⽇本&#x27;</span>,<span class="hljs-string">&#x27;韩国&#x27;</span>],index=[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>])<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><br>---<br>  Name Age country<br>a   zs  <span class="hljs-number">10</span>      中国<br>b   ls  <span class="hljs-number">20</span>      韩国<br>c   we  <span class="hljs-number">30</span>      ⽇本<br>d  NaN  <span class="hljs-number">40</span>     NaN<br></code></pre></td></tr></table></figure>
<p>看了那么多 DataFrame
的转换方式，那我们如何将数据转为字典呢？DataFrame
有一个内置方法<code>to_dict()</code>能将 DataFrame 对象转换为字典：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">dict</span> = df.to_dict()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dict</span>)<br><br>---<br>&#123;<span class="hljs-string">&#x27;Name&#x27;</span>: &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-string">&#x27;ls&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-string">&#x27;we&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>: nan&#125;, <span class="hljs-string">&#x27;Age&#x27;</span>: &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-string">&#x27;10&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-string">&#x27;20&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-string">&#x27;30&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>: <span class="hljs-string">&#x27;40&#x27;</span>&#125;, <span class="hljs-string">&#x27;country&#x27;</span>: &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-string">&#x27;中国&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-string">&#x27;韩国&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-string">&#x27;⽇本&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>: nan&#125;&#125;<br></code></pre></td></tr></table></figure>
<h3 id="dataframe-对象常属性">DataFrame 对象常⽤属性</h3>
<p>让我们先来生成一组数据备用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df_dict = &#123;<br><span class="hljs-string">&#x27;name&#x27;</span>:[<span class="hljs-string">&#x27;James&#x27;</span>,<span class="hljs-string">&#x27;Curry&#x27;</span>,<span class="hljs-string">&#x27;Iversion&#x27;</span>],<br><span class="hljs-string">&#x27;age&#x27;</span>:[<span class="hljs-string">&#x27;18&#x27;</span>,<span class="hljs-string">&#x27;20&#x27;</span>,<span class="hljs-string">&#x27;19&#x27;</span>],<br> <span class="hljs-string">&#x27;national&#x27;</span>:[<span class="hljs-string">&#x27;us&#x27;</span>,<span class="hljs-string">&#x27;China&#x27;</span>,<span class="hljs-string">&#x27;us&#x27;</span>] &#125;<br>df = pd.DataFrame(data=df_dict,index=[<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>])<br><span class="hljs-built_in">print</span>(df)<br><br>---<br>       name age national<br><span class="hljs-number">0</span>     James  <span class="hljs-number">18</span>       us<br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span>    China<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br></code></pre></td></tr></table></figure>
<p>获取⾏数和列数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.shape)<br><br>---<br>(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>
<p>获取⾏索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.index.tolist())<br><br>---<br>[<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>获取列索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.columns.tolist())<br><br>---<br>[<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;national&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>获取数据的类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.dtypes)<br><br>---<br>name        <span class="hljs-built_in">object</span><br>age         <span class="hljs-built_in">object</span><br>national    <span class="hljs-built_in">object</span><br>dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>获取数据的维度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.ndim)<br><br>---<br><span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>values 属性也会以<strong>⼆维 ndarray 的形式</strong>返回 DataFrame
的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.values)<br><br>---<br>[[<span class="hljs-string">&#x27;James&#x27;</span> <span class="hljs-string">&#x27;18&#x27;</span> <span class="hljs-string">&#x27;us&#x27;</span>]<br> [<span class="hljs-string">&#x27;Curry&#x27;</span> <span class="hljs-string">&#x27;20&#x27;</span> <span class="hljs-string">&#x27;China&#x27;</span>]<br> [<span class="hljs-string">&#x27;Iversion&#x27;</span> <span class="hljs-string">&#x27;19&#x27;</span> <span class="hljs-string">&#x27;us&#x27;</span>]]<br></code></pre></td></tr></table></figure>
<p>展示 df 的概览</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.info())<br><br>---<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pandas.core.frame.DataFrame&#x27;</span>&gt;<br>Index: <span class="hljs-number">3</span> entries, <span class="hljs-number">0</span> to <span class="hljs-number">2</span><br>Data columns (total <span class="hljs-number">3</span> columns):<br> <span class="hljs-comment">#   Column    Non-Null Count  Dtype </span><br>---  ------    --------------  ----- <br> <span class="hljs-number">0</span>   name      <span class="hljs-number">3</span> non-null      <span class="hljs-built_in">object</span><br> <span class="hljs-number">1</span>   age       <span class="hljs-number">3</span> non-null      <span class="hljs-built_in">object</span><br> <span class="hljs-number">2</span>   national  <span class="hljs-number">3</span> non-null      <span class="hljs-built_in">object</span><br>dtypes: <span class="hljs-built_in">object</span>(<span class="hljs-number">3</span>)<br>memory usage: <span class="hljs-number">96.0</span>+ <span class="hljs-built_in">bytes</span><br><span class="hljs-literal">None</span><br></code></pre></td></tr></table></figure>
<p>显示头⼏⾏,默认显示 5⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.head(<span class="hljs-number">2</span>))<br><br>---<br>    name age national<br><span class="hljs-number">0</span>  James  <span class="hljs-number">18</span>       us<br><span class="hljs-number">1</span>  Curry  <span class="hljs-number">20</span>    China<br></code></pre></td></tr></table></figure>
<p>显示后⼏⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.tail(<span class="hljs-number">1</span>))<br><br>---<br>       name age national<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br></code></pre></td></tr></table></figure>
<p>获取 DataFrame 的列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df[<span class="hljs-string">&#x27;name&#x27;</span>])<br><br>---<br><span class="hljs-number">0</span>       James<br><span class="hljs-number">1</span>       Curry<br><span class="hljs-number">2</span>    Iversion<br>Name: name, dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>因为我们<strong>只获取⼀列</strong>，所以返回的就是⼀个 Series</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(df[<span class="hljs-string">&#x27;name&#x27;</span>]))<br><br>---<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pandas.core.series.Series&#x27;</span>&gt;<br></code></pre></td></tr></table></figure>
<p>如果<strong>获取多个列</strong>，那返回的就是⼀个 DataFrame
类型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df[[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>]])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(df[[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>]]))<br><br>---<br>       name age<br><span class="hljs-number">0</span>     James  <span class="hljs-number">18</span><br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span><br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span><br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pandas.core.frame.DataFrame&#x27;</span>&gt;<br></code></pre></td></tr></table></figure>
<p>获取一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>])<br><br>---<br>    name age national<br><span class="hljs-number">0</span>  James  <span class="hljs-number">18</span>       us<br></code></pre></td></tr></table></figure>
<p>去多⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>])<br><br>---<br>       name age national<br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span>    China<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br></code></pre></td></tr></table></figure>
<p>取多⾏⾥⾯的某⼀列（不能进⾏多⾏多列的选择）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>][[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>]])<br><br>---<br>       name age<br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span><br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span><br></code></pre></td></tr></table></figure>
<p>⚠️
注意：<code>df[]</code>只能进⾏⾏选择，或列选择，不能同时多⾏多列选择。比如在
NumPy
中的<code>data[:,1:3]</code>这种是不行的。当然，并不是没有办法获取，我们接着往下看:</p>
<p><code>df.loc</code>通过标签索引⾏数据;<code>df.iloc</code>通过位置获取⾏数据</p>
<p>获取某⼀⾏某⼀列的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;name&#x27;</span>])<br><br>---<br>James<br></code></pre></td></tr></table></figure>
<p>⼀⾏所有列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;0&#x27;</span>,:])<br><br>---<br>name        James<br>age            <span class="hljs-number">18</span><br>national       us<br>Name: <span class="hljs-number">0</span>, dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>某⼀⾏多列的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;0&#x27;</span>,[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>]])<br><br>---<br>name    James<br>age        <span class="hljs-number">18</span><br>Name: <span class="hljs-number">0</span>, dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>选择间隔的多⾏多列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.loc[[<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>],[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;national&#x27;</span>]]) <br><br>---<br>       name national<br><span class="hljs-number">0</span>     James       us<br><span class="hljs-number">2</span>  Iversion       us<br></code></pre></td></tr></table></figure>
<p>选择连续的多⾏和间隔的多列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;0&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;national&#x27;</span>]])<br><br>---<br>       name national<br><span class="hljs-number">0</span>     James       us<br><span class="hljs-number">1</span>     Curry    China<br><span class="hljs-number">2</span>  Iversion       us<br></code></pre></td></tr></table></figure>
<p>取⼀⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">1</span>])<br><br>---<br>name        Curry<br>age            <span class="hljs-number">20</span><br>national    China<br>Name: <span class="hljs-number">1</span>, dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>取连续多⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>])<br><br>---<br>    name age national<br><span class="hljs-number">0</span>  James  <span class="hljs-number">18</span>       us<br><span class="hljs-number">1</span>  Curry  <span class="hljs-number">20</span>    China<br></code></pre></td></tr></table></figure>
<p>取间断的多⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>],:])<br><br>---<br>       name age national<br><span class="hljs-number">0</span>     James  <span class="hljs-number">18</span>       us<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br></code></pre></td></tr></table></figure>
<p>取某⼀列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[:,<span class="hljs-number">1</span>])<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">18</span><br><span class="hljs-number">1</span>    <span class="hljs-number">20</span><br><span class="hljs-number">2</span>    <span class="hljs-number">19</span><br>Name: age, dtype: <span class="hljs-built_in">object</span><br></code></pre></td></tr></table></figure>
<p>某⼀个值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><br>---<br>Curry<br></code></pre></td></tr></table></figure>
<p>修改值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df.iloc[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;panda&#x27;</span><br><span class="hljs-built_in">print</span>(df)<br><br>---<br>       name age national<br><span class="hljs-number">0</span>     panda  <span class="hljs-number">18</span>       us<br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span>    China<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br></code></pre></td></tr></table></figure>
<p>dataframe 中的排序⽅法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df = df.sort_values(by=<span class="hljs-string">&#x27;age&#x27;</span>, ascending*=<span class="hljs-literal">False</span>) <br><span class="hljs-built_in">print</span>(df)<br><br>---<br>       name age national<br><span class="hljs-number">1</span>     Curry  <span class="hljs-number">20</span>    China<br><span class="hljs-number">2</span>  Iversion  <span class="hljs-number">19</span>       us<br><span class="hljs-number">0</span>     panda  <span class="hljs-number">18</span>       us<br></code></pre></td></tr></table></figure>
<p><code>ascending=False</code>是降序排列，默认为<code>True</code>，也就是升序。</p>
<h3
id="dataframe修改indexcolumns">dataframe<strong>修改</strong>index<strong>、</strong>columns</h3>
<p>一样，让我们先创建一组新的数据供我们使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df1 = pd.DataFrame(np.arange(<span class="hljs-number">9</span>).reshape(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), index = [<span class="hljs-string">&#x27;bj&#x27;</span>, <span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;gz&#x27;</span>], columns=[<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>])<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>    a  b  c<br>bj  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>sh  <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span><br>gz  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>
<p>修改 df1 的 index</p>
<p><code>df1.index</code>可以打印出 df1
的索引值，同时也可以为其赋值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.index) <span class="hljs-comment"># 可以打印出 print 的值，同时也可以为其赋值</span><br>df1.index = [<span class="hljs-string">&#x27;beijing&#x27;</span>, <span class="hljs-string">&#x27;shanghai&#x27;</span>, <span class="hljs-string">&#x27;guangzhou&#x27;</span>]<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>Index([<span class="hljs-string">&#x27;bj&#x27;</span>, <span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;gz&#x27;</span>], dtype=<span class="hljs-string">&#x27;object&#x27;</span>)<br>           a  b  c<br>beijing    <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span><br>shanghai   <span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">5</span><br>guangzhou  <span class="hljs-number">6</span>  <span class="hljs-number">7</span>  <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>
<p>⾃定义 map 函数（x 是原有的⾏列值）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ⾃定义 map 函数（x 是原有的⾏列值） </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_map</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x+<span class="hljs-string">&#x27;_ABC&#x27;</span><br><span class="hljs-built_in">print</span>(df1.rename(index=test_map, columns=test_map, inplace=<span class="hljs-literal">True</span>))<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br><span class="hljs-literal">None</span><br>               a_ABC  b_ABC  c_ABC<br>beijing_ABC        <span class="hljs-number">0</span>      <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br>shanghai_ABC       <span class="hljs-number">3</span>      <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br>guangzhou_ABC      <span class="hljs-number">6</span>      <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>
<p>其中的<code>inplace</code>传入一个布尔值，默认为
False。指定是否返回新的 DataFrame。如果为 True，则在原 df 上修改，
返回值为 None。</p>
<p><code>rename</code> 可以传⼊字典，为某个 index 单独修改名称</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df3 = df1.rename(index=&#123;<span class="hljs-string">&#x27;beijing_ABC&#x27;</span>:<span class="hljs-string">&#x27;beijing&#x27;</span>&#125;, columns = &#123;<span class="hljs-string">&#x27;a_ABC&#x27;</span>:<span class="hljs-string">&#x27;aa&#x27;</span>&#125;)<br><span class="hljs-built_in">print</span>(df3)<br><br>---<br>               aa  b_ABC  c_ABC<br>beijing         <span class="hljs-number">0</span>      <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br>shanghai_ABC    <span class="hljs-number">3</span>      <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br>guangzhou_ABC   <span class="hljs-number">6</span>      <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>
<p>列转化为索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;X&#x27;</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>),<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>),<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;abcde&quot;</span>),<span class="hljs-string">&#x27;Z&#x27;</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]&#125;)<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>   X  Y  S  Z<br><span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  a  <span class="hljs-number">1</span><br><span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  b  <span class="hljs-number">1</span><br><span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  c  <span class="hljs-number">2</span><br><span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  d  <span class="hljs-number">2</span><br><span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  e  <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>指定⼀列为索引 (<code>drop=False</code> 指定同时保留作为索引的列)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">result = df1.set_index(<span class="hljs-string">&#x27;S&#x27;</span>,drop=<span class="hljs-literal">False</span>)<br>result.index.name=<span class="hljs-literal">None</span><br><span class="hljs-built_in">print</span>(result)<br><br>---<br>   X  Y  S  Z<br>a  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  a  <span class="hljs-number">1</span><br>b  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  b  <span class="hljs-number">1</span><br>c  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  c  <span class="hljs-number">2</span><br>d  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  d  <span class="hljs-number">2</span><br>e  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  e  <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>⾏转为列索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">result = df1.set_axis(df1.iloc[<span class="hljs-number">0</span>],axis=<span class="hljs-number">1</span>,inplace=<span class="hljs-literal">False</span>)<br>result.columns.name=<span class="hljs-literal">None</span><br><span class="hljs-built_in">print</span>(result)<br><br>---<br>   <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  a  <span class="hljs-number">1</span><br><span class="hljs-number">0</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>  a  <span class="hljs-number">1</span><br><span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  b  <span class="hljs-number">1</span><br><span class="hljs-number">2</span>  <span class="hljs-number">2</span>  <span class="hljs-number">2</span>  c  <span class="hljs-number">2</span><br><span class="hljs-number">3</span>  <span class="hljs-number">3</span>  <span class="hljs-number">3</span>  d  <span class="hljs-number">2</span><br><span class="hljs-number">4</span>  <span class="hljs-number">4</span>  <span class="hljs-number">4</span>  e  <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<h3 id="添加数据">添加数据</h3>
<p>先增加一组数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1 = pd.DataFrame([[<span class="hljs-string">&#x27;Snow&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-number">22</span>],[<span class="hljs-string">&#x27;Tyrion&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-number">32</span>],[<span class="hljs-string">&#x27;Sansa&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-number">18</span>], [<span class="hljs-string">&#x27;Arya&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-number">14</span>]],columns=[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;gender&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>])<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  age<br><span class="hljs-number">0</span>    Snow      M   <span class="hljs-number">22</span><br><span class="hljs-number">1</span>  Tyrion      M   <span class="hljs-number">32</span><br><span class="hljs-number">2</span>   Sansa      F   <span class="hljs-number">18</span><br><span class="hljs-number">3</span>    Arya      F   <span class="hljs-number">14</span><br></code></pre></td></tr></table></figure>
<p>在数据框最后加上
score⼀列，注意增加列的元素个数要跟原数据列的个数⼀样。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1[<span class="hljs-string">&#x27;score&#x27;</span>]=[<span class="hljs-number">80</span>,<span class="hljs-number">98</span>,<span class="hljs-number">67</span>,<span class="hljs-number">90</span>] <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  age  score<br><span class="hljs-number">0</span>    Snow      M   <span class="hljs-number">22</span>     <span class="hljs-number">80</span><br><span class="hljs-number">1</span>  Tyrion      M   <span class="hljs-number">32</span>     <span class="hljs-number">98</span><br><span class="hljs-number">2</span>   Sansa      F   <span class="hljs-number">18</span>     <span class="hljs-number">67</span><br><span class="hljs-number">3</span>    Arya      F   <span class="hljs-number">14</span>     <span class="hljs-number">90</span><br></code></pre></td></tr></table></figure>
<p>在具体某个位置插⼊⼀列可以⽤<code>insert</code>的⽅法,
语法格式：<code>列表.insert(index, obj)</code></p>
<p><code>index</code> ---&gt;对象 obj 需要插⼊的索引位置。</p>
<p><code>obj</code>---&gt; 要插⼊列表中的对象（列名）</p>
<p>将数据框的列名全部提取出来存放在列表⾥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">col_name=df1.columns.tolist() <br><span class="hljs-built_in">print</span>(col_name)<br><br>---<br>[<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;gender&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>在列索引为 2 的位置插⼊⼀列,列名为:<code>city</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">col_name.insert(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;city&#x27;</span>)<br><span class="hljs-built_in">print</span>(col_name)<br><br>---<br>[<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;gender&#x27;</span>, <span class="hljs-string">&#x27;city&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>刚插⼊时不会有值，整列都是
NaN,我们使用<code>DataFrame.reindex()</code>对原⾏/列索引重新构建索引值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=df1.reindex(columns=col_name)<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  city  age  score<br><span class="hljs-number">0</span>    Snow      M   NaN   <span class="hljs-number">22</span>     <span class="hljs-number">80</span><br><span class="hljs-number">1</span>  Tyrion      M   NaN   <span class="hljs-number">32</span>     <span class="hljs-number">98</span><br><span class="hljs-number">2</span>   Sansa      F   NaN   <span class="hljs-number">18</span>     <span class="hljs-number">67</span><br><span class="hljs-number">3</span>    Arya      F   NaN   <span class="hljs-number">14</span>     <span class="hljs-number">90</span><br></code></pre></td></tr></table></figure>
<p>给 city 列赋值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1[<span class="hljs-string">&#x27;city&#x27;</span>]=[<span class="hljs-string">&#x27;北京京&#x27;</span>,<span class="hljs-string">&#x27;⼭⻄西&#x27;</span>,<span class="hljs-string">&#x27;湖北北&#x27;</span>,<span class="hljs-string">&#x27;澳⻔门&#x27;</span>] <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender city  age  score<br><span class="hljs-number">0</span>    Snow      M  北京京   <span class="hljs-number">22</span>     <span class="hljs-number">80</span><br><span class="hljs-number">1</span>  Tyrion      M  ⼭⻄西   <span class="hljs-number">32</span>     <span class="hljs-number">98</span><br><span class="hljs-number">2</span>   Sansa      F  湖北北   <span class="hljs-number">18</span>     <span class="hljs-number">67</span><br><span class="hljs-number">3</span>    Arya      F  澳⻔门   <span class="hljs-number">14</span>     <span class="hljs-number">90</span><br></code></pre></td></tr></table></figure>
<p>df 中的<code>insert</code>是插⼊⼀列。语法和关键参数为：</p>
<p><code>df.insert(iloc,column,value)</code></p>
<p><code>iloc</code>:要插⼊的位置</p>
<p><code>colunm</code>:列名</p>
<p><code>value</code>:值</p>
<p>刚才我们插入<code>city</code>列的时候省略了<code>value</code>,所以新建列值全部为<code>NaN</code>，这次我们加上再看：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1.insert(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;score2&#x27;</span>,[<span class="hljs-number">80</span>,<span class="hljs-number">98</span>,<span class="hljs-number">67</span>,<span class="hljs-number">90</span>]) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  score2 city  age  score<br><span class="hljs-number">0</span>    Snow      M      <span class="hljs-number">80</span>  北京京   <span class="hljs-number">22</span>     <span class="hljs-number">80</span><br><span class="hljs-number">1</span>  Tyrion      M      <span class="hljs-number">98</span>  ⼭⻄西   <span class="hljs-number">32</span>     <span class="hljs-number">98</span><br><span class="hljs-number">2</span>   Sansa      F      <span class="hljs-number">67</span>  湖北北   <span class="hljs-number">18</span>     <span class="hljs-number">67</span><br><span class="hljs-number">3</span>    Arya      F      <span class="hljs-number">90</span>  澳⻔门   <span class="hljs-number">14</span>     <span class="hljs-number">90</span><br></code></pre></td></tr></table></figure>
<p>插⼊⼀⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 插⼊⼀⾏</span><br>row=[<span class="hljs-string">&#x27;111&#x27;</span>,<span class="hljs-string">&#x27;222&#x27;</span>,<span class="hljs-string">&#x27;333&#x27;</span>,<span class="hljs-string">&#x27;444&#x27;</span>,<span class="hljs-string">&#x27;555&#x27;</span>,<span class="hljs-string">&#x27;666&#x27;</span>] <br>df1.iloc[<span class="hljs-number">1</span>]=row<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>    name gender score2 city  age score<br><span class="hljs-number">0</span>   Snow      M     <span class="hljs-number">80</span>  北京京   <span class="hljs-number">22</span>    <span class="hljs-number">80</span><br><span class="hljs-number">1</span>    <span class="hljs-number">111</span>    <span class="hljs-number">222</span>    <span class="hljs-number">333</span>  <span class="hljs-number">444</span>  <span class="hljs-number">555</span>   <span class="hljs-number">666</span><br><span class="hljs-number">2</span>  Sansa      F     <span class="hljs-number">67</span>  湖北北   <span class="hljs-number">18</span>    <span class="hljs-number">67</span><br><span class="hljs-number">3</span>   Arya      F     <span class="hljs-number">90</span>  澳⻔门   <span class="hljs-number">14</span>    <span class="hljs-number">90</span><br></code></pre></td></tr></table></figure>
<p>插入行的时候，列个数必须对应才可以，否则会报错。</p>
<p>目前这组数据已经被我们玩乱了，我们再重新生成一组数据来看后面的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1 = pd.DataFrame([[<span class="hljs-string">&#x27;Snow&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-number">22</span>],[<span class="hljs-string">&#x27;Tyrion&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-number">32</span>],[<span class="hljs-string">&#x27;Sansa&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-number">18</span>],[<span class="hljs-string">&#x27;Arya&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-number">14</span>]],columns=[<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;gender&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>])<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  age<br><span class="hljs-number">0</span>    Snow      M   <span class="hljs-number">22</span><br><span class="hljs-number">1</span>  Tyrion      M   <span class="hljs-number">32</span><br><span class="hljs-number">2</span>   Sansa      F   <span class="hljs-number">18</span><br><span class="hljs-number">3</span>    Arya      F   <span class="hljs-number">14</span><br></code></pre></td></tr></table></figure>
<p>再继续创建一组数据，我们将尝试将两组数据进行合并,
新创建的这组数据⽤来增加进数据框的最后⼀⾏。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">new=pd.DataFrame(&#123;<span class="hljs-string">&#x27;name&#x27;</span>:<span class="hljs-string">&#x27;lisa&#x27;</span>,<span class="hljs-string">&#x27;gender&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>:<span class="hljs-number">19</span>&#125;,index=[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(new)<br><br>---<br>   name gender  age<br><span class="hljs-number">0</span>  lisa      F   <span class="hljs-number">19</span><br></code></pre></td></tr></table></figure>
<p>在原数据框 df1 最后⼀⾏新增⼀⾏，⽤<code>append</code>⽅法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=df1.append(new,ignore_index=<span class="hljs-literal">True</span>) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     name gender  age<br><span class="hljs-number">0</span>    Snow      M   <span class="hljs-number">22</span><br><span class="hljs-number">1</span>  Tyrion      M   <span class="hljs-number">32</span><br><span class="hljs-number">2</span>   Sansa      F   <span class="hljs-number">18</span><br><span class="hljs-number">3</span>    Arya      F   <span class="hljs-number">14</span><br><span class="hljs-number">4</span>    lisa      F   <span class="hljs-number">19</span><br></code></pre></td></tr></table></figure>
<p><code>ignore_index=False</code>,表示不按原来的索引， 从 0
开始⾃动递增。</p>
<p><code>objs</code>:合并对象</p>
<p><code>axis</code>:合并⽅式，默认 0 表示按列合并，1 表示按⾏合并</p>
<p><code>ignore_index</code>:是否忽略索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">df1 = pd.DataFrame(np.arange(<span class="hljs-number">6</span>).reshape(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>),columns=[<span class="hljs-string">&#x27;four&#x27;</span>,<span class="hljs-string">&#x27;five&#x27;</span>])<br>df2 = pd.DataFrame(np.arange(<span class="hljs-number">6</span>).reshape(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>),columns=[<span class="hljs-string">&#x27;one&#x27;</span>,<span class="hljs-string">&#x27;two&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>])<br><span class="hljs-built_in">print</span>(df1)<br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>   four  five<br><span class="hljs-number">0</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span><br><span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">3</span><br><span class="hljs-number">2</span>     <span class="hljs-number">4</span>     <span class="hljs-number">5</span><br>   one  two  three<br><span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br><span class="hljs-number">1</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<p>按行合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">result = pd.concat([df1,df2],axis=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(result)<br><br>---<br>   four  five  one  two  three<br><span class="hljs-number">0</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>    <span class="hljs-number">2.0</span><br><span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">3</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">4.0</span>    <span class="hljs-number">5.0</span><br><span class="hljs-number">2</span>     <span class="hljs-number">4</span>     <span class="hljs-number">5</span>  NaN  NaN    NaN<br></code></pre></td></tr></table></figure>
<p>按列合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">   four  five  one  two  three<br><span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>   <span class="hljs-number">1.0</span>  NaN  NaN    NaN<br><span class="hljs-number">1</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">3.0</span>  NaN  NaN    NaN<br><span class="hljs-number">2</span>   <span class="hljs-number">4.0</span>   <span class="hljs-number">5.0</span>  NaN  NaN    NaN<br><span class="hljs-number">3</span>   NaN   NaN  <span class="hljs-number">0.0</span>  <span class="hljs-number">1.0</span>    <span class="hljs-number">2.0</span><br><span class="hljs-number">4</span>   NaN   NaN  <span class="hljs-number">3.0</span>  <span class="hljs-number">4.0</span>    <span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure>
<p>看结果我们能看出来，在合并的时候，如果对应不到值，那么就会默认添加<code>NaN</code>值。</p>
<p>DataFrame 的删除</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">df2 = pd.DataFrame(np.arange(<span class="hljs-number">9</span>).reshape(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),columns=[<span class="hljs-string">&#x27;one&#x27;</span>,<span class="hljs-string">&#x27;two&#x27;</span>,<span class="hljs-string">&#x27;three&#x27;</span>])<br><span class="hljs-built_in">print</span>(df2)<br>df3=df2.drop([<span class="hljs-string">&#x27;one&#x27;</span>],axis=<span class="hljs-number">1</span>, inplace=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(df2)<br><span class="hljs-built_in">print</span>(df3)<br><br>---<br>   one  two  three<br><span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br><span class="hljs-number">1</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br><span class="hljs-number">2</span>    <span class="hljs-number">6</span>    <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br>   two  three<br><span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br><span class="hljs-number">1</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br><span class="hljs-number">2</span>    <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br><span class="hljs-literal">None</span><br></code></pre></td></tr></table></figure>
<p><code>lables</code>：要删除数据的标签</p>
<p><code>axis</code>：0 表示删除⾏，1 表示删除列，默认 0</p>
<p><code>inplace</code>:是否在当前 df 中执⾏此操作</p>
<p>最后的返回值为<code>None</code>，原因是我们设置<code>inplace</code>为<code>True</code>，在当前<code>df</code>中执行操作。如果我们将其设置为<code>False</code>，则会将操作后的值进行返回，生成一个新的对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">df3=df2.drop([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],axis=<span class="hljs-number">0</span>, inplace=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(df2)<br><span class="hljs-built_in">print</span>(df3)<br><br>---<br>   one  two  three<br><span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>      <span class="hljs-number">2</span><br><span class="hljs-number">1</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span>      <span class="hljs-number">5</span><br><span class="hljs-number">2</span>    <span class="hljs-number">6</span>    <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br>   one  two  three<br><span class="hljs-number">2</span>    <span class="hljs-number">6</span>    <span class="hljs-number">7</span>      <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>
<h2 id="数据处理">数据处理</h2>
<p>在我们查看完 DataFrame
的基础操作之后，我们现在来正式开始数据处理。</p>
<p>我们可以通过通过<code>dropna()</code>滤除缺失数据，先让我们创建一组数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">se=pd.Series([<span class="hljs-number">4</span>,NaN,<span class="hljs-number">8</span>,NaN,<span class="hljs-number">5</span>]) <br><span class="hljs-built_in">print</span>(se)<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">4.0</span><br><span class="hljs-number">1</span>    NaN<br><span class="hljs-number">2</span>    <span class="hljs-number">8.0</span><br><span class="hljs-number">3</span>    NaN<br><span class="hljs-number">4</span>    <span class="hljs-number">5.0</span><br>dtype: float64<br></code></pre></td></tr></table></figure>
<p>尝试清除缺失数据，也就是<code>NaN</code>值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(se.dropna())<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>    <span class="hljs-number">8.0</span><br><span class="hljs-number">4</span>    <span class="hljs-number">5.0</span><br>dtype: float64<br></code></pre></td></tr></table></figure>
<p>在清除数据之前，我们有两个方法可以判断当前数据中是否有缺失数据，不过这两个方法的判断方式是相反的，一个是判断不是缺失数据，一个判断是缺失数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(se.notnull())<br><span class="hljs-built_in">print</span>(se.isnull())<br><br>---<br><span class="hljs-number">0</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">1</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">2</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">3</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">4</span>     <span class="hljs-literal">True</span><br>dtype: <span class="hljs-built_in">bool</span><br><span class="hljs-number">0</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">1</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">2</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">3</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">4</span>    <span class="hljs-literal">False</span><br>dtype: <span class="hljs-built_in">bool</span><br></code></pre></td></tr></table></figure>
<p>那既然有方法可以进行判断当前数据是否为缺失数据，那么我们用之前的方法与其配合，一样可以做滤除操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(se[se.notnull()])<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>    <span class="hljs-number">8.0</span><br><span class="hljs-number">4</span>    <span class="hljs-number">5.0</span><br>dtype: float64<br></code></pre></td></tr></table></figure>
<p>当然，除了 Series 对象之外，我们还需要进行处理 DataFrame 对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame([[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[NaN,NaN,<span class="hljs-number">2</span>],[NaN,NaN,NaN],[<span class="hljs-number">8</span>,<span class="hljs-number">8</span>,NaN]]) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  NaN  NaN  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  NaN  NaN  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>默认滤除所有包含<code>NaN</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.dropna())<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br></code></pre></td></tr></table></figure>
<p>传⼊<code>how=‘all’</code>滤除全为<code>NaN</code>的⾏：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.dropna(how=<span class="hljs-string">&#x27;all&#x27;</span>)) <br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  NaN  NaN  <span class="hljs-number">2.0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>可以看到，除了下标为<code>2</code>的那一行之外，其余含<code>NaN</code>值的行都被保留了。</p>
<p>之前操作最后只留下一行，原因是<code>how</code>的默认值为<code>how='any'</code>。只要是<code>nan</code>就删除</p>
<p>传⼊axis=1 滤除列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.dropna(axis=<span class="hljs-number">1</span>,how=<span class="hljs-string">&quot;all&quot;</span>))<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  NaN  NaN  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  NaN  NaN  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>为什么没有变化？按列来查看，没有一列是全是<code>NaN</code>值的。</p>
<p>除了<code>how</code>值外，我们还可以可以使用<code>thresh</code>来精准操作，它可以传入一个数值<code>n</code>，会保留至少<code>n</code>个非<code>NaN</code>数据的行或列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.dropna(thresh=<span class="hljs-number">2</span>))<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>仅有一个非<code>NaN</code>的行和全部为<code>NaN</code>的行就都被滤除了。</p>
<p>那<code>NaN</code>是不是就只能被删除了呢？并不是，还记得我们之前操作的时候我提到过，我们大多数遇到<code>NaN</code>值的时候，基本都是用平均值来进行填充，这是一个惯例操作。</p>
<p>那么，我们来看看如何填充缺失数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame([[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[NaN,NaN,<span class="hljs-number">2</span>],[NaN,NaN,NaN],[<span class="hljs-number">8</span>,<span class="hljs-number">8</span>,NaN]]) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  NaN  NaN  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  NaN  NaN  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>⽤常数填充<code>fillna</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.fillna(<span class="hljs-number">0</span>))<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">0.0</span><br></code></pre></td></tr></table></figure>
<p>传⼊<code>inplace=True</code>直接修改原对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1.fillna(<span class="hljs-number">0</span>,inplace=<span class="hljs-literal">True</span>) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">0.0</span><br></code></pre></td></tr></table></figure>
<p>通过字典填充不同的常数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.fillna(&#123;<span class="hljs-number">0</span>:<span class="hljs-number">10</span>,<span class="hljs-number">1</span>:<span class="hljs-number">20</span>,<span class="hljs-number">2</span>:<span class="hljs-number">30</span>&#125;))<br><br>---<br>      <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span><br><span class="hljs-number">0</span>   <span class="hljs-number">1.0</span>   <span class="hljs-number">2.0</span>   <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">20.0</span>   <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">20.0</span>  <span class="hljs-number">30.0</span><br><span class="hljs-number">3</span>   <span class="hljs-number">8.0</span>   <span class="hljs-number">8.0</span>  <span class="hljs-number">30.0</span><br></code></pre></td></tr></table></figure>
<p>还有我们之前提到过的，填充平均值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.fillna(df1.mean()))<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">4.5</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">4.5</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">2.5</span><br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">2.5</span><br></code></pre></td></tr></table></figure>
<p>当然，我们可以只填充某一列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.iloc[:,<span class="hljs-number">1</span>].fillna(<span class="hljs-number">5</span>,inplace = <span class="hljs-literal">True</span>)) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br><span class="hljs-literal">None</span><br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span><br><span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  NaN  <span class="hljs-number">5.0</span>  <span class="hljs-number">2.0</span><br><span class="hljs-number">2</span>  NaN  <span class="hljs-number">5.0</span>  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">8.0</span>  NaN<br></code></pre></td></tr></table></figure>
<p>传⼊<code>method=” “</code>会改变插值⽅式，先来一组数据，并在其中加上<code>NaN</code>值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df2=pd.DataFrame(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,(<span class="hljs-number">5</span>,<span class="hljs-number">5</span>))) <br>df2.iloc[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>,<span class="hljs-number">3</span>]=NaN<br>df2.iloc[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>,<span class="hljs-number">4</span>]=NaN<br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span><br><span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">9</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  NaN  <span class="hljs-number">8.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8</span>  NaN  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span>  NaN  NaN<br><span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">2.0</span><br></code></pre></td></tr></table></figure>
<p>现在，我们用前面的值来填充， <code>method ='ffill'</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.fillna(method=<span class="hljs-string">&#x27;ffill&#x27;</span>))<br><br>---<br>   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span><br><span class="hljs-number">0</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">9</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">8.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">8.0</span><br><span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>  <span class="hljs-number">5</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">8.0</span><br><span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">2.0</span><br></code></pre></td></tr></table></figure>
<p>用后面的值来填充<code>method='bfill'</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.fillna(method=<span class="hljs-string">&#x27;bfill&#x27;</span>,limit=<span class="hljs-number">1</span>))<br><br>---<br>   <span class="hljs-number">0</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span><br><span class="hljs-number">0</span>  <span class="hljs-number">7</span>  <span class="hljs-number">1</span>  <span class="hljs-number">8</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">6</span>  <span class="hljs-number">8</span>  <span class="hljs-number">4</span>  NaN  <span class="hljs-number">5.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">6</span>  <span class="hljs-number">2</span>  <span class="hljs-number">5</span>  NaN  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">4</span>  <span class="hljs-number">8</span>  <span class="hljs-number">0</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">3.0</span><br><span class="hljs-number">4</span>  <span class="hljs-number">8</span>  <span class="hljs-number">0</span>  <span class="hljs-number">2</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">3.0</span><br></code></pre></td></tr></table></figure>
<p>以上代码中，我们还传入了<code>limit</code>， 用于限制填充行数。</p>
<p>当我们传入<code>axis</code>的时候，会修改填充方向：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.fillna(method=<span class="hljs-string">&quot;ffill&quot;</span>,limit=<span class="hljs-number">1</span>,axis=<span class="hljs-number">1</span>))<br><br>---<br>     <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span>    <span class="hljs-number">4</span><br><span class="hljs-number">0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">7.0</span><br><span class="hljs-number">1</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">9.0</span><br><span class="hljs-number">2</span>  <span class="hljs-number">1.0</span>  <span class="hljs-number">8.0</span>  <span class="hljs-number">5.0</span>  <span class="hljs-number">5.0</span>  NaN<br><span class="hljs-number">3</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">3.0</span>  <span class="hljs-number">3.0</span>  NaN<br><span class="hljs-number">4</span>  <span class="hljs-number">2.0</span>  <span class="hljs-number">9.0</span>  <span class="hljs-number">4.0</span>  <span class="hljs-number">6.0</span>  <span class="hljs-number">3.0</span><br></code></pre></td></tr></table></figure>
<p>接着，我们再来看看如何移除重复数据，俗称「去重」：</p>
<p>DataFrame
中经常会出现重复⾏，利⽤<code>duplicated()</code>函数返回每⼀⾏判断是否重复的结果（重复则为
True)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;A&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;B&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;aabbbca&quot;</span>)&#125;)<br><span class="hljs-built_in">print</span>(df1)<br><span class="hljs-built_in">print</span>(df1.duplicated())<br><br>---<br>   A  B<br><span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a<br><span class="hljs-number">1</span>  <span class="hljs-number">1</span>  a<br><span class="hljs-number">2</span>  <span class="hljs-number">1</span>  b<br><span class="hljs-number">3</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">4</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">5</span>  <span class="hljs-number">3</span>  c<br><span class="hljs-number">6</span>  <span class="hljs-number">1</span>  a<br><br><span class="hljs-number">0</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">1</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">2</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">3</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">4</span>     <span class="hljs-literal">True</span><br><span class="hljs-number">5</span>    <span class="hljs-literal">False</span><br><span class="hljs-number">6</span>     <span class="hljs-literal">True</span><br>dtype: <span class="hljs-built_in">bool</span><br></code></pre></td></tr></table></figure>
<p>去除全部的重复⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.drop_duplicates())<br><br>---<br>   A  B<br><span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a<br><span class="hljs-number">2</span>  <span class="hljs-number">1</span>  b<br><span class="hljs-number">3</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">5</span>  <span class="hljs-number">3</span>  c<br></code></pre></td></tr></table></figure>
<p>指定列去除重复行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.drop_duplicates([<span class="hljs-string">&#x27;A&#x27;</span>]))<br><br>---<br>   A  B<br><span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a<br><span class="hljs-number">3</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">5</span>  <span class="hljs-number">3</span>  c<br></code></pre></td></tr></table></figure>
<p>保留重复⾏中的最后⼀⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;A&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;B&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;aabbbca&quot;</span>)&#125;)<br><span class="hljs-built_in">print</span>(df1.drop_duplicates([<span class="hljs-string">&#x27;A&#x27;</span>],keep=<span class="hljs-string">&#x27;last&#x27;</span>))<br><br>---<br>   A  B<br><span class="hljs-number">4</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">5</span>  <span class="hljs-number">3</span>  c<br><span class="hljs-number">6</span>  <span class="hljs-number">1</span>  a<br></code></pre></td></tr></table></figure>
<p>去除重复的同时改变 DataFrame 对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df1.drop_duplicates([<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>],inplace=<span class="hljs-literal">True</span>) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>   A  B<br><span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a<br><span class="hljs-number">2</span>  <span class="hljs-number">1</span>  b<br><span class="hljs-number">3</span>  <span class="hljs-number">2</span>  b<br><span class="hljs-number">5</span>  <span class="hljs-number">3</span>  c<br></code></pre></td></tr></table></figure>
<h3 id="数据合并">数据合并</h3>
<p>我们平时会与拿到的数据可能存储在不同的数据表中，这需要我们对数据进行合并，然后再进行操作。</p>
<p>使⽤<code>join</code>合并，着重关注的是<strong>⾏的合并</strong>。</p>
<p>简单合并（默认是 left 左连接,以左侧<code>df3</code>为基础）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">df3=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Red&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],<span class="hljs-string">&#x27;Green&#x27;</span>:[<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>]&#125;,index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;abc&#x27;</span>))<br>df4=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Blue&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>],<span class="hljs-string">&#x27;Yellow&#x27;</span>:[<span class="hljs-number">6</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>]&#125;,index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;cde&#x27;</span>)) <br><span class="hljs-built_in">print</span>(df3)<br><span class="hljs-built_in">print</span>(df4)<br>df3.join(df4,how=<span class="hljs-string">&#x27;left&#x27;</span>)<br><br>---<br>   Red  Green<br>a    <span class="hljs-number">1</span>      <span class="hljs-number">5</span><br>b    <span class="hljs-number">3</span>      <span class="hljs-number">0</span><br>c    <span class="hljs-number">5</span>      <span class="hljs-number">3</span><br>   Blue  Yellow<br>c     <span class="hljs-number">1</span>       <span class="hljs-number">6</span><br>d     <span class="hljs-number">9</span>       <span class="hljs-number">6</span><br>e     <span class="hljs-number">8</span>       <span class="hljs-number">7</span><br><br><br>	Red	Green	Blue	Yellow<br>a	<span class="hljs-number">1</span>		<span class="hljs-number">5</span>			NaN		NaN<br>b	<span class="hljs-number">3</span>		<span class="hljs-number">0</span>			NaN		NaN<br>c	<span class="hljs-number">5</span>		<span class="hljs-number">3</span>			<span class="hljs-number">1.0</span>		<span class="hljs-number">6.0</span><br></code></pre></td></tr></table></figure>
<p>右链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df3.join(df4,how=<span class="hljs-string">&#x27;outer&#x27;</span>)<br><br>---<br>	Red	Green	Blue	Yellow<br>a	<span class="hljs-number">1.0</span>	<span class="hljs-number">5.0</span>		NaN		NaN<br>b	<span class="hljs-number">3.0</span>	<span class="hljs-number">0.0</span>		NaN		NaN<br>c	<span class="hljs-number">5.0</span>	<span class="hljs-number">3.0</span>		<span class="hljs-number">1.0</span>		<span class="hljs-number">6.0</span><br>d	NaN	NaN		<span class="hljs-number">9.0</span>		<span class="hljs-number">6.0</span><br>e	NaN	NaN		<span class="hljs-number">8.0</span>		<span class="hljs-number">7.0</span><br></code></pre></td></tr></table></figure>
<p>合并多个 DataFrame 对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">df5=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Brown&#x27;</span>:[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],<span class="hljs-string">&#x27;White&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]&#125;,index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;aed&#x27;</span>)) <br>df3.join([df4,df5])<br><br>---<br><br>	Red	Green	Blue	Yellow	Brown	White<br>a	<span class="hljs-number">1.0</span>	<span class="hljs-number">5.0</span>		NaN		NaN			<span class="hljs-number">3.0</span>		<span class="hljs-number">1.0</span><br>b	<span class="hljs-number">3.0</span>	<span class="hljs-number">0.0</span>		NaN		NaN			NaN		NaN<br>c	<span class="hljs-number">5.0</span>	<span class="hljs-number">3.0</span>		<span class="hljs-number">1.0</span>		<span class="hljs-number">6.0</span>			NaN		NaN<br></code></pre></td></tr></table></figure>
<p>使⽤<code>merge</code>，着重关注的是<strong>列的合并</strong>。</p>
<p>我们先来构建两组数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;名字&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;ABCDE&#x27;</span>),<span class="hljs-string">&#x27;性别&#x27;</span>:[<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;⼥&#x27;</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;⼥&#x27;</span>],<span class="hljs-string">&#x27;职称&#x27;</span>: [<span class="hljs-string">&#x27;副教授&#x27;</span>,<span class="hljs-string">&#x27;讲师&#x27;</span>,<span class="hljs-string">&#x27;助教&#x27;</span>,<span class="hljs-string">&#x27;教授&#x27;</span>,<span class="hljs-string">&#x27;助教&#x27;</span>]&#125;,index=<span class="hljs-built_in">range</span>(<span class="hljs-number">1001</span>,<span class="hljs-number">1006</span>))<br>df1.columns.name=<span class="hljs-string">&#x27;学院⽼师&#x27;</span><br>df1.index.name=<span class="hljs-string">&#x27;编号&#x27;</span><br>df1<br><br>---<br>学院⽼师	名字	性别	职称<br>编号			<br><span class="hljs-number">1001</span>		A			男		副教授<br><span class="hljs-number">1002</span>		B			⼥		讲师<br><span class="hljs-number">1003</span>		C			男		助教<br><span class="hljs-number">1004</span>		D			男		教授<br><span class="hljs-number">1005</span>		E			⼥		助教<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">df2=pd.DataFrame(&#123;<span class="hljs-string">&#x27;名字&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;ABDAX&#x27;</span>),<span class="hljs-string">&#x27;课程&#x27;</span>:[<span class="hljs-string">&#x27;C++&#x27;</span>,<span class="hljs-string">&#x27;计算机导论&#x27;</span>,<span class="hljs-string">&#x27;汇编&#x27;</span>,<span class="hljs-string">&#x27;数据结构&#x27;</span>,<span class="hljs-string">&#x27;马克思原理&#x27;</span>],<span class="hljs-string">&#x27;职称&#x27;</span>:[<span class="hljs-string">&#x27;副教授&#x27;</span>,<span class="hljs-string">&#x27;讲师&#x27;</span>,<span class="hljs-string">&#x27;教授&#x27;</span>,<span class="hljs-string">&#x27;副教授&#x27;</span>,<span class="hljs-string">&#x27;讲师&#x27;</span>]&#125;,index= [<span class="hljs-number">1001</span>,<span class="hljs-number">1002</span>,<span class="hljs-number">1004</span>,<span class="hljs-number">1001</span>,<span class="hljs-number">3001</span>])<br>df2.columns.name=<span class="hljs-string">&#x27;课程&#x27;</span><br>df2.index.name=<span class="hljs-string">&#x27;编号&#x27;</span><br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>课程	名字	课程				职称<br>编号			<br><span class="hljs-number">1001</span>	A		C++				副教授<br><span class="hljs-number">1002</span>	B		计算机导论		讲师<br><span class="hljs-number">1004</span>	D		汇编				教授<br><span class="hljs-number">1001</span>	A		数据结构		副教授<br><span class="hljs-number">3001</span>	X		马克思原理	讲师<br></code></pre></td></tr></table></figure>
<p>默认下是根据左右对象中出现同名的列作为连接的键，且连接⽅式是<code>how=’inner’</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(pd.merge(df1,df2)) <span class="hljs-comment"># 返回匹配的</span><br><br>---<br>  名字 性别   职称     课程<br><span class="hljs-number">0</span>  A  男  副教授    C++<br><span class="hljs-number">1</span>  A  男  副教授   数据结构<br><span class="hljs-number">2</span>  B  ⼥   讲师  计算机导论<br><span class="hljs-number">3</span>  D  男   教授     汇编<br></code></pre></td></tr></table></figure>
<p>指定列名合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.merge(df1,df2,on=<span class="hljs-string">&#x27;名字&#x27;</span>,suffixes=[<span class="hljs-string">&#x27;_1&#x27;</span>,<span class="hljs-string">&#x27;_2&#x27;</span>]) <span class="hljs-comment"># 返回匹配的</span><br><br>---<br><br>	名字	性别	职称_1	课程		职称_2<br><span class="hljs-number">0</span>	A			男		副教授		C++			副教授<br><span class="hljs-number">1</span>	A			男		副教授		数据结构	副教授<br><span class="hljs-number">2</span>	B			⼥		讲师		计算机导论	讲师<br><span class="hljs-number">3</span>	D			男		教授		汇编			教授<br></code></pre></td></tr></table></figure>
<p>连接⽅式，根据左侧为准</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.merge(df1,df2,how=<span class="hljs-string">&#x27;left&#x27;</span>)<br><br>---<br>	名字	性别	职称	课程<br><span class="hljs-number">0</span>	A			男	副教授	C++<br><span class="hljs-number">1</span>	A			男	副教授	数据结构<br><span class="hljs-number">2</span>	B			⼥	讲师	计算机导论<br><span class="hljs-number">3</span>	C			男	助教	NaN<br><span class="hljs-number">4</span>	D			男	教授	汇编<br><span class="hljs-number">5</span>	E			⼥	助教	NaN<br></code></pre></td></tr></table></figure>
<p>根据右侧为准</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.merge(df1,df2,how=<span class="hljs-string">&#x27;right&#x27;</span>)<br><br>---<br>	名字	性别	职称	课程<br><span class="hljs-number">0</span>	A		男	副教授	C++<br><span class="hljs-number">1</span>	B		⼥	讲师	计算机导论<br><span class="hljs-number">2</span>	D		男	教授	汇编<br><span class="hljs-number">3</span>	A		男	副教授	数据结构<br><span class="hljs-number">4</span>	X		NaN	讲师	马克思原理<br></code></pre></td></tr></table></figure>
<p>所有的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.merge(df1,df2,how=<span class="hljs-string">&#x27;outer&#x27;</span>)<br><br>---<br><br>名字	性别	职称	课程<br><span class="hljs-number">0</span>		A	男	副教授	C++<br><span class="hljs-number">1</span>		A	男	副教授	数据结构<br><span class="hljs-number">2</span>		B	⼥	讲师	计算机导论<br><span class="hljs-number">3</span>		C	男	助教	NaN<br><span class="hljs-number">4</span>		D	男	教授	汇编<br><span class="hljs-number">5</span>		E	⼥	助教	NaN<br><span class="hljs-number">6</span>		X	NaN	讲师	马克思原理<br></code></pre></td></tr></table></figure>
<p>根据多个键进⾏连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.merge(df1,df2,*on*=[<span class="hljs-string">&#x27;职称&#x27;</span>,<span class="hljs-string">&#x27;名字&#x27;</span>])<br><br>---<br>	名字	性别	职称	课程<br><span class="hljs-number">0</span>	A			男	副教授	C++<br><span class="hljs-number">1</span>	A			男	副教授	数据结构<br><span class="hljs-number">2</span>	B			⼥	讲师	计算机导论<br><span class="hljs-number">3</span>	D			男	教授	汇编<br></code></pre></td></tr></table></figure>
<p>除此之外，我们还有一种轴向连接的方式：<code>Concat</code></p>
<p>Series 对象的连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">s1=pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;ab&#x27;</span>))<br>s2=pd.Series([<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;bde&#x27;</span>)) <br><span class="hljs-built_in">print</span>(s1)<br><span class="hljs-built_in">print</span>(s2)<br>pd.concat([s1,s2])<br><br>---<br>a    <span class="hljs-number">1</span><br>b    <span class="hljs-number">2</span><br>dtype: int64<br>b    <span class="hljs-number">3</span><br>d    <span class="hljs-number">4</span><br>e    <span class="hljs-number">5</span><br>dtype: int64<br>a    <span class="hljs-number">1</span><br>b    <span class="hljs-number">2</span><br>b    <span class="hljs-number">3</span><br>d    <span class="hljs-number">4</span><br>e    <span class="hljs-number">5</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>横向连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat([s1,s2],*axis*=<span class="hljs-number">1</span>)<br><br>---<br>	<span class="hljs-number">0</span>		<span class="hljs-number">1</span><br>a	<span class="hljs-number">1.0</span>	NaN<br>b	<span class="hljs-number">2.0</span>	<span class="hljs-number">3.0</span><br>d	NaN	<span class="hljs-number">4.0</span><br>e	NaN	<span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure>
<p>⽤内连接求交集(连接⽅式，共有’<code>inner</code>’,’<code>left</code>’,<code>right</code>’,’<code>outer</code>’)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat([s1,s2],axis=<span class="hljs-number">1</span>,join=<span class="hljs-string">&#x27;inner&#x27;</span>)<br><br>---<br>	<span class="hljs-number">0</span>	<span class="hljs-number">1</span><br>b	<span class="hljs-number">2</span>	<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>创建层次化索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat([s1,s2],keys=[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;B&#x27;</span>])<br><br>---<br>A  a    <span class="hljs-number">1</span><br>   b    <span class="hljs-number">2</span><br>B  b    <span class="hljs-number">3</span><br>   d    <span class="hljs-number">4</span><br>   e    <span class="hljs-number">5</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>当纵向连接时 keys 为列名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat([s1,s2],keys=[<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>],axis=<span class="hljs-number">1</span>)<br><br>----<br>	A		D<br>a	<span class="hljs-number">1.0</span>	NaN<br>b	<span class="hljs-number">2.0</span>	<span class="hljs-number">3.0</span><br>d	NaN	<span class="hljs-number">4.0</span><br>e	NaN	<span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure>
<p>DataFrame 对象的连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df3=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Red&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],<span class="hljs-string">&#x27;Green&#x27;</span>:[<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>]&#125;,index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;abd&#x27;</span>)) <br>df4=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Blue&#x27;</span>:[<span class="hljs-number">1</span>,<span class="hljs-number">9</span>],<span class="hljs-string">&#x27;Yellow&#x27;</span>:[<span class="hljs-number">6</span>,<span class="hljs-number">6</span>]&#125;,index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;ce&#x27;</span>))<br>pd.concat([df3,df4])<br><br>---<br><br>	Red	Green	Blue	Yellow<br>a	<span class="hljs-number">1.0</span>	<span class="hljs-number">5.0</span>		NaN		NaN<br>b	<span class="hljs-number">3.0</span>	<span class="hljs-number">0.0</span>		NaN		NaN<br>d	<span class="hljs-number">5.0</span>	<span class="hljs-number">3.0</span>		NaN		NaN<br>c	NaN	NaN		<span class="hljs-number">1.0</span>		<span class="hljs-number">6.0</span><br>e	NaN	NaN		<span class="hljs-number">9.0</span>		<span class="hljs-number">6.0</span><br></code></pre></td></tr></table></figure>
<p>⽤字典的⽅式连接同样可以创建层次化列索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.concat(&#123;<span class="hljs-string">&#x27;A&#x27;</span>:df3,<span class="hljs-string">&#x27;B&#x27;</span>:df4&#125;,axis=<span class="hljs-number">1</span>)<br><br>---<br>	A					B<br>	Red	Green	Blue	Yellow<br>a	<span class="hljs-number">1.0</span>	<span class="hljs-number">5.0</span>		NaN		NaN<br>b	<span class="hljs-number">3.0</span>	<span class="hljs-number">0.0</span>		NaN		NaN<br>d	<span class="hljs-number">5.0</span>	<span class="hljs-number">3.0</span>		NaN		NaN<br>c	NaN	NaN		<span class="hljs-number">1.0</span>		<span class="hljs-number">6.0</span><br>e	NaN	NaN		<span class="hljs-number">9.0</span>		<span class="hljs-number">6.0</span><br></code></pre></td></tr></table></figure>
<h3 id="多层索引拓展">多层索引（拓展）</h3>
<p>创建多层索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">s = Series(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,size=<span class="hljs-number">6</span>),index=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;abcdef&#x27;</span>))<br><span class="hljs-built_in">print</span>(s)<br><br>---<br>a     <span class="hljs-number">40</span><br>b    <span class="hljs-number">122</span><br>c     <span class="hljs-number">95</span><br>d     <span class="hljs-number">40</span><br>e     <span class="hljs-number">35</span><br>f     <span class="hljs-number">27</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">s = Series(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,size=<span class="hljs-number">6</span>),<br>index=[[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>],[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]]) <br><span class="hljs-built_in">print</span>(s)<br><br>---<br>a  期中    <span class="hljs-number">132</span><br>   期末    <span class="hljs-number">145</span><br>b  期中     <span class="hljs-number">33</span><br>   期末    <span class="hljs-number">149</span><br>c  期中     <span class="hljs-number">10</span><br>   期末    <span class="hljs-number">145</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>DataFrame 也可以创建多层索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># DataFrame 创建多层索引</span><br>df1 = df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,size=(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>)),<br>         columns = [<span class="hljs-string">&#x27;zs&#x27;</span>,<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-string">&#x27;ww&#x27;</span>,<span class="hljs-string">&#x27;zl&#x27;</span>],<br>         index =[[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>],[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]])<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>            zs   ls   ww   zl<br>python 期中  <span class="hljs-number">123</span>    <span class="hljs-number">3</span>   <span class="hljs-number">98</span>   <span class="hljs-number">95</span><br>       期末    <span class="hljs-number">9</span>   <span class="hljs-number">36</span>   <span class="hljs-number">15</span>  <span class="hljs-number">126</span><br>math   期中   <span class="hljs-number">86</span>   <span class="hljs-number">86</span>   <span class="hljs-number">73</span>  <span class="hljs-number">115</span><br>       期末    <span class="hljs-number">3</span>  <span class="hljs-number">130</span>   <span class="hljs-number">52</span>   <span class="hljs-number">89</span><br>En     期中   <span class="hljs-number">75</span>   <span class="hljs-number">21</span>   <span class="hljs-number">84</span>   <span class="hljs-number">98</span><br>       期末   <span class="hljs-number">56</span>   <span class="hljs-number">46</span>  <span class="hljs-number">111</span>  <span class="hljs-number">147</span><br></code></pre></td></tr></table></figure>
<p>特定结构</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">class1=[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>]<br>class2=[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]<br>m_index2=pd.MultiIndex.from_arrays([class1,class2])<br>df2=df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>)),index=m_index2) <br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>             <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>python 期中   <span class="hljs-number">94</span>   <span class="hljs-number">36</span>    <span class="hljs-number">6</span>   <span class="hljs-number">19</span><br>       期末   <span class="hljs-number">24</span>   <span class="hljs-number">41</span>  <span class="hljs-number">108</span>  <span class="hljs-number">120</span><br>math   期中   <span class="hljs-number">79</span>   <span class="hljs-number">69</span>  <span class="hljs-number">144</span>   <span class="hljs-number">32</span><br>       期末  <span class="hljs-number">138</span>  <span class="hljs-number">100</span>   <span class="hljs-number">42</span>   <span class="hljs-number">38</span><br>En     期中  <span class="hljs-number">110</span>   <span class="hljs-number">90</span>  <span class="hljs-number">123</span>   <span class="hljs-number">75</span><br>       期末   <span class="hljs-number">69</span>   <span class="hljs-number">59</span>   <span class="hljs-number">72</span>  <span class="hljs-number">109</span><br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">class1=[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]<br>class2=[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>,<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>]<br>m_index2=pd.MultiIndex.from_arrays([class1,class2])<br>df2=df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>)),index=m_index2) <br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>             <span class="hljs-number">0</span>   <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>期中 python   <span class="hljs-number">96</span>  <span class="hljs-number">15</span>  <span class="hljs-number">135</span>    <span class="hljs-number">5</span><br>   	math     <span class="hljs-number">66</span>  <span class="hljs-number">78</span>  <span class="hljs-number">143</span>   <span class="hljs-number">93</span><br>   	En       <span class="hljs-number">70</span>  <span class="hljs-number">27</span>  <span class="hljs-number">120</span>   <span class="hljs-number">63</span><br>期末 python  <span class="hljs-number">147</span>  <span class="hljs-number">77</span>   <span class="hljs-number">92</span>   <span class="hljs-number">97</span><br>   	math    <span class="hljs-number">121</span>  <span class="hljs-number">81</span>  <span class="hljs-number">137</span>  <span class="hljs-number">102</span><br>   	En       <span class="hljs-number">18</span>  <span class="hljs-number">12</span>  <span class="hljs-number">134</span>  <span class="hljs-number">113</span><br></code></pre></td></tr></table></figure>
<p>product 构造</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">class1=[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>]<br>class2=[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]<br>m_index2=pd.MultiIndex.from_product([class1,class2])<br>df2=df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>)),index=m_index2) <br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>             <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>python 期中   <span class="hljs-number">12</span>   <span class="hljs-number">72</span>  <span class="hljs-number">115</span>   <span class="hljs-number">59</span><br>       期末   <span class="hljs-number">36</span>   <span class="hljs-number">51</span>   <span class="hljs-number">94</span>  <span class="hljs-number">111</span><br>math   期中   <span class="hljs-number">44</span>   <span class="hljs-number">14</span>    <span class="hljs-number">9</span>   <span class="hljs-number">61</span><br>       期末  <span class="hljs-number">115</span>  <span class="hljs-number">121</span>   <span class="hljs-number">65</span>   <span class="hljs-number">93</span><br>En     期中   <span class="hljs-number">29</span>   <span class="hljs-number">23</span>   <span class="hljs-number">16</span>   <span class="hljs-number">70</span><br>       期末   <span class="hljs-number">30</span>   <span class="hljs-number">73</span>   <span class="hljs-number">77</span>   <span class="hljs-number">53</span><br></code></pre></td></tr></table></figure>
<p>多层索引对象的索引</p>
<p>让我们先来看看 Series 的操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">s = Series(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,size=<span class="hljs-number">6</span>),<br>index=[[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>],[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>,<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]])<br><span class="hljs-built_in">print</span>(s)<br><br>---<br>a  期中     <span class="hljs-number">31</span><br>   期末      <span class="hljs-number">4</span><br>b  期中    <span class="hljs-number">101</span><br>   期末     <span class="hljs-number">95</span><br>c  期中     <span class="hljs-number">54</span><br>   期末    <span class="hljs-number">126</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>取⼀个第⼀级索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(s[<span class="hljs-string">&#x27;a&#x27;</span>])<br><br>---<br>期中    <span class="hljs-number">31</span><br>期末     <span class="hljs-number">4</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>取多个第⼀级索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(s[[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>]])<br><br>---<br>a  期中     <span class="hljs-number">31</span><br>   期末      <span class="hljs-number">4</span><br>b  期中    <span class="hljs-number">101</span><br>   期末     <span class="hljs-number">95</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>根据索引获取值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(s[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>])<br><br>---<br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>
<p>loc⽅法取值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(s.loc[<span class="hljs-string">&#x27;a&#x27;</span>])<br><span class="hljs-built_in">print</span>(s.loc[[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>]]) <br><span class="hljs-built_in">print</span>(s.loc[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>])<br><br>---<br>期中    <span class="hljs-number">31</span><br>期末     <span class="hljs-number">4</span><br>dtype: int64<br>a  期中     <span class="hljs-number">31</span><br>   期末      <span class="hljs-number">4</span><br>b  期中    <span class="hljs-number">101</span><br>   期末     <span class="hljs-number">95</span><br>dtype: int64<br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>
<p>iloc⽅法取值(iloc 计算的事最内层索引)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(s.iloc[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(s.iloc[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>])<br><br>---<br><span class="hljs-number">4</span><br>a  期末      <span class="hljs-number">4</span><br>b  期中    <span class="hljs-number">101</span><br>   期末     <span class="hljs-number">95</span><br>dtype: int64<br></code></pre></td></tr></table></figure>
<p>然后再让我们来看看 DataFrame 的操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># dataframe</span><br>class1=[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>,<span class="hljs-string">&#x27;En&#x27;</span>]<br>class2=[<span class="hljs-string">&#x27;期中&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>]<br>m_index2=pd.MultiIndex.from_product([class1,class2])<br>df2=df(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">150</span>,(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>)),index=m_index2) <br><span class="hljs-built_in">print</span>(df2)<br><br>---<br>             <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>python 期中   <span class="hljs-number">88</span>   <span class="hljs-number">69</span>   <span class="hljs-number">82</span>   <span class="hljs-number">28</span><br>       期末  <span class="hljs-number">110</span>   <span class="hljs-number">60</span>  <span class="hljs-number">130</span>  <span class="hljs-number">133</span><br>math   期中   <span class="hljs-number">64</span>  <span class="hljs-number">103</span>   <span class="hljs-number">24</span>   <span class="hljs-number">49</span><br>       期末   <span class="hljs-number">23</span>   <span class="hljs-number">41</span>   <span class="hljs-number">10</span>   <span class="hljs-number">61</span><br>En     期中  <span class="hljs-number">124</span>  <span class="hljs-number">139</span>   <span class="hljs-number">65</span>  <span class="hljs-number">115</span><br>       期末  <span class="hljs-number">114</span>   <span class="hljs-number">13</span>  <span class="hljs-number">117</span>   <span class="hljs-number">79</span><br></code></pre></td></tr></table></figure>
<p>获取列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2[<span class="hljs-number">0</span>])<br><br>---<br>python  期中     <span class="hljs-number">88</span><br>        期末    <span class="hljs-number">110</span><br>math    期中     <span class="hljs-number">64</span><br>        期末     <span class="hljs-number">23</span><br>En      期中    <span class="hljs-number">124</span><br>        期末    <span class="hljs-number">114</span><br>Name: <span class="hljs-number">0</span>, dtype: int64<br></code></pre></td></tr></table></figure>
<p>⼀级索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.loc[<span class="hljs-string">&#x27;python&#x27;</span>])<br><br>---<br>      <span class="hljs-number">0</span>   <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>期中   <span class="hljs-number">88</span>  <span class="hljs-number">69</span>   <span class="hljs-number">82</span>   <span class="hljs-number">28</span><br>期末  <span class="hljs-number">110</span>  <span class="hljs-number">60</span>  <span class="hljs-number">130</span>  <span class="hljs-number">133</span><br><br></code></pre></td></tr></table></figure>
<p>多个⼀级索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.loc[[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;math&#x27;</span>]])<br><br>---<br>             <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">3</span><br>python 期中   <span class="hljs-number">88</span>   <span class="hljs-number">69</span>   <span class="hljs-number">82</span>   <span class="hljs-number">28</span><br>       期末  <span class="hljs-number">110</span>   <span class="hljs-number">60</span>  <span class="hljs-number">130</span>  <span class="hljs-number">133</span><br>math   期中   <span class="hljs-number">64</span>  <span class="hljs-number">103</span>   <span class="hljs-number">24</span>   <span class="hljs-number">49</span><br>       期末   <span class="hljs-number">23</span>   <span class="hljs-number">41</span>   <span class="hljs-number">10</span>   <span class="hljs-number">61</span><br></code></pre></td></tr></table></figure>
<p>取⼀⾏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.loc[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>])<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">110</span><br><span class="hljs-number">1</span>     <span class="hljs-number">60</span><br><span class="hljs-number">2</span>    <span class="hljs-number">130</span><br><span class="hljs-number">3</span>    <span class="hljs-number">133</span><br>Name: (python, 期末), dtype: int64<br></code></pre></td></tr></table></figure>
<p>取⼀值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.loc[<span class="hljs-string">&#x27;python&#x27;</span>,<span class="hljs-string">&#x27;期末&#x27;</span>][<span class="hljs-number">0</span>])<br><br>---<br><span class="hljs-number">110</span><br></code></pre></td></tr></table></figure>
<p>iloc 是只取最内层的索引的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df2.iloc[<span class="hljs-number">0</span>])<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">88</span><br><span class="hljs-number">1</span>    <span class="hljs-number">69</span><br><span class="hljs-number">2</span>    <span class="hljs-number">82</span><br><span class="hljs-number">3</span>    <span class="hljs-number">28</span><br>Name: (python, 期中), dtype: int64<br></code></pre></td></tr></table></figure>
<h3 id="时间序列">时间序列</h3>
<p>⽣成⼀段时间范围</p>
<p>该函数主要⽤于⽣成⼀个固定频率的时间索引，在调⽤构造⽅法时，必须指定<code>start</code>、<code>end</code>、<code>periods</code>中的两个参数值，否则报错。</p>
<table>
<thead>
<tr class="header">
<th>时间序列频率</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>⽇历⽇的每天</td>
</tr>
<tr class="even">
<td>B</td>
<td>⼯作⽇的每天</td>
</tr>
<tr class="odd">
<td>H</td>
<td>每⼩时</td>
</tr>
<tr class="even">
<td>T 或 min</td>
<td>每分钟</td>
</tr>
<tr class="odd">
<td>S</td>
<td>每秒</td>
</tr>
<tr class="even">
<td>L 或 ms</td>
<td>每毫秒</td>
</tr>
<tr class="odd">
<td>U</td>
<td>每微秒</td>
</tr>
<tr class="even">
<td>M</td>
<td>⽇历⽇的⽉底⽇期</td>
</tr>
<tr class="odd">
<td>BM</td>
<td>⼯作⽇的⽉底⽇期</td>
</tr>
<tr class="even">
<td>MS</td>
<td>⽇历⽇的⽉初⽇期</td>
</tr>
<tr class="odd">
<td>BMS</td>
<td>⼯作⽇的⽉初⽇期</td>
</tr>
</tbody>
</table>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">date = pd.date_range(start=<span class="hljs-string">&#x27;20190501&#x27;</span>,end=<span class="hljs-string">&#x27;20190530&#x27;</span>)<br><span class="hljs-built_in">print</span>(date)<br><br>---<br>DatetimeIndex([<span class="hljs-string">&#x27;2023-05-01&#x27;</span>, <span class="hljs-string">&#x27;2023-05-02&#x27;</span>, <span class="hljs-string">&#x27;2023-05-03&#x27;</span>, <span class="hljs-string">&#x27;2023-05-04&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-05&#x27;</span>, <span class="hljs-string">&#x27;2023-05-06&#x27;</span>, <span class="hljs-string">&#x27;2023-05-07&#x27;</span>, <span class="hljs-string">&#x27;2023-05-08&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-09&#x27;</span>, <span class="hljs-string">&#x27;2023-05-10&#x27;</span>, <span class="hljs-string">&#x27;2023-05-11&#x27;</span>, <span class="hljs-string">&#x27;2023-05-12&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-13&#x27;</span>, <span class="hljs-string">&#x27;2023-05-14&#x27;</span>, <span class="hljs-string">&#x27;2023-05-15&#x27;</span>, <span class="hljs-string">&#x27;2023-05-16&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-17&#x27;</span>, <span class="hljs-string">&#x27;2023-05-18&#x27;</span>, <span class="hljs-string">&#x27;2023-05-19&#x27;</span>, <span class="hljs-string">&#x27;2023-05-20&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-21&#x27;</span>, <span class="hljs-string">&#x27;2023-05-22&#x27;</span>, <span class="hljs-string">&#x27;2023-05-23&#x27;</span>, <span class="hljs-string">&#x27;2023-05-24&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-25&#x27;</span>, <span class="hljs-string">&#x27;2023-05-26&#x27;</span>, <span class="hljs-string">&#x27;2023-05-27&#x27;</span>, <span class="hljs-string">&#x27;2023-05-28&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-05-29&#x27;</span>, <span class="hljs-string">&#x27;2023-05-30&#x27;</span>],<br>              dtype=<span class="hljs-string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="hljs-string">&#x27;D&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<p><code>req</code>：⽇期偏移量，取值为 string, 默认为'D'，</p>
<p><code>periods</code>：固定时期，取值为整数或 None</p>
<p><code>freq</code>: 时间序列频率</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">date = pd.date_range(start=<span class="hljs-string">&#x27;20230501&#x27;</span>,periods=<span class="hljs-number">10</span>,freq=<span class="hljs-string">&#x27;10D&#x27;</span>)<br><span class="hljs-built_in">print</span>(date)<br><br>---<br>DatetimeIndex([<span class="hljs-string">&#x27;2023-05-01&#x27;</span>, <span class="hljs-string">&#x27;2023-05-11&#x27;</span>, <span class="hljs-string">&#x27;2023-05-21&#x27;</span>, <span class="hljs-string">&#x27;2023-05-31&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-06-10&#x27;</span>, <span class="hljs-string">&#x27;2023-06-20&#x27;</span>, <span class="hljs-string">&#x27;2023-06-30&#x27;</span>, <span class="hljs-string">&#x27;2023-07-10&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-07-20&#x27;</span>, <span class="hljs-string">&#x27;2023-07-30&#x27;</span>],<br>              dtype=<span class="hljs-string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="hljs-string">&#x27;10D&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>根据<code>closed</code>参数选择是否包含开始和结束时间<code>closed=None</code>，left
包含开始时间，不包含结束时间， right 与之相反。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">data_time =pd.date_range(start=<span class="hljs-string">&#x27;2023-08-09&#x27;</span>,end=<span class="hljs-string">&#x27;2023-08-14&#x27;</span>,closed=<span class="hljs-string">&#x27;left&#x27;</span>) <br><span class="hljs-built_in">print</span>(data_time)<br><br>---<br>DatetimeIndex([<span class="hljs-string">&#x27;2023-08-09&#x27;</span>, <span class="hljs-string">&#x27;2023-08-10&#x27;</span>, <span class="hljs-string">&#x27;2023-08-11&#x27;</span>, <span class="hljs-string">&#x27;2023-08-12&#x27;</span>,<br>               <span class="hljs-string">&#x27;2023-08-13&#x27;</span>],<br>              dtype=<span class="hljs-string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="hljs-string">&#x27;D&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>时间序列在 dataFrame 中的作⽤</p>
<p>可以将时间作为索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">index = pd.date_range(start=<span class="hljs-string">&#x27;20230801&#x27;</span>,periods=<span class="hljs-number">10</span>)<br>df = pd.Series(np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,size = <span class="hljs-number">10</span>),index=index) <br><span class="hljs-built_in">print</span>(df)<br><br>---<br><span class="hljs-number">2023</span>-08-01    <span class="hljs-number">7</span><br><span class="hljs-number">2023</span>-08-02    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-03    <span class="hljs-number">5</span><br><span class="hljs-number">2023</span>-08-04    <span class="hljs-number">5</span><br><span class="hljs-number">2023</span>-08-05    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-06    <span class="hljs-number">0</span><br><span class="hljs-number">2023</span>-08-07    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-08    <span class="hljs-number">3</span><br><span class="hljs-number">2023</span>-08-09    <span class="hljs-number">6</span><br><span class="hljs-number">2023</span>-08-<span class="hljs-number">10</span>    <span class="hljs-number">5</span><br>Freq: D, dtype: int64<br></code></pre></td></tr></table></figure>
<p><code>truncate</code>这个函数将 before
指定⽇期之前的值全部过滤出去,after 指定⽇期之前的值全部过滤出去.</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">after = df.truncate(after=<span class="hljs-string">&#x27;2023-08-8&#x27;</span>)<br><span class="hljs-built_in">print</span>(after)<br><br>---<br><span class="hljs-number">2023</span>-08-01    <span class="hljs-number">7</span><br><span class="hljs-number">2023</span>-08-02    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-03    <span class="hljs-number">5</span><br><span class="hljs-number">2023</span>-08-04    <span class="hljs-number">5</span><br><span class="hljs-number">2023</span>-08-05    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-06    <span class="hljs-number">0</span><br><span class="hljs-number">2023</span>-08-07    <span class="hljs-number">2</span><br><span class="hljs-number">2023</span>-08-08    <span class="hljs-number">3</span><br>Freq: D, dtype: int64<br></code></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">long_ts = pd.Series(np.random.randn(<span class="hljs-number">1000</span>),index=pd.date_range(<span class="hljs-string">&#x27;1/1/2021&#x27;</span>,periods=<span class="hljs-number">1000</span>)) <br><span class="hljs-built_in">print</span>(long_ts)<br><br>---<br><span class="hljs-number">2021</span>-01-01   -<span class="hljs-number">0.482811</span><br>...<br><span class="hljs-number">2023</span>-09-<span class="hljs-number">27</span>   -<span class="hljs-number">0.108047</span><br>Freq: D, Length: <span class="hljs-number">1000</span>, dtype: float64<br></code></pre></td></tr></table></figure>
<p>根据年份获取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">result = long_ts[<span class="hljs-string">&#x27;2022&#x27;</span>]<br><span class="hljs-built_in">print</span>(result)<br><br>---<br><span class="hljs-number">2022</span>-01-01   -<span class="hljs-number">0.600007</span><br>...<br><span class="hljs-number">2022</span>-<span class="hljs-number">12</span>-<span class="hljs-number">31</span>    <span class="hljs-number">0.097874</span><br>Freq: D, Length: <span class="hljs-number">365</span>, dtype: float64<br></code></pre></td></tr></table></figure>
<p>年份和⽇期获取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">result = long_ts[<span class="hljs-string">&#x27;2023-07&#x27;</span>] <br><span class="hljs-built_in">print</span>(result)<br><br>---<br><span class="hljs-number">2023</span>-07-01   -<span class="hljs-number">1.797582</span><br>...<br><span class="hljs-number">2023</span>-07-<span class="hljs-number">31</span>    <span class="hljs-number">0.687787</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure>
<p>使⽤切⽚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使⽤切⽚</span><br>result = long_ts[<span class="hljs-string">&#x27;2023-05-01&#x27;</span>:<span class="hljs-string">&#x27;2023-05-06&#x27;</span>]<br><span class="hljs-built_in">print</span>(result)<br><br>---<br><span class="hljs-number">2023</span>-05-01   -<span class="hljs-number">2.338218</span><br><span class="hljs-number">2023</span>-05-02   -<span class="hljs-number">2.130780</span><br><span class="hljs-number">2023</span>-05-03    <span class="hljs-number">0.582920</span><br><span class="hljs-number">2023</span>-05-04   -<span class="hljs-number">0.182540</span><br><span class="hljs-number">2023</span>-05-05    <span class="hljs-number">0.127363</span><br><span class="hljs-number">2023</span>-05-06   -<span class="hljs-number">0.032844</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure>
<p>通过<code>between_time()</code>返回位于指定时间段的数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">index=pd.date_range(<span class="hljs-string">&quot;2023-03-17&quot;</span>,<span class="hljs-string">&quot;2023-03-30&quot;</span>,freq=<span class="hljs-string">&quot;2H&quot;</span>)<br>ts = pd.Series(np.random.randn(<span class="hljs-number">157</span>),index=index) <br><span class="hljs-built_in">print</span>(ts.between_time(<span class="hljs-string">&quot;7:00&quot;</span>,<span class="hljs-string">&quot;17:00&quot;</span>))<br><br>---<br><span class="hljs-number">2023</span>-03-<span class="hljs-number">17</span> 08:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>   -<span class="hljs-number">0.532254</span><br>...<br><span class="hljs-number">2023</span>-03-<span class="hljs-number">29</span> <span class="hljs-number">16</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <span class="hljs-number">0.437697</span><br>Length: <span class="hljs-number">65</span>, dtype: float64<br></code></pre></td></tr></table></figure>
<p>这些操作也都适⽤于 dataframe</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">index=pd.date_range(<span class="hljs-string">&#x27;1/1/2023&#x27;</span>,periods=<span class="hljs-number">100</span>)<br>df = pd.DataFrame(np.random.randn(<span class="hljs-number">100</span>,<span class="hljs-number">4</span>),index=index) <br><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;2023-04&#x27;</span>])<br><br>---<br>                   <span class="hljs-number">0</span>         <span class="hljs-number">1</span>         <span class="hljs-number">2</span>         <span class="hljs-number">3</span><br><span class="hljs-number">2023</span>-04-01 -<span class="hljs-number">0.220090</span>  <span class="hljs-number">0.335770</span> -<span class="hljs-number">0.086181</span> -<span class="hljs-number">0.046045</span><br><span class="hljs-number">2023</span>-04-02 -<span class="hljs-number">1.046423</span> -<span class="hljs-number">0.347116</span>  <span class="hljs-number">0.367099</span> -<span class="hljs-number">0.979354</span><br><span class="hljs-number">2023</span>-04-03 -<span class="hljs-number">0.720944</span> -<span class="hljs-number">1.478932</span>  <span class="hljs-number">0.220948</span>  <span class="hljs-number">0.801831</span><br><span class="hljs-number">2023</span>-04-04  <span class="hljs-number">1.359946</span> -<span class="hljs-number">1.239004</span>  <span class="hljs-number">0.309747</span> -<span class="hljs-number">0.047959</span><br><span class="hljs-number">2023</span>-04-05 -<span class="hljs-number">0.256502</span>  <span class="hljs-number">2.224782</span>  <span class="hljs-number">0.494740</span> -<span class="hljs-number">1.322490</span><br><span class="hljs-number">2023</span>-04-06  <span class="hljs-number">1.488119</span>  <span class="hljs-number">0.244942</span>  <span class="hljs-number">0.614101</span> -<span class="hljs-number">0.156201</span><br><span class="hljs-number">2023</span>-04-07 -<span class="hljs-number">1.815019</span> -<span class="hljs-number">1.935966</span>  <span class="hljs-number">0.239024</span> -<span class="hljs-number">1.388502</span><br><span class="hljs-number">2023</span>-04-08  <span class="hljs-number">1.106623</span>  <span class="hljs-number">1.148805</span>  <span class="hljs-number">2.120405</span> -<span class="hljs-number">0.799290</span><br><span class="hljs-number">2023</span>-04-09 -<span class="hljs-number">1.902216</span>  <span class="hljs-number">0.625965</span> -<span class="hljs-number">0.102506</span> -<span class="hljs-number">0.430550</span><br><span class="hljs-number">2023</span>-04-<span class="hljs-number">10</span> -<span class="hljs-number">0.876382</span> -<span class="hljs-number">2.034205</span> -<span class="hljs-number">0.060846</span>  <span class="hljs-number">2.442651</span><br></code></pre></td></tr></table></figure>
<p>移位⽇期</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">ts = pd.Series(np.random.randn(<span class="hljs-number">10</span>),index=pd.date_range(<span class="hljs-string">&#x27;1/1/2023&#x27;</span>,periods=<span class="hljs-number">10</span>)) <br><span class="hljs-built_in">print</span>(ts)<br><br>---<br><span class="hljs-number">2023</span>-01-01   -<span class="hljs-number">0.976958</span><br><span class="hljs-number">2023</span>-01-02   -<span class="hljs-number">0.487439</span><br><span class="hljs-number">2023</span>-01-03    <span class="hljs-number">0.143104</span><br><span class="hljs-number">2023</span>-01-04   -<span class="hljs-number">0.964236</span><br><span class="hljs-number">2023</span>-01-05    <span class="hljs-number">0.758326</span><br><span class="hljs-number">2023</span>-01-06   -<span class="hljs-number">1.650818</span><br><span class="hljs-number">2023</span>-01-07    <span class="hljs-number">0.709231</span><br><span class="hljs-number">2023</span>-01-08    <span class="hljs-number">0.198714</span><br><span class="hljs-number">2023</span>-01-09   -<span class="hljs-number">1.043443</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">10</span>    <span class="hljs-number">0.220834</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure>
<p>移动数据，索引不变，默认由<code>NaN</code>填充</p>
<p><code>periods</code>: 移动的位数 负数是向上移动</p>
<p><code>fill_value</code>: 移动后填充数据</p>
<p><code>freq</code>： ⽇期偏移量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">ts.shift(periods=<span class="hljs-number">2</span>,fill_value=<span class="hljs-number">100</span>, freq=<span class="hljs-string">&#x27;D&#x27;</span>)<br><br>---<br><span class="hljs-number">2023</span>-01-03   -<span class="hljs-number">0.976958</span><br><span class="hljs-number">2023</span>-01-04   -<span class="hljs-number">0.487439</span><br><span class="hljs-number">2023</span>-01-05    <span class="hljs-number">0.143104</span><br><span class="hljs-number">2023</span>-01-06   -<span class="hljs-number">0.964236</span><br><span class="hljs-number">2023</span>-01-07    <span class="hljs-number">0.758326</span><br><span class="hljs-number">2023</span>-01-08   -<span class="hljs-number">1.650818</span><br><span class="hljs-number">2023</span>-01-09    <span class="hljs-number">0.709231</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">10</span>    <span class="hljs-number">0.198714</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">11</span>   -<span class="hljs-number">1.043443</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">12</span>    <span class="hljs-number">0.220834</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure>
<p>通过<code>tshift()</code>将索引移动指定的时间：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">ts.tshift(<span class="hljs-number">2</span>)<br><br>---<br><span class="hljs-number">2023</span>-01-03   -<span class="hljs-number">0.976958</span><br><span class="hljs-number">2023</span>-01-04   -<span class="hljs-number">0.487439</span><br><span class="hljs-number">2023</span>-01-05    <span class="hljs-number">0.143104</span><br><span class="hljs-number">2023</span>-01-06   -<span class="hljs-number">0.964236</span><br><span class="hljs-number">2023</span>-01-07    <span class="hljs-number">0.758326</span><br><span class="hljs-number">2023</span>-01-08   -<span class="hljs-number">1.650818</span><br><span class="hljs-number">2023</span>-01-09    <span class="hljs-number">0.709231</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">10</span>    <span class="hljs-number">0.198714</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">11</span>   -<span class="hljs-number">1.043443</span><br><span class="hljs-number">2023</span>-01-<span class="hljs-number">12</span>    <span class="hljs-number">0.220834</span><br>Freq: D, dtype: float64<br></code></pre></td></tr></table></figure>
<p>将时间戳转化成时间根式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.to_datetime(<span class="hljs-number">1688570740000</span>,unit=<span class="hljs-string">&#x27;ms&#x27;</span>)<br><br>---<br>Timestamp(<span class="hljs-string">&#x27;2023-07-05 15:25:40&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>utc 是协调世界时,时区是以 UTC
的偏移量的形式表示的,但是注意设置<code>utc=True</code>,是让 pandas
对象具有时区性质,对于⼀列进⾏转换的,会造成转换错误。</p>
<p><code>unit='ms'</code>设置粒度是到毫秒级别的。</p>
<p>时区名字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pytz<br><span class="hljs-built_in">print</span>(pytz.common_timezones)<br><br>---<br>[<span class="hljs-string">&#x27;Africa/Abidjan&#x27;</span>, ..., <span class="hljs-string">&#x27;US/Pacific&#x27;</span>, <span class="hljs-string">&#x27;UTC&#x27;</span>]<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.to_datetime(<span class="hljs-number">1688570740000</span>,unit=<span class="hljs-string">&#x27;ms&#x27;</span>).tz_localize(<span class="hljs-string">&#x27;UTC&#x27;</span>).tz_convert(<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>)<br><br>---<br>Timestamp(<span class="hljs-string">&#x27;2023-07-05 23:25:40+0800&#x27;</span>, tz=<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>一个处理的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">df = pd.DataFrame([<span class="hljs-number">1688570740000</span>, <span class="hljs-number">1688570800000</span>, <span class="hljs-number">1688570860000</span>],columns = [<span class="hljs-string">&#x27;time_stamp&#x27;</span>])<br>pd.to_datetime(df[<span class="hljs-string">&#x27;time_stamp&#x27;</span>],unit=<span class="hljs-string">&#x27;ms&#x27;</span>).dt.tz_localize(<span class="hljs-string">&#x27;UTC&#x27;</span>).dt.tz_convert (<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>)<br><br>---<br><span class="hljs-number">0</span>   <span class="hljs-number">2023</span>-07-05 <span class="hljs-number">23</span>:<span class="hljs-number">25</span>:<span class="hljs-number">40</span>+08:<span class="hljs-number">00</span><br><span class="hljs-number">1</span>   <span class="hljs-number">2023</span>-07-05 <span class="hljs-number">23</span>:<span class="hljs-number">26</span>:<span class="hljs-number">40</span>+08:<span class="hljs-number">00</span><br><span class="hljs-number">2</span>   <span class="hljs-number">2023</span>-07-05 <span class="hljs-number">23</span>:<span class="hljs-number">27</span>:<span class="hljs-number">40</span>+08:<span class="hljs-number">00</span><br>Name: time_stamp, dtype: datetime64[ns, Asia/Shanghai]<br></code></pre></td></tr></table></figure>
<p>先赋予标准时区,再转换到东⼋区。</p>
<p>处理中⽂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.to_datetime(<span class="hljs-string">&#x27;2023 年 7⽉5⽇&#x27;</span>,<span class="hljs-built_in">format</span>=<span class="hljs-string">&#x27;%Y 年%m⽉%d⽇&#x27;</span>)<br><br>---<br>Timestamp(<span class="hljs-string">&#x27;2023-07-05 00:00:00&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="分组聚合">分组聚合</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">df=pd.DataFrame(&#123;<br><span class="hljs-string">&#x27;name&#x27;</span>:[<span class="hljs-string">&#x27;BOSS&#x27;</span>,<span class="hljs-string">&#x27;Lilei&#x27;</span>,<span class="hljs-string">&#x27;Lilei&#x27;</span>,<span class="hljs-string">&#x27;Han&#x27;</span>,<span class="hljs-string">&#x27;BOSS&#x27;</span>,<span class="hljs-string">&#x27;BOSS&#x27;</span>,<span class="hljs-string">&#x27;Han&#x27;</span>,<span class="hljs-string">&#x27;BOSS&#x27;</span>], <span class="hljs-string">&#x27;Year&#x27;</span>:[<span class="hljs-number">2016</span>,<span class="hljs-number">2016</span>,<span class="hljs-number">2016</span>,<span class="hljs-number">2016</span>,<span class="hljs-number">2017</span>,<span class="hljs-number">2017</span>,<span class="hljs-number">2017</span>,<span class="hljs-number">2017</span>],<br><span class="hljs-string">&#x27;Salary&#x27;</span>:[<span class="hljs-number">999999</span>,<span class="hljs-number">20000</span>,<span class="hljs-number">25000</span>,<span class="hljs-number">3000</span>,<span class="hljs-number">9999999</span>,<span class="hljs-number">999999</span>,<span class="hljs-number">3500</span>,<span class="hljs-number">999999</span>],<br><span class="hljs-string">&#x27;Bonus&#x27;</span>:[<span class="hljs-number">100000</span>,<span class="hljs-number">20000</span>,<span class="hljs-number">20000</span>,<span class="hljs-number">5000</span>,<span class="hljs-number">200000</span>,<span class="hljs-number">300000</span>,<span class="hljs-number">3000</span>,<span class="hljs-number">400000</span>]<br>&#125;)<br>df<br><br>---<br><br>	name	Year	Salary	Bonus<br><span class="hljs-number">0</span>	BOSS	<span class="hljs-number">2016</span>	<span class="hljs-number">999999</span>	<span class="hljs-number">100000</span><br><span class="hljs-number">1</span>	Lilei	<span class="hljs-number">2016</span>	<span class="hljs-number">20000</span>		<span class="hljs-number">20000</span><br><span class="hljs-number">2</span>	Lilei	<span class="hljs-number">2016</span>	<span class="hljs-number">25000</span>		<span class="hljs-number">20000</span><br><span class="hljs-number">3</span>	Han		<span class="hljs-number">2016</span>	<span class="hljs-number">3000</span>		<span class="hljs-number">5000</span><br><span class="hljs-number">4</span>	BOSS	<span class="hljs-number">2017</span>	<span class="hljs-number">9999999</span>	<span class="hljs-number">200000</span><br><span class="hljs-number">5</span>	BOSS	<span class="hljs-number">2017</span>	<span class="hljs-number">999999</span>	<span class="hljs-number">300000</span><br><span class="hljs-number">6</span>	Han		<span class="hljs-number">2017</span>	<span class="hljs-number">3500</span>		<span class="hljs-number">3000</span><br><span class="hljs-number">7</span>	BOSS	<span class="hljs-number">2017</span>	<span class="hljs-number">999999</span>	<span class="hljs-number">400000</span><br></code></pre></td></tr></table></figure>
<p>根据 name 这⼀列进⾏分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">group_by_name=df.groupby(<span class="hljs-string">&#x27;name&#x27;</span>) <br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(group_by_name))<br><br>---<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pandas.core.groupby.generic.DataFrameGroupBy&#x27;</span>&gt;<br></code></pre></td></tr></table></figure>
<p>查看分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(group_by_name.groups) <span class="hljs-comment"># 分组后的数量</span><br><span class="hljs-built_in">print</span>(group_by_name.count())<br><br>---<br>&#123;<span class="hljs-string">&#x27;BOSS&#x27;</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>], <span class="hljs-string">&#x27;Han&#x27;</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>], <span class="hljs-string">&#x27;Lilei&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]&#125;<br>       Year  Salary  Bonus<br>name                      <br>BOSS      <span class="hljs-number">4</span>       <span class="hljs-number">4</span>      <span class="hljs-number">4</span><br>Han       <span class="hljs-number">2</span>       <span class="hljs-number">2</span>      <span class="hljs-number">2</span><br>Lilei     <span class="hljs-number">2</span>       <span class="hljs-number">2</span>      <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>查看分组的情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> name,group <span class="hljs-keyword">in</span> group_by_name: <br>    <span class="hljs-built_in">print</span>(name)<br>    <br>---<br>BOSS<br>Han<br>Lilei<br></code></pre></td></tr></table></figure>
<p>组的名字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(group) <span class="hljs-comment"># 组具体内容</span><br><br>---<br>    name  Year  Salary  Bonus<br><span class="hljs-number">1</span>  Lilei  <span class="hljs-number">2016</span>   <span class="hljs-number">20000</span>  <span class="hljs-number">20000</span><br><span class="hljs-number">2</span>  Lilei  <span class="hljs-number">2016</span>   <span class="hljs-number">25000</span>  <span class="hljs-number">20000</span><br></code></pre></td></tr></table></figure>
<p>可以选择分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(group_by_name.get_group(<span class="hljs-string">&#x27;BOSS&#x27;</span>))<br><br>---<br>   name  Year   Salary   Bonus<br><span class="hljs-number">0</span>  BOSS  <span class="hljs-number">2016</span>   <span class="hljs-number">999999</span>  <span class="hljs-number">100000</span><br><span class="hljs-number">4</span>  BOSS  <span class="hljs-number">2017</span>  <span class="hljs-number">9999999</span>  <span class="hljs-number">200000</span><br><span class="hljs-number">5</span>  BOSS  <span class="hljs-number">2017</span>   <span class="hljs-number">999999</span>  <span class="hljs-number">300000</span><br><span class="hljs-number">7</span>  BOSS  <span class="hljs-number">2017</span>   <span class="hljs-number">999999</span>  <span class="hljs-number">400000</span><br></code></pre></td></tr></table></figure>
<p>按照某⼀列进⾏分组, 将 name 这⼀列作为分组的键，对 year 进⾏分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">group_by_name=df[<span class="hljs-string">&#x27;Year&#x27;</span>].groupby(df[<span class="hljs-string">&#x27;name&#x27;</span>])<br><span class="hljs-built_in">print</span>(group_by_name.count())<br><br>---<br>name<br>BOSS     <span class="hljs-number">4</span><br>Han      <span class="hljs-number">2</span><br>Lilei    <span class="hljs-number">2</span><br>Name: Year, dtype: int64<br></code></pre></td></tr></table></figure>
<p>按照多列进⾏分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">group_by_name_year=df.groupby([<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;Year&#x27;</span>])<br><span class="hljs-keyword">for</span> name,group <span class="hljs-keyword">in</span> group_by_name_year: <br>    <span class="hljs-built_in">print</span>(name) <span class="hljs-comment"># 组的名字</span><br>    <span class="hljs-built_in">print</span>(group) <span class="hljs-comment"># 组具体内容</span><br>    <br>---<br>(<span class="hljs-string">&#x27;BOSS&#x27;</span>, <span class="hljs-number">2016</span>)<br>   name  Year  Salary   Bonus<br><span class="hljs-number">0</span>  BOSS  <span class="hljs-number">2016</span>  <span class="hljs-number">999999</span>  <span class="hljs-number">100000</span><br>(<span class="hljs-string">&#x27;BOSS&#x27;</span>, <span class="hljs-number">2017</span>)<br>   name  Year   Salary   Bonus<br><span class="hljs-number">4</span>  BOSS  <span class="hljs-number">2017</span>  <span class="hljs-number">9999999</span>  <span class="hljs-number">200000</span><br><span class="hljs-number">5</span>  BOSS  <span class="hljs-number">2017</span>   <span class="hljs-number">999999</span>  <span class="hljs-number">300000</span><br><span class="hljs-number">7</span>  BOSS  <span class="hljs-number">2017</span>   <span class="hljs-number">999999</span>  <span class="hljs-number">400000</span><br>(<span class="hljs-string">&#x27;Han&#x27;</span>, <span class="hljs-number">2016</span>)<br>  name  Year  Salary  Bonus<br><span class="hljs-number">3</span>  Han  <span class="hljs-number">2016</span>    <span class="hljs-number">3000</span>   <span class="hljs-number">5000</span><br>(<span class="hljs-string">&#x27;Han&#x27;</span>, <span class="hljs-number">2017</span>)<br>  name  Year  Salary  Bonus<br><span class="hljs-number">6</span>  Han  <span class="hljs-number">2017</span>    <span class="hljs-number">3500</span>   <span class="hljs-number">3000</span><br>(<span class="hljs-string">&#x27;Lilei&#x27;</span>, <span class="hljs-number">2016</span>)<br>    name  Year  Salary  Bonus<br><span class="hljs-number">1</span>  Lilei  <span class="hljs-number">2016</span>   <span class="hljs-number">20000</span>  <span class="hljs-number">20000</span><br><span class="hljs-number">2</span>  Lilei  <span class="hljs-number">2016</span>   <span class="hljs-number">25000</span>  <span class="hljs-number">20000</span><br></code></pre></td></tr></table></figure>
<p>可以选择分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(group_by_name_year.get_group((<span class="hljs-string">&#x27;BOSS&#x27;</span>,<span class="hljs-number">2016</span>)))<br><br>---<br>   name  Year  Salary   Bonus<br><span class="hljs-number">0</span>  BOSS  <span class="hljs-number">2016</span>  <span class="hljs-number">999999</span>  <span class="hljs-number">100000</span><br></code></pre></td></tr></table></figure>
<p>将某列数据按数据值分成不同范围段进⾏分组（groupby）运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df = pd.DataFrame(&#123;<span class="hljs-string">&#x27;Age&#x27;</span>: np.random.randint(<span class="hljs-number">20</span>, <span class="hljs-number">70</span>, <span class="hljs-number">100</span>),<br> <span class="hljs-string">&#x27;Sex&#x27;</span>: np.random.choice([<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>], <span class="hljs-number">100</span>),<br> &#125;)<br>age_groups = pd.cut(df[<span class="hljs-string">&#x27;Age&#x27;</span>], bins=[<span class="hljs-number">19</span>,<span class="hljs-number">40</span>,<span class="hljs-number">65</span>,<span class="hljs-number">100</span>])<br><span class="hljs-built_in">print</span>(df.groupby(age_groups).count())<br><br>---<br>           Age  Sex<br>Age                <br>(<span class="hljs-number">19</span>, <span class="hljs-number">40</span>]    <span class="hljs-number">35</span>   <span class="hljs-number">35</span><br>(<span class="hljs-number">40</span>, <span class="hljs-number">65</span>]    <span class="hljs-number">54</span>   <span class="hljs-number">54</span><br>(<span class="hljs-number">65</span>, <span class="hljs-number">100</span>]   <span class="hljs-number">11</span>   <span class="hljs-number">11</span><br></code></pre></td></tr></table></figure>
<p>按‘Age’分组范围和性别（sex）进⾏制作交叉表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">pd.crosstab(age_groups, df[<span class="hljs-string">&#x27;Sex&#x27;</span>])<br><br>---<br><br>Sex				F	M<br>Age		<br>(<span class="hljs-number">19</span>, <span class="hljs-number">40</span>]	<span class="hljs-number">18</span>	<span class="hljs-number">22</span><br>(<span class="hljs-number">40</span>, <span class="hljs-number">65</span>]	<span class="hljs-number">25</span>	<span class="hljs-number">27</span><br>(<span class="hljs-number">65</span>, <span class="hljs-number">100</span>]	<span class="hljs-number">3</span>		<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<h3 id="聚合">聚合</h3>
<p>我们先来看聚合函数的表格</p>
<table>
<thead>
<tr class="header">
<th>聚合函数</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td>计算分组平均值</td>
</tr>
<tr class="even">
<td>count</td>
<td>分组中⾮NA 值的数量</td>
</tr>
<tr class="odd">
<td>sum</td>
<td>⾮NA 值的和</td>
</tr>
<tr class="even">
<td>median</td>
<td>⾮NA 值的算术中位数</td>
</tr>
<tr class="odd">
<td>std</td>
<td>标准差</td>
</tr>
<tr class="even">
<td>var</td>
<td>⽅差</td>
</tr>
<tr class="odd">
<td>min</td>
<td>⾮NA 值的最⼩值</td>
</tr>
<tr class="even">
<td>max</td>
<td>⾮NA 值的最⼤值</td>
</tr>
<tr class="odd">
<td>prod</td>
<td>⾮NA 值的积</td>
</tr>
<tr class="even">
<td>first</td>
<td>第⼀个⾮NA 值</td>
</tr>
<tr class="odd">
<td>last</td>
<td>最后⼀个⾮NA 值</td>
</tr>
<tr class="even">
<td>mad</td>
<td>平均绝对偏差</td>
</tr>
<tr class="odd">
<td>mode</td>
<td>模</td>
</tr>
<tr class="even">
<td>abs</td>
<td>绝对值</td>
</tr>
<tr class="odd">
<td>sem</td>
<td>平均值的标准误差</td>
</tr>
<tr class="even">
<td>skew</td>
<td>样品偏斜度（三阶矩）</td>
</tr>
<tr class="odd">
<td>kurt</td>
<td>样品峰度（四阶矩）</td>
</tr>
<tr class="even">
<td>quantile</td>
<td>样本分位数（百分位上的值）</td>
</tr>
<tr class="odd">
<td>cumsum</td>
<td>累积总和</td>
</tr>
<tr class="even">
<td>cumprod</td>
<td>累积乘积</td>
</tr>
<tr class="odd">
<td>cummax</td>
<td>累积最⼤值</td>
</tr>
<tr class="even">
<td>cummin</td>
<td>累积最⼩值</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;Data1&#x27;</span>:np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>),<br> <span class="hljs-string">&#x27;Data2&#x27;</span>:np.random.randint(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>,<span class="hljs-number">5</span>),<br> <span class="hljs-string">&#x27;key1&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;aabba&#x27;</span>),<br> <span class="hljs-string">&#x27;key2&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;xyyxy&#x27;</span>)&#125;)<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>   Data1  Data2 key1 key2<br><span class="hljs-number">0</span>      <span class="hljs-number">4</span>     <span class="hljs-number">17</span>    a    x<br><span class="hljs-number">1</span>      <span class="hljs-number">4</span>     <span class="hljs-number">13</span>    a    y<br><span class="hljs-number">2</span>      <span class="hljs-number">0</span>     <span class="hljs-number">12</span>    b    y<br><span class="hljs-number">3</span>      <span class="hljs-number">5</span>     <span class="hljs-number">16</span>    b    x<br><span class="hljs-number">4</span>      <span class="hljs-number">8</span>     <span class="hljs-number">10</span>    a    y<br></code></pre></td></tr></table></figure>
<p>按 key1 分组，进⾏聚合计算</p>
<p>⚠️
注意：当分组后进⾏数值计算时，不是数值类的列（即麻烦列）会被清除</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).<span class="hljs-built_in">sum</span>())<br><br>---<br>      Data1  Data2<br>key1              <br>a        <span class="hljs-number">16</span>     <span class="hljs-number">40</span><br>b         <span class="hljs-number">5</span>     <span class="hljs-number">28</span><br></code></pre></td></tr></table></figure>
<p>只算 data1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1[<span class="hljs-string">&#x27;Data1&#x27;</span>].groupby(df1[<span class="hljs-string">&#x27;key1&#x27;</span>]).<span class="hljs-built_in">sum</span>()) <br><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>)[<span class="hljs-string">&#x27;Data1&#x27;</span>].<span class="hljs-built_in">sum</span>())<br><br>---<br>key1<br>a    <span class="hljs-number">16</span><br>b     <span class="hljs-number">5</span><br>Name: Data1, dtype: int64<br>key1<br>a    <span class="hljs-number">16</span><br>b     <span class="hljs-number">5</span><br>Name: Data1, dtype: int64<br></code></pre></td></tr></table></figure>
<p>使⽤<code>agg()</code>函数做聚合运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg(<span class="hljs-string">&#x27;sum&#x27;</span>))<br><br>---<br>      Data1  Data2<br>key1              <br>a        <span class="hljs-number">16</span>     <span class="hljs-number">40</span><br>b         <span class="hljs-number">5</span>     <span class="hljs-number">28</span><br></code></pre></td></tr></table></figure>
<p>可以同时做多个聚合运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg([<span class="hljs-string">&#x27;sum&#x27;</span>,<span class="hljs-string">&#x27;mean&#x27;</span>,<span class="hljs-string">&#x27;std&#x27;</span>]))<br><br>---<br>     Data1                     Data2                     <br>       <span class="hljs-built_in">sum</span>      mean       std   <span class="hljs-built_in">sum</span>       mean       std<br>key1                                                     <br>a       <span class="hljs-number">16</span>  <span class="hljs-number">5.333333</span>  <span class="hljs-number">2.309401</span>    <span class="hljs-number">40</span>  <span class="hljs-number">13.333333</span>  <span class="hljs-number">3.511885</span><br>b        <span class="hljs-number">5</span>  <span class="hljs-number">2.500000</span>  <span class="hljs-number">3.535534</span>    <span class="hljs-number">28</span>  <span class="hljs-number">14.000000</span>  <span class="hljs-number">2.828427</span><br></code></pre></td></tr></table></figure>
<p>可⾃定义函数，传⼊agg⽅法中 <code>grouped.agg(func)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">peak_range</span>(<span class="hljs-params">df</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    返回数值范围</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> df.<span class="hljs-built_in">max</span>() - df.<span class="hljs-built_in">min</span>()<br><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg(peak_range))<br><br>---<br>      Data1  Data2<br>key1              <br>a         <span class="hljs-number">4</span>      <span class="hljs-number">7</span><br>b         <span class="hljs-number">5</span>      <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>
<p>同时应⽤多个聚合函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg([<span class="hljs-string">&#x27;mean&#x27;</span>, <span class="hljs-string">&#x27;std&#x27;</span>, <span class="hljs-string">&#x27;count&#x27;</span>, peak_range])) <span class="hljs-comment"># 默认列名为函数名</span><br><br>---<br>         Data1                                 Data2                  \<br>          mean       std count peak_range       mean       std count   <br>key1                                                                   <br>a     <span class="hljs-number">5.333333</span>  <span class="hljs-number">2.309401</span>     <span class="hljs-number">3</span>          <span class="hljs-number">4</span>  <span class="hljs-number">13.333333</span>  <span class="hljs-number">3.511885</span>     <span class="hljs-number">3</span>   <br>b     <span class="hljs-number">2.500000</span>  <span class="hljs-number">3.535534</span>     <span class="hljs-number">2</span>          <span class="hljs-number">5</span>  <span class="hljs-number">14.000000</span>  <span class="hljs-number">2.828427</span>     <span class="hljs-number">2</span>   <br><br>                 <br>     peak_range  <br>key1             <br>a             <span class="hljs-number">7</span>  <br>b             <span class="hljs-number">4</span>  <br></code></pre></td></tr></table></figure>
<p>通过元组提供新的列名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg([<span class="hljs-string">&#x27;mean&#x27;</span>, <span class="hljs-string">&#x27;std&#x27;</span>, <span class="hljs-string">&#x27;count&#x27;</span>, (<span class="hljs-string">&#x27;range&#x27;</span>, peak_range)])) <br><br>---<br>         Data1                            Data2                      <br>          mean       std count <span class="hljs-built_in">range</span>       mean       std count <span class="hljs-built_in">range</span><br>key1                                                                 <br>a     <span class="hljs-number">5.333333</span>  <span class="hljs-number">2.309401</span>     <span class="hljs-number">3</span>     <span class="hljs-number">4</span>  <span class="hljs-number">13.333333</span>  <span class="hljs-number">3.511885</span>     <span class="hljs-number">3</span>     <span class="hljs-number">7</span><br>b     <span class="hljs-number">2.500000</span>  <span class="hljs-number">3.535534</span>     <span class="hljs-number">2</span>     <span class="hljs-number">5</span>  <span class="hljs-number">14.000000</span>  <span class="hljs-number">2.828427</span>     <span class="hljs-number">2</span>     <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>
<p>给每列作⽤不同的聚合函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">dict_mapping = &#123;<br>    <span class="hljs-string">&#x27;Data1&#x27;</span>:[<span class="hljs-string">&#x27;mean&#x27;</span>,<span class="hljs-string">&#x27;max&#x27;</span>],<br>    <span class="hljs-string">&#x27;Data2&#x27;</span>:<span class="hljs-string">&#x27;sum&#x27;</span><br>&#125;<br>df1.groupby(<span class="hljs-string">&#x27;key1&#x27;</span>).agg(dict_mapping)<br><br>---<br>		Data1			Data2<br>		mean			<span class="hljs-built_in">max</span>	<span class="hljs-built_in">sum</span><br>key1			<br>a		<span class="hljs-number">5.333333</span>	<span class="hljs-number">8</span>		<span class="hljs-number">40</span><br>b		<span class="hljs-number">2.500000</span>	<span class="hljs-number">5</span>		<span class="hljs-number">28</span><br></code></pre></td></tr></table></figure>
<p>拓展<code>apply()</code>函数</p>
<p>apply 函数是 pandas⾥⾯所有函数中⾃由度最⾼的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df1=pd.DataFrame(&#123;<span class="hljs-string">&#x27;sex&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;FFMFMMF&#x27;</span>),<span class="hljs-string">&#x27;smoker&#x27;</span>:<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;YNYYNYY&#x27;</span>),<span class="hljs-string">&#x27;age&#x27;</span>: [<span class="hljs-number">21</span>,<span class="hljs-number">30</span>,<span class="hljs-number">17</span>,<span class="hljs-number">37</span>,<span class="hljs-number">40</span>,<span class="hljs-number">18</span>,<span class="hljs-number">26</span>],<span class="hljs-string">&#x27;weight&#x27;</span>:[<span class="hljs-number">120</span>,<span class="hljs-number">100</span>,<span class="hljs-number">132</span>,<span class="hljs-number">140</span>,<span class="hljs-number">94</span>,<span class="hljs-number">89</span>,<span class="hljs-number">123</span>]&#125;)<br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>  sex smoker  age  weight<br><span class="hljs-number">0</span>   F      Y   <span class="hljs-number">21</span>     <span class="hljs-number">120</span><br><span class="hljs-number">1</span>   F      N   <span class="hljs-number">30</span>     <span class="hljs-number">100</span><br><span class="hljs-number">2</span>   M      Y   <span class="hljs-number">17</span>     <span class="hljs-number">132</span><br><span class="hljs-number">3</span>   F      Y   <span class="hljs-number">37</span>     <span class="hljs-number">140</span><br><span class="hljs-number">4</span>   M      N   <span class="hljs-number">40</span>      <span class="hljs-number">94</span><br><span class="hljs-number">5</span>   M      Y   <span class="hljs-number">18</span>      <span class="hljs-number">89</span><br><span class="hljs-number">6</span>   F      Y   <span class="hljs-number">26</span>     <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure>
<p>抽烟的年龄⼤于等 18 的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">bin_age</span>(<span class="hljs-params">age</span>):<br>    <span class="hljs-keyword">if</span> age &gt;=<span class="hljs-number">18</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> <br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>      <br><span class="hljs-built_in">print</span>(df1[<span class="hljs-string">&#x27;age&#x27;</span>].apply(bin_age))<br><br>---<br><span class="hljs-number">0</span>    <span class="hljs-number">1</span><br><span class="hljs-number">1</span>    <span class="hljs-number">1</span><br><span class="hljs-number">2</span>    <span class="hljs-number">0</span><br><span class="hljs-number">3</span>    <span class="hljs-number">1</span><br><span class="hljs-number">4</span>    <span class="hljs-number">1</span><br><span class="hljs-number">5</span>    <span class="hljs-number">1</span><br><span class="hljs-number">6</span>    <span class="hljs-number">1</span><br>Name: age, dtype: int64<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">df1[<span class="hljs-string">&#x27;age&#x27;</span>] = df1[<span class="hljs-string">&#x27;age&#x27;</span>].apply(bin_age) <br><span class="hljs-built_in">print</span>(df1)<br><br>---<br>  sex smoker  age  weight<br><span class="hljs-number">0</span>   F      Y    <span class="hljs-number">1</span>     <span class="hljs-number">120</span><br><span class="hljs-number">1</span>   F      N    <span class="hljs-number">1</span>     <span class="hljs-number">100</span><br><span class="hljs-number">2</span>   M      Y    <span class="hljs-number">0</span>     <span class="hljs-number">132</span><br><span class="hljs-number">3</span>   F      Y    <span class="hljs-number">1</span>     <span class="hljs-number">140</span><br><span class="hljs-number">4</span>   M      N    <span class="hljs-number">1</span>      <span class="hljs-number">94</span><br><span class="hljs-number">5</span>   M      Y    <span class="hljs-number">1</span>      <span class="hljs-number">89</span><br><span class="hljs-number">6</span>   F      Y    <span class="hljs-number">1</span>     <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure>
<p>取出抽烟和不抽烟的体重前⼆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">top</span>(<span class="hljs-params">smoker,col,n=<span class="hljs-number">5</span></span>):<br>    <span class="hljs-keyword">return</span> smoker.sort_values(by=col)[-n:]<br>df1.groupby(<span class="hljs-string">&#x27;smoker&#x27;</span>).apply(top,col=<span class="hljs-string">&#x27;weight&#x27;</span>,n=<span class="hljs-number">2</span>)<br><br>---<br>					sex	smoker	age	weight<br>smoker					<br>	N			<span class="hljs-number">4</span>		M		N			<span class="hljs-number">1</span>			<span class="hljs-number">94</span><br>				<span class="hljs-number">1</span>		F		N			<span class="hljs-number">1</span>			<span class="hljs-number">100</span><br>	Y			<span class="hljs-number">2</span>		M		Y			<span class="hljs-number">0</span>			<span class="hljs-number">132</span><br>				<span class="hljs-number">3</span>		F		Y			<span class="hljs-number">1</span>			<span class="hljs-number">140</span><br></code></pre></td></tr></table></figure>
<p>按理来说，我们最后展示数据的时候，在用完<code>age</code>上<code>0,1</code>作为判断之后，要恢复成原本的年龄的数据。不过...就这样吧。因为马上，我们要做一个完整的分组案例，从一个<code>csv</code>文件获取数据，然后分组，最后进行数据可视化展示：</p>
<h2 id="分组案例">分组案例</h2>
<p>我们先来读取数据，案例中使用到的数据会上传到我的<code>Github</code>仓库中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python">data = pd.read_csv(<span class="hljs-string">&#x27;./data/movie_metadata.csv&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;数据的形状：&#x27;</span>, data.shape) <br><span class="hljs-built_in">print</span>(data.head())<br><br>---<br>数据的形状： (<span class="hljs-number">5043</span>, <span class="hljs-number">28</span>)<br>                                        movie_title language country  \<br><span class="hljs-number">0</span>                                            Avatar   English     USA   <br><span class="hljs-number">1</span>          Pirates of the Caribbean: At World<span class="hljs-string">&#x27;s End   English     USA   </span><br><span class="hljs-string">2                                           Spectre   English      UK   </span><br><span class="hljs-string">3                             The Dark Knight Rises   English     USA   </span><br><span class="hljs-string">4  Star Wars: Episode VII - The Force Awakens    ...      NaN     NaN   </span><br><span class="hljs-string"></span><br><span class="hljs-string">  content_rating title_year  color  duration                           genres  \</span><br><span class="hljs-string">0          PG-13    2009-02  Color     178.0  Action|Adventure|Fantasy|Sci-Fi   </span><br><span class="hljs-string">1          PG-13    2007-09  Color     169.0         Action|Adventure|Fantasy   </span><br><span class="hljs-string">2          PG-13    2015-11  Color     148.0        Action|Adventure|Thriller   </span><br><span class="hljs-string">3          PG-13    2012-08  Color     164.0                  Action|Thriller   </span><br><span class="hljs-string">4            NaN        NaN    NaN       NaN                      Documentary   </span><br><span class="hljs-string"></span><br><span class="hljs-string">                                       plot_keywords       budget  ...  \</span><br><span class="hljs-string">0             avatar|future|marine|native|paraplegic  237000000.0  ...   </span><br><span class="hljs-string">1  goddess|marriage ceremony|marriage proposal|pi...  300000000.0  ...   </span><br><span class="hljs-string">2                bomb|espionage|sequel|spy|terrorist  245000000.0  ...   </span><br><span class="hljs-string">3  deception|imprisonment|lawlessness|police offi...  250000000.0  ...   </span><br><span class="hljs-string">4                                                NaN          NaN  ...   </span><br><span class="hljs-string"></span><br><span class="hljs-string">   actor_2_facebook_likes          actor_3_name  actor_3_facebook_likes  \</span><br><span class="hljs-string">0                   936.0             Wes Studi                   855.0   </span><br><span class="hljs-string">1                  5000.0        Jack Davenport                  1000.0   </span><br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure>
<p>然后让我们来处理缺失值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">data = data.dropna(how=<span class="hljs-string">&#x27;any&#x27;</span>)<br><span class="hljs-built_in">print</span>(data.head())<br><br>---<br>                                 movie_title language country content_rating  \<br><span class="hljs-number">0</span>                                    Avatar   English     USA          PG-<span class="hljs-number">13</span>   <br><span class="hljs-number">1</span>  Pirates of the Caribbean: At World<span class="hljs-string">&#x27;s End   English     USA          PG-13   </span><br><span class="hljs-string">2                                   Spectre   English      UK          PG-13   </span><br><span class="hljs-string">3                     The Dark Knight Rises   English     USA          PG-13   </span><br><span class="hljs-string">5                               John Carter   English     USA          PG-13   </span><br><span class="hljs-string"></span><br><span class="hljs-string">  title_year  color  duration                           genres  \</span><br><span class="hljs-string">0    2009-02  Color     178.0  Action|Adventure|Fantasy|Sci-Fi   </span><br><span class="hljs-string">1    2007-09  Color     169.0         Action|Adventure|Fantasy   </span><br><span class="hljs-string">2    2015-11  Color     148.0        Action|Adventure|Thriller   </span><br><span class="hljs-string">3    2012-08  Color     164.0                  Action|Thriller   </span><br><span class="hljs-string">5    2012-07  Color     132.0          Action|Adventure|Sci-Fi   </span><br><span class="hljs-string"></span><br><span class="hljs-string">                                       plot_keywords       budget  ...  \</span><br><span class="hljs-string">0             avatar|future|marine|native|paraplegic  237000000.0  ...   </span><br><span class="hljs-string">1  goddess|marriage ceremony|marriage proposal|pi...  300000000.0  ...   </span><br><span class="hljs-string">2                bomb|espionage|sequel|spy|terrorist  245000000.0  ...   </span><br><span class="hljs-string">3  deception|imprisonment|lawlessness|police offi...  250000000.0  ...   </span><br><span class="hljs-string">5  alien|american civil war|male nipple|mars|prin...  263700000.0  ...   </span><br><span class="hljs-string"></span><br><span class="hljs-string">   actor_2_facebook_likes          actor_3_name  actor_3_facebook_likes  \</span><br><span class="hljs-string">0                   936.0             Wes Studi                   855.0   </span><br><span class="hljs-string">1                  5000.0        Jack Davenport                  1000.0   </span><br><span class="hljs-string">2                   393.0      Stephanie Sigman                   161.0   </span><br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure>
<p>接着，我们来查看一下票房收入统计</p>
<p>导演 vs 票房总收⼊</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">group_director = data.groupby(*by*=<span class="hljs-string">&#x27;director_name&#x27;</span>)[<span class="hljs-string">&#x27;gross&#x27;</span>].<span class="hljs-built_in">sum</span>()<br></code></pre></td></tr></table></figure>
<p>ascending 升降序排列，True 升序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">result = group_director.sort_values() <br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(result))<br><span class="hljs-built_in">print</span>(result)<br><br>---<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pandas.core.series.Series&#x27;</span>&gt;<br>director_name<br>Ekachai Uekrongtham    <span class="hljs-number">1.620000e+02</span><br>Frank Whaley           <span class="hljs-number">7.030000e+02</span><br>Ricki Stern            <span class="hljs-number">1.111000e+03</span><br>Alex Craig Mann        <span class="hljs-number">1.332000e+03</span><br>Paul Bunnell           <span class="hljs-number">2.436000e+03</span><br>                           ...     <br>Sam Raimi              <span class="hljs-number">2.049549e+09</span><br>Tim Burton             <span class="hljs-number">2.071275e+09</span><br>Michael Bay            <span class="hljs-number">2.231243e+09</span><br>Peter Jackson          <span class="hljs-number">2.592969e+09</span><br>Steven Spielberg       <span class="hljs-number">4.114233e+09</span><br>Name: gross, Length: <span class="hljs-number">1660</span>, dtype: float64<br></code></pre></td></tr></table></figure>
<p><strong>电影产量年份趋势</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt <br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> font_manager<br><br>movie_years = data.groupby(<span class="hljs-string">&#x27;title_year&#x27;</span>)[<span class="hljs-string">&#x27;movie_title&#x27;</span>]<br><span class="hljs-built_in">print</span>(movie_years.count().index.tolist()) <br><span class="hljs-built_in">print</span>(movie_years.count().values)<br><br>---<br>[<span class="hljs-string">&#x27;1927-02&#x27;</span>, ..., <span class="hljs-string">&#x27;2016-12&#x27;</span>]<br>[ <span class="hljs-number">1</span>  ... <span class="hljs-number">6</span>]<br></code></pre></td></tr></table></figure>
<p>最后，我们利用之前学过的<code>matplotlib</code>进行数据可视化展示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">x = movie_years.count().index.tolist()<br>y = movie_years.count().values<br>plt.figure(figsize=(<span class="hljs-number">20</span>,<span class="hljs-number">8</span>),dpi=<span class="hljs-number">80</span>)<br>plt.plot(x,y)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p><img
src="https://cdn.jsdelivr.net/gh/hivandu/notes/img/20231226135446.png"
alt="20231226135446" /></p>
<h2 id="结尾">结尾</h2>
<p>那小伙伴们，到今天为止，我们《AI 秘籍》系列课程中的「Python
部分」也就完全讲完了。就如我一开始向大家承诺的，这部分内容将完全免费。</p>
<p>而我们的《AI
秘籍》课程也才刚刚开始，未来很长一段时间内，我们都将继续和这些基础内容频繁打交道。用它们来呈现我们之后要用到的所有课程。包括
AI 基础，CV，BI，NLP 等课程。</p>
<p>不过在结束了一个阶段之后，我需要花点时间休整一下，也是为了好好的备课，找到最好的结构和顺序为大家编写后面的课程。本次课程的最后这两节课我都有些疲劳，为了赶快完成进度，编写过程当中可能有些粗糙或者遗漏，也请大家多包涵。日后，我可能会对这两节课进行更新，将一些细节的讲解补充完整。</p>
<p>免费部分结束了，日后的收费课程，也期望大家能一如即往的支持。</p>
<p>在这里，我也给大家推荐一些比较好的书籍，希望看到小伙伴们能够快速成长起来。</p>
<p>感谢大家，好了。本节课到此结束，下课了。</p>
<p>至此，Python 篇也结束了，欢迎大家关注「茶桁的 AI 秘籍」后续课程。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-08-21T00:41:45.000Z" title="8/21/2023, 8:41:45 AM">2023-08-21</time>发表</span><span class="level-item"><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a><span> / </span><a class="link-muted" href="/categories/AI-%E7%A7%98%E7%B1%8D/Python/">Python</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/AI-Python-numpy/">26. NumPy</a></p><div class="content"><p><img
src="https://cdn.jsdelivr.net/gh/hivandu/notes/img/202311251943412.png" /></p>
<p>Hi，大家好。我是茶桁。</p></div><a class="article-more button is-small is-size-7" href="/AI-Python-numpy/#more">阅读更多</a></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/page/5/">上一页</a></div><div class="pagination-next"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/page/7/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/categories/AI-%E7%A7%98%E7%B1%8D/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/categories/AI-%E7%A7%98%E7%B1%8D/page/5/">5</a></li><li><a class="pagination-link is-current" href="/categories/AI-%E7%A7%98%E7%B1%8D/page/6/">6</a></li><li><a class="pagination-link" href="/categories/AI-%E7%A7%98%E7%B1%8D/page/7/">7</a></li><li><a class="pagination-link" href="/categories/AI-%E7%A7%98%E7%B1%8D/page/8/">8</a></li><li><a class="pagination-link" href="/categories/AI-%E7%A7%98%E7%B1%8D/page/9/">9</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/bdff168cf8a71c11d2712a1679a00c54?s=128" alt="茶桁"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">茶桁</p><p class="is-size-6 is-block">AI 游民</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shang Hai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">227</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">22</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hivandu" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hivan"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/hivan"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com/hivan"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4NzE4MDQzMg==&amp;action=getalbum&amp;album_id=2932504849574543360&amp;scene=173&amp;from_msgid=2648747980&amp;from_itemidx=1&amp;count=3&amp;nolastread=1&amp;token=1758883909&amp;lang=zh_CN#wechat_redirect"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.zhihu.com/column/c_1424326166602178560" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">塌缩的奇点</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhihu.com/column/hivandu" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">茶桁-知乎</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI-%E7%A7%98%E7%B1%8D/"><span class="level-start"><span class="level-item">AI 秘籍</span></span><span class="level-end"><span class="level-item tag">85</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/"><span class="level-start"><span class="level-item">BI</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/AI-%E7%A7%98%E7%B1%8D/Math/"><span class="level-start"><span class="level-item">Math</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/AI-%E7%A7%98%E7%B1%8D/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile" href="/categories/AI-%E7%A7%98%E7%B1%8D/%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">核心能力基础</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="level-start"><span class="level-item">从零开始接触人工智能大模型</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-03-09T23:30:00.000Z">2024-03-10</time></p><p class="title"><a href="/21.%20BI%20-%20SVD%20%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3%E7%9A%84%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B%EF%BC%9A%E5%88%A9%E7%94%A8%20SVD%20%E8%BF%9B%E8%A1%8C%E5%9B%BE%E5%83%8F%E5%8E%8B%E7%BC%A9/">21. BI - SVD 矩阵分解的实际案例：利用 SVD 进行图像压缩</a></p><p class="categories"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a> / <a href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/">BI</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-03-05T23:30:00.000Z">2024-03-06</time></p><p class="title"><a href="/20.%20BI%20-%20%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E4%B8%BA%E4%BD%A0%E8%AE%B2%E9%80%8F%20SVD%20%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3%E7%9A%84%E5%8E%9F%E7%90%86/">20. BI - 一篇文章为你讲透 SVD 矩阵分解的原理</a></p><p class="categories"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a> / <a href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/">BI</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-03-02T23:30:00.000Z">2024-03-03</time></p><p class="title"><a href="/19.%20BI%20-%20%E5%AD%A6%E4%B9%A0%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A6%82%E4%BD%95%E4%BB%8E%E9%98%85%E8%AF%BB%E8%AE%BA%E6%96%87%E4%B8%AD%E8%8E%B7%E5%8F%96%E4%B8%80%E6%89%8B%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%B9%B6%E6%8E%A8%E8%8D%90%E4%B8%80%E4%BA%9B%E6%8A%80%E6%9C%AF%E8%AE%BA%E6%96%87/">19. BI - 学习人工智能如何从阅读论文中获取一手信息，并推荐一些技术论文</a></p><p class="categories"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a> / <a href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/">BI</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-29T23:30:00.000Z">2024-03-01</time></p><p class="title"><a href="/18.%20BI%20-%20SlopeOne%20%E5%8E%9F%E5%A7%8B%E7%AE%97%E6%B3%95%E3%80%81%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95%E7%9A%84%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/">18. BI - SlopeOne 原始算法、优化算法的原理及应用</a></p><p class="categories"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a> / <a href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/">BI</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-27T23:30:00.000Z">2024-02-28</time></p><p class="title"><a href="/17.%20BI%20-%20Surprise%E5%B7%A5%E5%85%B7%E7%AE%B1%EF%BC%9ABaseline/">17. BI - Surprise 工具箱：Baseline</a></p><p class="categories"><a href="/categories/AI-%E7%A7%98%E7%B1%8D/">AI 秘籍</a> / <a href="/categories/AI-%E7%A7%98%E7%B1%8D/BI/">BI</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a><p class="is-size-7"><span>&copy; 2024 Hivan Du</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>