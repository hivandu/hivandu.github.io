<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Machine Learning Part-03 - 茶桁.MAMT</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶桁.MAMT"><meta name="msapplication-TileImage" content="https://qiniu.hivan.me/picGo/20230601174411.png?imgNote"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶桁.MAMT"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Decision trees Machine learning basics - use decision trees to make predictions about coupons In order to get close to real life and applications, the processing of actual data sets is the main focus."><meta property="og:type" content="blog"><meta property="og:title" content="Machine Learning Part-03"><meta property="og:url" content="https://hivan.me/example_05/"><meta property="og:site_name" content="茶桁.MAMT"><meta property="og:description" content="Decision trees Machine learning basics - use decision trees to make predictions about coupons In order to get close to real life and applications, the processing of actual data sets is the main focus."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hivan.me/img/og_image.png"><meta property="article:published_time" content="2021-09-02T12:59:46.686Z"><meta property="article:modified_time" content="2023-06-02T03:49:39.335Z"><meta property="article:author" content="Hivan Du"><meta property="article:tag" content="AI,人工智能,代码,大语言模型"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hivan.me/img/og_image.png"><meta property="twitter:creator" content="@hivan"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hivan.me/example_05/"},"headline":"Machine Learning Part-03","image":["https://hivan.me/img/og_image.png"],"datePublished":"2021-09-02T12:59:46.686Z","dateModified":"2023-06-02T03:49:39.335Z","author":{"@type":"Person","name":"Hivan Du"},"publisher":{"@type":"Organization","name":"茶桁.MAMT","logo":{"@type":"ImageObject","url":"https://hivan.me/img/logo.svg"}},"description":"Decision trees Machine learning basics - use decision trees to make predictions about coupons In order to get close to real life and applications, the processing of actual data sets is the main focus."}</script><link rel="canonical" href="https://hivan.me/example_05/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="茶桁.MAMT" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-09-02T12:59:46.686Z" title="9/2/2021, 8:59:46 PM">2021-09-02</time>发表</span></div></div><h1 class="title is-3 is-size-4-mobile">Machine Learning Part-03</h1><div class="content"><h2 id="decision-trees">Decision trees</h2>
<p>Machine learning basics - use decision trees to make predictions
about coupons</p>
<p>In order to get close to real life and applications, the processing
of actual data sets is the main focus. From January 1, 2016 to June 30,
2016, real online and offline consumption behaviors are predicted to be
used by users within 15 days after receiving coupons in July 2016. Note:
In order to protect the privacy of users and businesses, all data is
anonymized, and biased sampling and necessary filtering are used.</p>
<span id="more"></span>
<p><strong>Data set ccf_offline_stage1_train.csv (training
data)</strong></p>
<table>
<colgroup>
<col style="width: 66%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">User_id</td>
<td>用户ID</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merchant_id</td>
<td>商户ID</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coupon_id</td>
<td>优惠券ID：null表示无优惠券消费，此时Discount_rate和Date_received字段无意义</td>
</tr>
<tr class="even">
<td style="text-align: left;">Discount_rate</td>
<td>优惠率：x 代表折扣率；x:y表示满x减y。单位是元</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Distance</td>
<td>user经常活动的地点离该merchant的最近门店距离是x*500米（如果是连锁店，则取最近的一家门店），x<span
class="math inline">\(\in[0,10]\)</span>；null表示无此信息，0表示低于500米，10表示大于5公里；</td>
</tr>
<tr class="even">
<td style="text-align: left;">Date_received</td>
<td>领取优惠券日期</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td>消费日期：如果Date=null &amp; Coupon_id !=
null，该记录表示领取优惠券但没有使用，即负样本；如果Date!=null &amp;
Coupon_id = null，则表示普通消费日期；如果Date!=null &amp; Coupon_id !=
null，则表示用优惠券消费日期，即正样本；</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># load plugin</span><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment">#  load data</span><br>train_data = pd.read_csv(<span class="hljs-string">&#x27;~/data/ccf_offline_stage1_train.csv&#x27;</span>)<br>train_data.info()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br><span class="hljs-string">RangeIndex: 1754884 entries, 0 to 1754883</span><br><span class="hljs-string">Data columns (total 7 columns):</span><br><span class="hljs-string"> #   Column         Dtype  </span><br><span class="hljs-string">---  ------         -----  </span><br><span class="hljs-string"> 0   User_id        int64  </span><br><span class="hljs-string"> 1   Merchant_id    int64  </span><br><span class="hljs-string"> 2   Coupon_id      float64</span><br><span class="hljs-string"> 3   Discount_rate  object </span><br><span class="hljs-string"> 4   Distance       float64</span><br><span class="hljs-string"> 5   Date_received  float64</span><br><span class="hljs-string"> 6   Date           float64</span><br><span class="hljs-string">dtypes: float64(4), int64(2), object(1)</span><br><span class="hljs-string">memory usage: 93.7+ MB</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>train_data.head()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">	User_id	Merchant_id	Coupon_id	Discount_rate	Distance	Date_received	Date</span><br><span class="hljs-string">0	1439408	2632	NaN	NaN	0.0	NaN	20160217.0</span><br><span class="hljs-string">1	1439408	4663	11002.0	150:20	1.0	20160528.0	NaN</span><br><span class="hljs-string">2	1439408	2632	8591.0	20:1	0.0	20160217.0	NaN</span><br><span class="hljs-string">3	1439408	2632	1078.0	20:1	0.0	20160319.0	NaN</span><br><span class="hljs-string">4	1439408	2632	8591.0	20:1	0.0	20160613.0	NaN</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(train_data.shape)<br><br>data = train_data.dropna(how = <span class="hljs-string">&#x27;any&#x27;</span>)<br><span class="hljs-built_in">print</span>(train_data.shape)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">(1754884, 7)</span><br><span class="hljs-string">(1754884, 7)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p><code>Discount_rate</code>是object类型的，object在pandas中代表字符串，字符串类型不能输入模型中，所以需要改为数值类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Discount_rate 类型: \n&#x27;</span>, data[<span class="hljs-string">&#x27;Discount_rate&#x27;</span>].unique())<br><span class="hljs-comment"># [0,1] 表示折扣率</span><br><span class="hljs-comment"># x:y 表示满 x 减 y</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Discount_rate 类型: </span><br><span class="hljs-string"> [&#x27;20:1&#x27; &#x27;20:5&#x27; &#x27;30:5&#x27; &#x27;50:10&#x27; &#x27;10:5&#x27; &#x27;50:20&#x27; &#x27;100:10&#x27; &#x27;30:10&#x27; &#x27;50:5&#x27;</span><br><span class="hljs-string"> &#x27;30:1&#x27; &#x27;100:30&#x27; &#x27;0.8&#x27; &#x27;200:30&#x27; &#x27;100:20&#x27; &#x27;10:1&#x27; &#x27;200:20&#x27; &#x27;0.95&#x27; &#x27;5:1&#x27;</span><br><span class="hljs-string"> &#x27;100:5&#x27; &#x27;100:50&#x27; &#x27;50:1&#x27; &#x27;20:10&#x27; &#x27;150:10&#x27; &#x27;0.9&#x27; &#x27;200:50&#x27; &#x27;150:20&#x27; &#x27;150:50&#x27;</span><br><span class="hljs-string"> &#x27;200:5&#x27; &#x27;300:30&#x27; &#x27;100:1&#x27; &#x27;200:10&#x27; &#x27;150:30&#x27; &#x27;0.85&#x27; &#x27;0.6&#x27; &#x27;0.5&#x27; &#x27;300:20&#x27;</span><br><span class="hljs-string"> &#x27;200:100&#x27; &#x27;300:50&#x27; &#x27;150:5&#x27; &#x27;300:10&#x27; &#x27;0.75&#x27; &#x27;0.7&#x27; &#x27;30:20&#x27; &#x27;50:30&#x27;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p><strong>Convert Discount_rate into numerical features</strong></p>
<p>Discount type</p>
<p>x:y 表示满 x 减 y 将 x:y 类型的字符串设为1</p>
<p>[0,1] 表示折扣率 将 [0,1] 类型的字符串设为 0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getDiscountType</span>(<span class="hljs-params">row</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;:&#x27;</span> <span class="hljs-keyword">in</span> row:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>data[<span class="hljs-string">&#x27;Discount_rate&#x27;</span>] = data[<span class="hljs-string">&#x27;Discount_rate&#x27;</span>].apply(getDiscountType)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy</span><br><span class="hljs-string">  import sys</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>data.info()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br><span class="hljs-string">Int64Index: 67165 entries, 6 to 1754880</span><br><span class="hljs-string">Data columns (total 7 columns):</span><br><span class="hljs-string"> #   Column         Non-Null Count  Dtype  </span><br><span class="hljs-string">---  ------         --------------  -----  </span><br><span class="hljs-string"> 0   User_id        67165 non-null  int64  </span><br><span class="hljs-string"> 1   Merchant_id    67165 non-null  int64  </span><br><span class="hljs-string"> 2   Coupon_id      67165 non-null  float64</span><br><span class="hljs-string"> 3   Discount_rate  67165 non-null  int64  </span><br><span class="hljs-string"> 4   Distance       67165 non-null  float64</span><br><span class="hljs-string"> 5   Date_received  67165 non-null  float64</span><br><span class="hljs-string"> 6   Date           67165 non-null  float64</span><br><span class="hljs-string">dtypes: float64(4), int64(3)</span><br><span class="hljs-string">memory usage: 4.1 MB</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># load plugin</span><br><span class="hljs-comment"># Import DecisionTreeClassifier model</span><br><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier<br><span class="hljs-comment"># Import train_test_split, used to divide the data set and test set</span><br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-comment"># Import accuracy_score accuracy index</span><br><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score<br></code></pre></td></tr></table></figure>
<p>add label row to the dataset</p>
<p>Labeling Label Label which samples are positive samples y=1 and which
are negative samples y = -1 Forecast goal: the user's consumption within
15 days after receiving the coupon (Date-Date_received &lt;= 15) means
to receive the coupon and use it within 15 days, that is, a positive
sample, y = 1 (Date-Date_received&gt; 15) means that the coupon has not
been used within 15 days, that is, a negative sample, y = 0 pandas
tutorial on time
<code>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">label</span>(<span class="hljs-params">row</span>):<br>    <span class="hljs-keyword">if</span> row[<span class="hljs-string">&#x27;Date&#x27;</span>] != <span class="hljs-string">&#x27;null&#x27;</span>:<br>        td = pd.to_datetime(row[<span class="hljs-string">&#x27;Date&#x27;</span>], <span class="hljs-built_in">format</span> = <span class="hljs-string">&#x27;%Y%m%d&#x27;</span>) - pd.to_datetime(row[<span class="hljs-string">&#x27;Date_received&#x27;</span>], <span class="hljs-built_in">format</span> = <span class="hljs-string">&#x27;%Y%m%d&#x27;</span>)<br>        <span class="hljs-keyword">if</span> td &lt;= pd.Timedelta(<span class="hljs-number">15</span>, <span class="hljs-string">&#x27;D&#x27;</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>data[<span class="hljs-string">&#x27;label&#x27;</span>] = data.apply(label, axis = <span class="hljs-number">1</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>Statistics positive and negative samples</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(data[<span class="hljs-string">&#x27;label&#x27;</span>].value_counts())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1    57060</span><br><span class="hljs-string">0    10105</span><br><span class="hljs-string">Name: label, dtype: int64</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>Divide the data set 80% training set 20% test set</p>
<p>80% train 20% test</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">X_train, X_test, y_train, y_test = train_test_split(data.iloc[:, <span class="hljs-number">1</span>:], data.iloc[:, <span class="hljs-number">0</span>], test_size = <span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>
<p>Check the number and category distribution of training samples</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">y_train.value_counts()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">2751537    96</span><br><span class="hljs-string">6641735    86</span><br><span class="hljs-string">           ..</span><br><span class="hljs-string">4461556     1</span><br><span class="hljs-string">Name: User_id, Length: 34984, dtype: int64</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>Check the number and type distribution of test samples</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">y_test.value_counts()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">6641735    27</span><br><span class="hljs-string">2751537    22</span><br><span class="hljs-string">           ..</span><br><span class="hljs-string">89464       1</span><br><span class="hljs-string">Name: User_id, Length: 11405, dtype: int64</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>Initialize the classification decision tree model, the depth is 5
layers</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">model = DecisionTreeClassifier(max_depth=<span class="hljs-number">6</span>, random_state = <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>Model training</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">model.fit(X_train, y_train)<br></code></pre></td></tr></table></figure>
<p>Model prediction</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">y_pred = model.predict(X_test)<br></code></pre></td></tr></table></figure>
<p>Model evaluation</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">accuracy_score(y_test, y_pred)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0.011315417256011316</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>Change the standard of the model selection feature to entropy</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">model = DecisionTreeClassifier(criterion=<span class="hljs-string">&#x27;entropy&#x27;</span>, random_state=<span class="hljs-number">1</span>, max_depth=<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>
<p>Model training</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">model.fit(X_train, y_train)<br></code></pre></td></tr></table></figure>
<p>predict</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">y_pred = model.predict(X_test)<br></code></pre></td></tr></table></figure>
<p>Evaluate</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">accuracy_score(y_test, y_pred)<br></code></pre></td></tr></table></figure>
<blockquote>
<p>In addition to the above key steps, you can explore the data by
yourself, as well as any other forms of feature preprocessing methods
and feature engineering processing. I hope to focus on understanding the
development process of machine learning tasks. For the skills and
methods of data processing, it is encouraged to invest more time to
explore.</p>
</blockquote>
<h2 id="iris">iris</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_iris<br><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier, export_graphviz <br><br>iris = load_iris()<br>X = iris.data <br>y = iris.target<br>tree_clf = DecisionTreeClassifier()<br>tree_clf.fit(X, y)<br><br>export_graphviz(<br>            tree_clf,<br>            out_file=<span class="hljs-string">&quot;~/data/course_data/iris_tree.dot&quot;</span>,<br>            feature_names=iris.feature_names,<br>            class_names=iris.target_names,<br>            rounded=<span class="hljs-literal">True</span>,<br>            filled=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;~/data/course_data/iris_tree.dot&#x27;</span>):<br>    <span class="hljs-built_in">print</span>(line)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">digraph Tree &#123;</span><br><span class="hljs-string"></span><br><span class="hljs-string">node [shape=box, style=&quot;filled, rounded&quot;, color=&quot;black&quot;, fontname=helvetica] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">edge [fontname=helvetica] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 [label=&quot;petal length (cm) &lt;= 2.45\ngini = 0.667\nsamples = 150\nvalue = [50, 50, 50]\nclass = setosa&quot;, fillcolor=&quot;#ffffff&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">1 [label=&quot;gini = 0.0\nsamples = 50\nvalue = [50, 0, 0]\nclass = setosa&quot;, fillcolor=&quot;#e58139&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 -&gt; 1 [labeldistance=2.5, labelangle=45, headlabel=&quot;True&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">2 [label=&quot;petal width (cm) &lt;= 1.75\ngini = 0.5\nsamples = 100\nvalue = [0, 50, 50]\nclass = versicolor&quot;, fillcolor=&quot;#ffffff&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 -&gt; 2 [labeldistance=2.5, labelangle=-45, headlabel=&quot;False&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">3 [label=&quot;petal length (cm) &lt;= 4.95\ngini = 0.168\nsamples = 54\nvalue = [0, 49, 5]\nclass = versicolor&quot;, fillcolor=&quot;#4de88e&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">2 -&gt; 3 ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">4 [label=&quot;petal width (cm) &lt;= 1.65\ngini = 0.041\nsamples = 48\nvalue = [0, 47, 1]\nclass = versicolor&quot;, fillcolor=&quot;#3de684&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">3 -&gt; 4 ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">5 [label=&quot;gini = 0.0\nsamples = 47\nvalue = [0, 47, 0]\nclass = versicolor&quot;, fillcolor=&quot;#39e581&quot;] ;</span><br><span class="hljs-string">show more (open the raw output data in a text editor) ...</span><br><span class="hljs-string"></span><br><span class="hljs-string">16 [label=&quot;gini = 0.0\nsamples = 43\nvalue = [0, 0, 43]\nclass = virginica&quot;, fillcolor=&quot;#8139e5&quot;] ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">12 -&gt; 16 ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<h3 id="salient-features">Salient Features</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">tree_clf.feature_importances_<br></code></pre></td></tr></table></figure>
<h3 id="build-decision-tree-cart">Build Decision Tree: CART</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>mock_data = &#123;<br>    <span class="hljs-string">&#x27;gender&#x27;</span>:[<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>],<br>    <span class="hljs-string">&#x27;income&#x27;</span>: [<span class="hljs-string">&#x27;+10&#x27;</span>, <span class="hljs-string">&#x27;-10&#x27;</span>, <span class="hljs-string">&#x27;+10&#x27;</span>, <span class="hljs-string">&#x27;+10&#x27;</span>, <span class="hljs-string">&#x27;+10&#x27;</span>, <span class="hljs-string">&#x27;+10&#x27;</span>, <span class="hljs-string">&#x27;-10&#x27;</span>],<br>    <span class="hljs-string">&#x27;family_number&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],<br>    <span class="hljs-string">&#x27;bought&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],<br>&#125;<br>dataset = pd.DataFrame.from_dict(mock_data)<br><br><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">entropy</span>(<span class="hljs-params">elements</span>):<br>    counter = Counter(elements)<br>    probabilities = [counter[e] / <span class="hljs-built_in">len</span>(elements) <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> elements]<br>    <span class="hljs-keyword">return</span> -<span class="hljs-built_in">sum</span>(p * np.log10(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> probabilities)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_the_min_spilter</span>(<span class="hljs-params">training_data: pd.DataFrame, target: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    x_fields = <span class="hljs-built_in">set</span>(training_data.columns.tolist()) - &#123;target&#125;<br>    <br>    spliter = <span class="hljs-literal">None</span><br>    min_entropy = <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)<br>    <br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> x_fields:<br>        elements = <span class="hljs-built_in">set</span>(training_data[f])<br>        <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> elements:<br>            sub_spliter_1 = training_data[dataset[f] == e][target].tolist()<br>            entropy_1 = entropy(sub_spliter_1)<br>            sub_spliter_2 = training_data[dataset[f] != e][target].tolist()<br>            entropy_2 = entropy(sub_spliter_2)<br>            entropy_v = entropy_1 + entropy_2<br>            <br>            <span class="hljs-keyword">if</span> entropy_v &lt; min_entropy:<br>                min_entropy = entropy_v<br>                spliter = (f, e)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;spliter is: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(spliter))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;the min entropy is: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(min_entropy))<br>    <br>    <span class="hljs-keyword">return</span> spliter<br><br>find_the_min_spilter(dataset, <span class="hljs-string">&#x27;bought&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">spliter is: (&#x27;income&#x27;, &#x27;+10&#x27;)</span><br><span class="hljs-string">the min entropy is: 0.7176797562470717</span><br><span class="hljs-string">(&#x27;income&#x27;, &#x27;+10&#x27;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>dataset[dataset[<span class="hljs-string">&#x27;income&#x27;</span>] == <span class="hljs-string">&#x27;-10&#x27;</span>]<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">	gender	income	family_number	bought</span><br><span class="hljs-string">1	    F	    -10	            1	    1</span><br><span class="hljs-string">6	    M	    -10         	2	    1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>dataset[dataset[<span class="hljs-string">&#x27;income&#x27;</span>] != <span class="hljs-string">&#x27;-10&#x27;</span>]<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">	gender	income	family_number	bought</span><br><span class="hljs-string">0	    F	    +10         	1   	1</span><br><span class="hljs-string">2	    F	    +10         	2   	1</span><br><span class="hljs-string">3	    F	    +10         	1   	0</span><br><span class="hljs-string">4	    M	    +10         	1   	0</span><br><span class="hljs-string">5	    M	    +10         	1   	0</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>Machine Learning Part-03</p><p><a href="https://hivan.me/example_05/">https://hivan.me/example_05/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Hivan Du</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-09-02</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-02</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=6479444288ae9600196fa98e&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="https://afdian.net/item/72907364008511ee904852540025c377" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://qiniu.hivan.me/picGo/20230601221633.jpeg" alt="支付宝"></span></a><a class="button donate" href="https://www.buymeacoffee.com/hivandu" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="https://patreon.com/user?u=89473430" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="paypal" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="doo@hivan.me"><input type="hidden" name="currency_code" value="USD"></form><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://qiniu.hivan.me/IMG_4603.JPG" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/example_04/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Machine Learning Part-02</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/example_06/"><span class="level-item">Machine Learning Part-04</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://hivan.me/example_05/';
            this.page.identifier = 'example_05/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'hivan' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/bdff168cf8a71c11d2712a1679a00c54?s=128" alt="茶桁"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">茶桁</p><p class="is-size-6 is-block">AI游民</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shang Hai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">166</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">19</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hivandu" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hivandu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hivan"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/hivan"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com/hivan"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA4NzE4MDQzMg==&amp;action=getalbum&amp;album_id=2932504849574543360&amp;scene=173&amp;from_msgid=2648747980&amp;from_itemidx=1&amp;count=3&amp;nolastread=1&amp;token=1758883909&amp;lang=zh_CN#wechat_redirect"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://www.zhihu.com/column/c_1424326166602178560" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">塌缩的奇点</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhihu.com/column/hivandu" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">茶桁-知乎</span></span><span class="level-right"><span class="level-item tag">www.zhihu.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/"><span class="level-start"><span class="level-item">AI秘籍</span></span><span class="level-end"><span class="level-item tag">27</span></span></a><ul><li><a class="level is-mobile" href="/categories/AI%E7%A7%98%E7%B1%8D/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E6%8E%A5%E8%A7%A6%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%A4%A7%E6%A8%A1%E5%9E%8B/"><span class="level-start"><span class="level-item">从零开始接触人工智能大模型</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-22T05:21:59.000Z">2023-08-22</time></p><p class="title"><a href="/AI-Python-Pandas/">27. Pandas</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-21T00:41:45.000Z">2023-08-21</time></p><p class="title"><a href="/AI-Python-numpy/">26. NumPy</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-19T12:42:01.000Z">2023-08-19</time></p><p class="title"><a href="/AI-Python-matplotlib/">25. matplotlib</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-19T03:58:10.000Z">2023-08-19</time></p><p class="title"><a href="/Decorator-syntax-and-application/">24. 装饰器语法与应用</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-17T16:54:10.000Z">2023-08-18</time></p><p class="title"><a href="/OOP-Descriptor-and-design-patterns/">23. 描述符和设计模式</a></p><p class="categories"><a href="/categories/AI%E7%A7%98%E7%B1%8D/">AI秘籍</a> / <a href="/categories/AI%E7%A7%98%E7%B1%8D/Python/">Python</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="茶桁.MAMT" height="28"></a><p class="is-size-7"><span>&copy; 2023 Hivan Du</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hivandu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>